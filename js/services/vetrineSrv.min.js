(function(){function d(d,e,f,b){var g=f+"vetrine.php",h=function(a){var c=[];_.each(JSON.parse(a.cmp_settore),function(a){c.push({id:a,nome:b.createTitle("settore",b.getNameFromId(e.current.settori,a))})});return{id:parseInt(a.cmp_id),nome:a.cmp_nome,titolo:a.cmp_title,note:a.cmp_note,marchio:parseInt(a.cmp_mark_id),linea:parseInt(a.cmp_line_id),posizione:parseInt(a.cmp_pos),settori:c,prodotti:[]}},k=function(a){return{id:parseInt(a.prd_id),codice:a.prd_cod,titolo:a.prd_title,note:a.prd_note,dimensioni:a.prd_dim,
codiceFinitura:a.abb_cod,tipologia:a.tab_nome,prezzo:JSON.parse(a.prd_price_array),abbinamentiFiniture:JSON.parse(a.abb_array),abbinamento:parseInt(a.prd_abb),finitura:parseInt(a.prd_fin),quantita:parseInt(a.cmpr_qnt)}};return{getAllByLinea:function(a,c,b){d.get(g,{params:{action:"getAllByLinea",id:a},cache:!0}).then(function(a){e.debugConsole&&console.log("GET ALL BY LINEA vetrine: SUCCESS",a);if(c){var b=[];_.each(a.data,function(a){var c=h(a);_.each(a.prodotti,function(a){c.prodotti.push(k(a))});
b.push(c)});return c(b)}},function(a){e.debugConsole&&console.log("GET ALL BY LINEAvetrine: FAIL",a);if(b)return b()})}}}angular.module("mpu").service("vetrineSrv",d);d.$inject=["$http","$rootScope","API","settoriSrv"]})();
