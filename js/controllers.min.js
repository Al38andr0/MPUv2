"use strict";angular.module("mpu").controller("homeCtrl",["$scope","$rootScope","$location","_","$timeout","$interval",function(i,g,e,h,b,f){var a="nabcdefghilmn".toUpperCase().split("");i.intro={};i.intro.index=0;var c=4000;var d=function(j,l,k){b(function(){i.intro[j]=false;i.intro[l]=true;i.intro.index=k},c*k)};f(function(){for(var j=0;j<a.length-1;j++){d(a[j],a[j+1],j)}},1000,1);f(function(){for(var j=0;j<a.length-1;j++){d(a[j],a[j+1],j)}},(c*a.length)+1000);i.fnz.visitWebSite=function(j){window.open("http://"+j)};i.fnz.selectReg=function(j){i.filtro.prv=false;i.filtro.reg=(i.filtro.reg==j)?false:j};i.fnz.checkReg=function(j){return h.contains(i.vm.rivRegList,j)}}]);angular.module("mpu").controller("mainCtrl",["$scope","$rootScope","$location","_","$cookies","dataSvc","$timeout","$window","$http",function(m,k,h,l,e,d,b,a,i){k.$watch("dt.loaded",function(q){if(q){m.prv.nz=(l.filter(k.dt.nazioni,function(v){return v.v==1}).length>1)?false:k.dt.nazioni[0].i;l.each(k.dt.rivenditori,function(x){if(x.v==0){x.prv=l.find(k.dt.province,function(v){return v.i==x.p}).n}});m.vm.categorie=m.fnz.categorie(k.dt.marchi);m.vm.lineeSettori=m.fnz.lineeSettori(k.dt.marchi);m.vm.settori=m.fnz.settori();if(h.search().q){var p=h.search().q;i.post("php/preventivo.php?p="+p,{}).success(function(v){m.prv=v.prv;e.put("MPU-A",v.prv.g);e.put("MPU-I",v.prv.u);e.putObject("MPU-P",v.prv);e.put("MPU-Q",h.search().q)})}if(e.get("MPU-A")){if(e.get("MPU-A")==0){m.data.agente=false;m.prv.g=0}else{m.data.agente=true;m.prv.g=e.get("MPU-A");var u=l.find(k.dt.agenti,function(v){return v.i==e.get("MPU-A")});m.data.nomeAgente=u.n;var r=l.find(k.dt.rivenditori,function(v){return v.i==u.r});if(r.p===0){m.vm.loc=r.n.split(" ").join("_")}else{m.vm.loc=r.prv.split(" ").join("_")}h.path("/"+m.vm.loc+"/home")}}else{e.put("MPU-A",0);m.data.agente=false;m.prv.g=0}if(m.fnz.findLoc()==="mpu"||h.path()=="/"||!h.path()){e.put("MPU-I",0);e.put("MPU-A",0);b(function(){m.fnz.render()});m.data.rivenditore=false;m.prv.u=0}else{m.vm.loc=m.fnz.findLoc();var w=m.vm.loc.split("_").join(" ");var t=false;var s=l.find(k.dt.province,function(v){return v.n==w});if(s){t=l.find(k.dt.rivenditori,function(v){return v.p==s.i})}else{t=l.find(k.dt.rivenditori,function(v){return v.n==w})}if(t){var o=t.i;e.put("MPU-I",o);m.prv.u=o;b(function(){m.fnz.render(o)})}else{e.put("MPU-I",0);if(e.get("MPU-A")){e.put("MPU-A",e.get("MPU-A"));m.prv.g=e.get("MPU-A")}else{e.put("MPU-A",0);m.prv.g=e.get("MPU-A")}h.url("404.html");m.prv.u=0;b(function(){m.fnz.render()});m.data.rivenditore=false}}m.vm.loaded=true}});m.vm={loaded:false,listinoLoaded:false,cookie:false,translate:false,translateMobile:false,login:false,footerOpen:false,hover:false,credits:false,menuCat:false,prv:false,added:false,cleanPrv:false,menu:false,menuArt:false,menuCmp:false,prvShare:false,prvEmail:false,prvSearch:false,prvSearchID:"",prvSearchError:false,prdShare:false,prdEmail:false,dwgEmail:false,menuShare:false,menuEmail:false,order:false,findPlace:"",cookies:false,lineaIsSet:false,prevLinea:false,prevCmp:false,catLimit:8,showScroll:false,optionLinea:"SCEGLI LINEA",optionSettore:"SCEGLI SETTORE",optionCategoria:"SCEGLI COLLEZIONE",showContatti:false,orderFailed:false,sendingOrder:false,description:"Vendita diretta e online di mobili per ufficio, sedie, poltrone, pareti divisorie, arredo ufficio moderno, classico e design, offerte a prezzi scontati",title:"Mobili per Ufficio e arredamento ufficio, prezzi e offerte in pronta consegna"};m.show={sezioni:false,vetrina:false,composizioni:false,listino:true,txt:{vetrina:false,listino:false,composizioni:false}};m.dataPrv={};m.data={};m.current={};m.fnz={};m.login={error:false};m.prv={i:0,tm:2,a:0,u:0,list:[],g:0};m.filtro={prv:false,reg:false,price:false,cmp:false,prd:"",prdValue:"",esp:"",espValue:"",tbpr:false,consegna:false,linee:[],priceList:[],place:false,nomeLinea:""};m.mobile={contatti:false,tools:false,prodotti:true};m.vm.ftscroller={scrollbars:true,scrollingX:false,snap:true,momentum:true,hScrollbar:false,updateOnWindowResize:true,updateOnChanges:true,baseAlignments:{x:-1,y:-1}};m.cliente={t:1,s:"",v:"",es:"",a:"",c:"",p:"",t1:"",t2:"",f:"",n:"",en:"",dn:"",de:"",da:"",dc:"",dp:"",dt1:"",dt2:"",df:"",dm:"",d:1,m:1,py:false,cv:false};m.request={u:false,r:false,p:false};m.nm={navTitle:false,navSelection:false,terms:false,privacy:false,categorie:false,linea:false};m.fnz.switchMenu=function(o){m.vm.menuEmail=false;m.vm.menuShare=false;m.vm.login=false;m.vm.prvSearch=false;switch(o){case 1:m.nm.navSelection=(m.nm.navSelection==o)?false:o;break;case 2:m.nm.navSelection=(m.nm.navSelection==o)?false:o;break;case 3:$.getScript("//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit");break;case 4:if(m.prv.list.length!=0){if(m.fnz.findPage()!="preventivo"){h.url("/"+m.vm.loc+"/preventivo");m.nm.navSelection=(m.nm.navSelection==o)?false:o}else{a.history.back();m.nm.navSelection=false}}m.fnz.scrollTop();break;case 5:if(m.fnz.findPage()!="contatti"){h.url("/"+m.vm.loc+"/contatti");m.nm.navSelection=(m.nm.navSelection==o)?false:o}else{a.history.back();m.nm.navSelection=false}m.fnz.scrollTop();break;case 6:if(m.fnz.findPage()!="condizioni"){h.url("/"+m.vm.loc+"/condizioni")}else{a.history.back()}m.nm.navSelection=(m.nm.navSelection==o)?false:o;m.fnz.scrollTop();break;case 7:if(m.fnz.findPage()!="progettazione"){h.url("/"+m.vm.loc+"/progettazione")}else{a.history.back()}m.nm.navSelection=(m.nm.navSelection==o)?false:o;m.fnz.scrollTop();break;case 8:if(m.fnz.findPage()!="distributori"){h.url("/"+m.vm.loc+"/distributori")}else{a.history.back()}m.nm.navSelection=(m.nm.navSelection==o)?false:o;m.fnz.scrollTop();break;case 9:if(m.fnz.findPage()!="faq"){h.url("/"+m.vm.loc+"/faq")}else{a.history.back()}m.nm.navSelection=(m.nm.navSelection==o)?false:o;m.fnz.scrollTop();break;case 0:m.nm.navSelection=false;break}m.vm.translateMobile=(o!=3)?false:!m.vm.translateMobile};m.vm.ww=(a.innerWidth<=1080)?0:1;m.$on("$viewContentLoaded",function(o){a.ga("send","pageview",{page:h.url()})});$(window).on("resize.doResize",function(){m.$apply(function(){return m.vm.ww=(a.innerWidth<=1080)?0:1})});$(window).scroll(function(){m.vm.showScroll=(document.body.scrollTop>=150);m.nm.navTitle=(document.body.scrollTop!=0);m.$apply()});m.mobile.setProdotti=function(){if(!m.mobile.prodotti){m.mobile.prodotti=true;e.put("MPU-M",true)}else{m.mobile.prodotti=false;e.remove("MPU-M")}};m.mobile.prodotti=e.get("MPU-M");m.fnz.deselectMenu=function(o){switch(o){case"menu":m.vm.menuEmail=false;m.vm.menuShare=false;m.vm.login=false;m.vm.translate=false;m.vm.translateMobile=false;m.vm.prvSearch=false;m.vm.menu=!m.vm.menu;break;case"translate":$.getScript("//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit");m.vm.menuEmail=false;m.vm.menuShare=false;m.vm.login=false;m.vm.menu=false;m.vm.prvSearch=false;m.vm.translate=!m.vm.translate;break;case"share":m.vm.menuEmail=false;m.vm.menuShare=!m.vm.menuShare;m.vm.prvSearch=false;m.vm.login=false;break;case"login":m.vm.menuEmail=false;m.vm.menuShare=false;m.vm.prvSearch=false;m.vm.login=!m.vm.login;break;case"prdShare":m.vm.prdEmail=false;m.vm.prdShare=!m.vm.prdShare;break;case"prvShare":m.vm.prvEmail=false;m.vm.prvSearch=false;m.vm.prvShare=!m.vm.prvShare;break;case"prvSearch":m.vm.menuEmail=false;m.vm.prvEmail=false;m.vm.menuShare=false;m.vm.login=false;m.vm.prvSearch=!m.vm.prvSearch;break}};m.fnz.resetCurrent=function(){m.current={cat:false,sett:false,lin:false,page:false,tbpr:false,tbesp:false,vtr:false,cmp:false,art:false,listino:[],marchiTabelle:[]};m.filtro.tbpr=false};m.fnz.resetCurrent();m.$watch("filtro.tbpr",function(){m.nm.linea=false});var g=function(){m.fnz.resetCurrent()};m.fnz.cleanAll=function(){m.vm.menuCat=false;g()};m.fnz.goHome=function(){h.url("/"+m.vm.loc+"/home");m.fnz.scrollTop();m.nm.navSelection=false};if(h.search().c&&!m.current.cat){m.current.cat=parseInt(h.search().c)}if(h.search().s&&!m.current.sett){m.current.sett=parseInt(h.search().s)}function n(q,o,p){return q.split(o,p).join(o).length}m.fnz.findLoc=function(){var o=n(h.path(),"/",2);return h.path().slice(1,o)};m.vm.loc=(m.fnz.findLoc())?m.fnz.findLoc():"mpu";m.fnz.findPage=function(){var p=n(h.path(),"/",2);var o=h.path().length;return h.path().slice(p+1,o)};m.fnz.findDomain=function(){var o=n(h.absUrl(),"/",3);return h.absUrl().slice(0,o)};m.fnz.goToPrev=function(){h.url("/"+m.vm.loc+"/preventivo");m.vm.added=false};m.fnz.goToVetrina=function(){h.url("/"+m.vm.loc+"/vetrina?l="+m.current.lin.i);m.fnz.scrollTop()};m.fnz.goToCategoria=function(o){var p=(o)?o:m.current.lin.g;h.url("/"+m.vm.loc+"/categoria?c="+p);m.nm.navSelection=false;m.fnz.scrollTop()};m.fnz.goToArticolo=function(o,p){m.current.art=o;m.current.lin=l.findWhere(k.dt.linee,{i:parseInt(o.l)});h.url("/"+m.vm.loc+"/articolo?a="+o.i);if(p){m.vm.prevCmp=p.i;e.put("MPU-L",p.i)}m.fnz.scrollTop()};m.fnz.goToCmp=function(o){m.fnz.creaComposizione(o);m.current.lin=l.findWhere(k.dt.linee,{i:m.current.cmp.l});m.vm.prevCmp=false;e.remove("MPU-C");m.fnz.scrollTop()};m.fnz.findQuery=function(){var o=n(h.url(),"?",1);return h.url().slice(o)};m.fnz.absoluteUrl=function(){if(h.absUrl()==="http://mobiliperufficio.com/"||h.absUrl()==="http://mobiliperufficio.com/"+m.fnz.findLoc()+"/home"){return"http://mobiliperufficio.com/"}else{return"http://mobiliperufficio.com/mpu/"+m.fnz.findPage()+m.fnz.findQuery()}};if(e.getObject("MPU-P")){m.prv=e.getObject("MPU-P")}m.$watchCollection("prv",function(o){if(o.list.length==0){o.nz=1;o.rg=false;o.pr=false;o.tm=2}e.putObject("MPU-P",o)});m.$on("$locationChangeSuccess",function(){b(function(){switch(m.fnz.findPage()){case"categoria":switch(h.search().c){case"28":m.vm.description="Mobili per ufficio, i migliori prezzi e offerte per arredi e arredamenti ufficio direzionali, arredi uffici operativi, arredi reception; in pronta consegna";m.vm.title="Mobili per Ufficio e arredamento ufficio, prezzi e offerte in pronta consegna";break;case"54":m.vm.description="Sedute per ufficio, prezzi per sedie ufficio direzionali, sedute operative, sgabelli, poltrone e divani per ufficio; in pronta consegna, richiedi preventivo";m.vm.title="Sedie per ufficio, sedie direzionali, sedute operative poltrone e divani ufficio";break;case"55":m.vm.description="Art & Design Ufficio, i migliori articoli di design per ufficio, tavolo scrivania, tavoli riunioni, complementi arredo di design, scegli l'ufficio di design";m.vm.title="Art & Design Ufficio, scopri i migliori articoli di arte e design per il tuo ufficio";break;case"52":m.vm.description="Pareti divisorie per ufficio, prezzi economici e design per la suddivisione spazi del tuo ufficio o negozio, pareti divisorie, vetrate e pareti attrezzate";m.vm.title="Pareti divisorie economiche e di design per il tuo ufficio o negozio";break;case"40":m.vm.description="Accessori e complementi per ufficio, appendiabiti, cestini gettacarta, tavolini, lampade e accessori per scrivanie; acquista o richiedi un preventivo";m.vm.title="Accessori e complementi mobili per ufficio, appendiabiti, gettacarta, tavoli";break}break;case"listino":m.vm.description="mobiliperufficio.com presenta il listino della linea "+m.current.lin.n+". Una lista di tutti i prodotti della linea "+m.current.lin.n+" completa dei singoli prezzi.";m.vm.title="Tutti i prezzi dei prodotti della linea"+m.current.lin.n;break;case"vetrina":m.vm.description="mobiliperufficio.com presenta la vetrina della linea "+m.current.lin.n+". Una paronamica delle composizioni presenti nella linea "+m.current.lin.n+" completa di prezzi.";m.vm.title="Esposizione online della linea"+m.current.lin.n+" con prezzi, specifiche e dettagli";break;case"articolo":m.vm.description="mobiliperufficio.com presenta l'articolo "+m.current.art.c+", "+m.current.art.n+", dimensioni "+m.current.art.d+" della linea "+m.current.lin.n;m.vm.title="Prezzi, specifiche e colori dell'articolo  "+m.current.art.c;break;case"composizione":m.vm.description="mobiliperufficio.com presenta la composizione "+m.current.lin.n+" "+m.current.cmp.c+", "+m.current.cmp.n+", della linea "+m.current.lin.n;m.vm.title="Un arredo selezionato pronto all'acquisto della linea"+m.current.lin.n;break;case"contatti":m.vm.description="La lista dei contatti di tutti i distributori che collaborano con mobiliperufficio.com. Siamo presenti a Roma, Milano, Napoli, Torino e molte altre città.";m.vm.title="Cercaci a Roma, Milano, Torino, Napoli, Firenze e in altre città d'Italia";break;case"distributori":m.vm.description="Una lista completa di tutti i distributori che collaborano con mobiliperufficio.com. Siamo presenti a Roma, Milano, Napoli, Torino e molte altre città.";m.vm.title="Cercaci a Roma, Torino, Napoli, Milano, Firenze e in altre città d'Italia";break;case"condizioni":m.vm.description="Le nostre condizioni di vendita di mobili per ufficio. Un altro esempio di trasparenza e voglia di metterci a disposizione dei nostri clienti.";m.vm.title="Poche regole per acquistare il tuo arredo per ufficio in trasparenza e sicurezza";break;case"faq":m.vm.description="Se avete qualche domanda da porci consultate la nostra FAQ, dove abbiamo inserito un lista di tutte le domande frequentemente richieste, con sintetiche, ma esaustive, risposte.";m.vm.title="Contattaci per ogni richiesta o informazione se non trovate le vostre risposte in questa pagina";break;case"progettazione":m.vm.description="mobiliperufficio.com offre la progettazione gratuita degli ambienti di lavoro conforme ai requisiti di sicurezza e comfort per gli utilizzatori finali.";m.vm.title="Servizio di progettazione gratuito in tutta Italia per un servizio completo ed efficiente";break;case"preventivo":m.vm.description="Preventivo online interamente personalizzato. Diamo la possibilità ai nostri clienti di crearsi il preventivo a loro completo piacimento, con tutti i costi e sconti riservati";m.vm.title="Creati il preventivo dei tuoi mobili per ufficio personalizzato senza spese aggiunte";break;case"form":m.vm.description="Completi questo semplice form con i suoi dati e le modalità di pagamento, quanto prima riceverà la nostra conferma d'ordine di acquisto dei prodotti scelti.";m.vm.title="Acquistare l'arredamento per ufficio non è mai stato così semplice e sicuro";break;case"privacy":m.vm.description="mobiliperufficio.com, come ogni servizio online che si rispetti, offre un servizio informazione per la tutela privacy di ogni visitatore.";m.vm.title="La tutela dei nostri utenti viene rispettata sotto ogni aspetto, dalla prima visita fino all'acquisto degli arredi per ufficio";break;default:m.vm.description="Vendita diretta e online di mobili per ufficio, sedie, poltrone, pareti divisorie, arredo ufficio moderno, classico e design, offerte a prezzi scontati";m.vm.title="Mobili per Ufficio e arredamento ufficio, prezzi e offerte in pronta consegna"}},100);m.vm.catLimit=8;m.fnz.scrollTop();m.vm.menuCat=false;m.nm.linea=false;m.vm.lineaIsSet=(h.search().l)?true:false;m.current.path=h.url();m.vm.cookies=(e.get("MPU-K"));if(e.get("MPU-L")){m.vm.prevLinea=e.get("MPU-L")}if(e.get("MPU-C")){m.vm.prevCmp=e.get("MPU-C")}if(m.fnz.findPage()!="listino"){m.vm.prevLinea=false;e.remove("MPU-L")}if(m.fnz.findPage()!="articolo"){m.vm.prevCmp=false;e.remove("MPU-C")}m.request.u=false;m.request.t="";m.filtro.price=false;m.filtro.nomeLinea="";m.filtro.prd="";m.filtro.prdValue="";if(m.fnz.findPage()!="listino"){m.filtro.tbpr=false}if(m.fnz.findPage()!="vetrina"&&m.fnz.findPage()!="listino"&&m.fnz.findPage()!="articolo"&&m.fnz.findPage()!="composizione"&&h.search().c!=m.current.cat){m.filtro.linee=[];m.filtro.priceList=[];m.filtro.consegna=false}if(h.search().a){m.current.art=l.findWhere(k.dt.prodotti,{i:parseInt(h.search().a)})}m.vm.prv=(m.fnz.findPage()=="preventivo"||m.fnz.findPage()=="ordine"||m.fnz.findPage()=="form");m.vm.order=(m.fnz.findPage()=="form")});m.$watch("filtro.price",function(){var p=document.getElementsByClassName("SWD");var o=-1;b(function(){m.fnz.myLoop(o,p.length)})});m.fnz.categorie=function(r){var p=l.pluck(l.where(r,{v:1}),"g");var o=[];l.each(p,function(s){l.each(s,function(t){o.push(t)})});var q=[];l.each(l.uniq(o),function(s){l.each(k.dt.categorie,function(t){if(t.i==s){q.push(t)}})});l.each(r,function(s){l.each(k.dt.linee,function(t){if(t.m==s.i&&s.v==0){t.v=0}})});return q};m.fnz.lineeSettori=function(q){var p=l.pluck(l.where(q,{v:1}),"i");var o=[];l.each(p,function(r){l.each(k.dt.lineeSettori,function(s){if(s.m==r){o.push(s)}})});return o};m.fnz.settori=function(){var o=l.pluck(l.where(m.vm.lineeSettori,{v:1}),"h");var p=[];l.each(l.uniq(o),function(q){l.each(k.dt.settori,function(r){if(r.i==q){p.push(r)}})});return p};m.fnz.rivenditori=function(o){m.data.rivenditore=l.find(k.dt.rivenditori,function(p){return p.i==o});m.prv.nz=false;m.prv.rg=false;m.prv.pr=false;l.each(m.data.rivenditore.y,function(p){l.each(k.dt.marchi,function(q){if(p.i==q.i){q.s=(p.s==0)?q.s:p.s;q.v=p.v;q.d=p.d}})})};m.fnz.render=function(o){if(o){m.fnz.rivenditori(o)}m.vm.categorie=m.fnz.categorie(k.dt.marchi);m.fnz.checkZad=function(){return l.find(m.vm.categorie,function(p){return p.i===55})}};m.login.access=function(){if(m.login.user&&m.login.psw){k.saving=true;i.post("php/login.php",{user:m.login.user,psw:m.login.psw,mpu:e.get("MPU-I")}).success(function(p){console.log(p);if(!p){m.login.error=true;b(function(){m.login.error=false},4000)}else{if(p==-1){window.location="dashboard/index.php"}else{var o=parseInt(p[0]);var s=parseInt(p[1]);m.vm.login=false;m.data.agente=true;m.data.nomeAgente=l.find(k.dt.agenti,function(t){return t.i==o}).n;g();e.put("MPU-A",o);e.put("MPU-I",s);e.remove("MPU-Q");m.prv={i:0,nz:1,rg:0,pr:0,tm:2,a:0,list:[],g:o,u:s};var r=l.find(k.dt.rivenditori,function(t){return t.i==s});if(r.v!=0){m.vm.loc=m.fnz.replaceAll(r.n," ","_")}else{var q=l.find(k.dt.province,function(t){return t.i==r.p});m.vm.loc=m.fnz.replaceAll(q.n," ","_")}m.fnz.rivenditori(s);m.vm.categorie=m.fnz.categorie(k.dt.marchi);m.vm.menu=false;h.url("/"+m.vm.loc+"/home")}}})}else{m.login.error=true;b(function(){m.login.error=false},4000)}};m.login.exit=function(){m.vm.login=false;m.data.agente=false;e.put("MPU-A",0);g();if(e.get("MPU-I")==0||$co/okies.get("MPU-I")==91){m.data.rivenditore=false;m.vm.categorie=m.fnz.categorie(k.dt.marchi);e.put("MPU-I",0);e.remove("MPU-Q");m.vm.loc="mpu";h.url("/mpu/home")}else{m.fnz.rivenditori(e.get("MPU-I"));m.vm.categorie=m.fnz.categorie(k.dt.marchi)}m.prv.g=0;m.prv={i:0,nz:1,rg:false,pr:false,tm:2,a:0,u:e.get("MPU-I"),list:[],g:0};m.vm.menu=false;h.url("/"+m.vm.loc+"/home")};m.fnz.convert=function(o,s,r){var t=[];var q="";if(typeof o==="object"){for(var p=0;p<o.length;p++){l.each(k.dt[s],function(u){if(u.i==o[p]){t.push(u[r])}})}return t}else{l.each(k.dt[s],function(u){if(u.i==o){q=u[r]}});return q}};m.fnz.convertData=function(o,s,r){var t=[];var q="";if(typeof o==="object"){for(var p=0;p<o.length;p++){l.each(m.data[s],function(u){if(u.i==o[p]){t.push(u[r])}})}return t}else{l.each(m.data[s],function(u){if(u.i==o){q=u[r]}});return q}};m.fnz.regArt=function(o){switch(o){case 8:return"nel";break;case 11:return"nelle";break;default:return"in";break}};Number.prototype.formatMoney=function(x,u,q){var w=this;var v;v=isNaN(x=Math.abs(x))?2:x;u=u==undefined?".":u;q=q==undefined?",":q;var r=w<0?"-":"";var p=parseInt(w=Math.abs(+w||0).toFixed(v))+"";var o;o=(o=p.length)>3?o%3:0;return r+(o?p.substr(0,o)+q:"")+p.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+q)+(v?u+Math.abs(w-p).toFixed(v).slice(2):"")};m.fnz.convertPrice=function(o){return(o).formatMoney(2,",",".")};m.fnz.convertFinType=function(o){return(o==0)?"Finitura":"Rivestimento"};m.fnz.convertPriceType=function(o){switch(o){case 1:return"Miglior prezzo";break;case 2:return"Economico";break;case 3:return"Design";break;case 4:return"Alto design";break;case 5:return"Luxury";break}};m.fnz.resetLinea=function(){m.current.vtr=false;m.current.cmp=false;m.current.tbpr=false;m.current.art=false;m.current.listino=[];m.current.marchiTabelle=[];m.filtro.tbpr=false};m.fnz.setCurCat=function(o){m.current.cat=o;m.current.sett=false;m.current.lin=false;m.current.page=false;h.url("/"+m.vm.loc+"/categoria?c="+o)};m.fnz.creaLinea=function(o){m.vm.optionLinea="TUTTE LE LINEE";m.fnz.resetLinea();m.current.lin=o;if(!m.current.cat){m.current.cat=m.current.lin.g}if(m.current.lin.c){m.show.sezioni=true;m.show.vetrina=true}else{m.current.cmp=false;m.current.art=false;m.fnz.creaListino();h.url("/"+m.vm.loc+"/listino?l="+o.i)}};m.fnz.showText=function(o){switch(o){case 1:m.show.txt.vetrina=!m.show.txt.vetrina;m.show.txt.listino=false;m.show.txt.composizioni=false;break;case 2:m.show.txt.listino=!m.show.txt.listino;m.show.txt.vetrina=false;m.show.txt.composizioni=false;break;case 3:m.show.txt.composizioni=!m.show.txt.composizioni;m.show.txt.listino=false;m.show.txt.vetrina=false;break}};m.fnz.goToSezioni=function(o){switch(o){case 1:m.current.cmp=false;m.current.art=false;m.current.page=1;m.fnz.creaVetrine();h.url("/"+m.vm.loc+"/vetrina?l="+m.current.lin.i);break;case 2:m.current.cmp=false;m.current.art=false;m.current.page=2;m.fnz.creaListino();h.url("/"+m.vm.loc+"/listino?l="+m.current.lin.i);break}m.fnz.scrollTop();m.show.sezioni=false;m.show.vetrina=false;m.show.composizioni=false;m.show.txt={vetrina:false,listino:false,composizioni:false}};m.fnz.goToLinea=function(o,p){if(p){e.put("MPU-L",p);m.vm.prevLinea=p}else{e.remove("MPU-L");m.vm.prevLinea=false}m.filtro.tbpr=false;m.current.lin=l.findWhere(k.dt.linee,{i:parseInt(o)});m.fnz.creaListino();h.url("/"+m.vm.loc+"/listino?l="+o)};m.fnz.noSezioni=function(){m.show={sezioni:false,vetrina:false,composizioni:false,listino:true,txt:{vetrina:false,listino:false,composizioni:false}}};m.fnz.creaComposizione=function(o){m.current.cmp=l.find(k.dt.vetrine,function(p){return p.i==o});m.current.cmp.p=l.filter(k.dt.vetrineProdotti,function(p){return p.c==m.current.cmp.i});m.fnz.scrollTop()};m.fnz.creaVetrine=function(){m.current.vetrine=[];l.each(k.dt.vetrine,function(o){if(o.l==m.current.lin.i&&o.v==1){m.current.vetrine.push(o)}})};m.fnz.creaListino=function(){m.current.listino=l.filter(m.dt.prodotti,function(p){return p.l==m.current.lin.i});var o=l.uniq(l.map(m.current.listino,function(p){return p.t}));m.current.marchiTabelle=[];l.each(o,function(p){l.each(m.dt.marchiTabelle,function(q){if(p==q.i){m.current.marchiTabelle.push(q)}})})};m.fnz.moreTbpr=function(){m.vm.tbprLimit++};m.fnz.replaceAll=function(o,q,p){return o.replace(new RegExp(q,"g"),p)};m.fnz.scontistica=function(q,o,p,r){var s=q+((q*p)/100);s+=(s*o)/100;s+=(s*r)/100;return Math.ceil(s)};m.fnz.checkInput=function(p,o){if(p.keyCode==27){m.filtro[o+"Value"]="";m.filtro[o]=""}else{var r="",q;if(q){b.cancel(q)}r=m.filtro[o+"Value"];q=b(function(){m.filtro[o]=r},150)}};m.fnz.scrollTop=function(p){if(typeof p=="number"||!p){var o=(p)?p:0;$("html, body").animate({scrollTop:o},300)}else{b(function(){$("html, body").animate({scrollTop:$("#"+p).offset().top},300)},200)}};m.fnz.requestInfo=function(p){if(m.request.u){m.request.u=false}else{if(p){switch(p){case"linea":m.request.t="Richiesta informazioni per la linea "+m.current.lin.n;break;case"composizione":var o=m.current.cmp.i;m.request.t="Richiesta informazioni per composizione "+m.fnz.convert(m.current.lin.i,"linee","n")+"_"+m.fnz.convert(o,"vetrine","c");break;case"articolo":m.request.t="Richiesta informazioni per l'articolo "+m.fnz.convert(parseInt(h.search().a),"prodotti","c")+" della linea "+m.fnz.convert(m.current.lin.i,"linee","n");break}}if(e.get("MPU-I")!=0){m.request.u=m.fnz.convert(e.get("MPU-I"),"rivenditori","n");m.request.r=m.fnz.convert(e.get("MPU-I"),"rivenditori","e")}else{m.request.u=k.dt.rivenditori[0].n;m.request.r=k.dt.rivenditori[0].e}m.fnz.scrollTop()}};m.fnz.acceptCookies=function(){m.vm.cookies=true;e.put("MPU-K",1)};m.fnz.pdfPath=function(p){var o=m.fnz.replaceAll(m.fnz.convert(m.current.lin.m,"marchi","n")," ","_");var q=m.fnz.replaceAll(m.current.lin.n," ","_");switch(p){case"c":return"dashboard/archivio_dati/"+o+"/"+q+"/"+q+"_catalogo.pdf";break;case"s":return"dashboard/archivio_dati/"+o+"/"+q+"/"+q+"_specifiche.pdf";break}};m.fnz.addToPrv=function(A,u){var z=(!u)?0:u;var o=(A.selectedFin)?A.selectedFin.c:A.fin[0].c;var p=(A.selectedFin)?A.selectedFin.i:A.fin[0].i;var w=(A.selectedFin)?A.selectedFin.u:A.fin[0].u;var y;if(!A.cmp){var q=l.find(A.z,function(v){return v.a===w});var s=l.find(m.dt.marchi,function(v){return v.i==A.m});var x=l.find(m.dt.linee,function(v){return v.i==A.l});y=m.fnz.scontistica(q.z,s.s,s.b,x.s)}else{y=A.raw}m.fnz.scrollTop();m.selectedPrd={c:A.cod+" "+o,z:y,i:A.i,v:z,a:p,u:w,q:A.q};var r=l.find(m.prv.list,function(v){return v.c==m.selectedPrd.c});var t=m.prv.list.indexOf(r);if(!r){m.prv.list.push(m.selectedPrd)}else{m.prv.list[t].q+=m.selectedPrd.q;m.prv.list[t].v=(m.selectedPrd.v!=0)?m.selectedPrd.v:r.q}e.putObject("MPU-P",m.prv);m.vm.added=true};m.fnz.addCmpToPrv=function(o,p){l.each(o,function(q){m.fnz.addToPrv(q,p)})};m.fnz.removeFromPrv=function(q){var p=l.find(m.prv.list,function(r){return r.c==q});var o=m.prv.list.indexOf(p);m.prv.list.splice(o,1);e.putObject("MPU-P",m.prv);m.$broadcast("prv.list")};m.fnz.confirmCleanPrv=function(){if(m.prv.list.length!=0){m.vm.cleanPrv=true;b(function(){m.vm.cleanPrv=false},4000)}};m.fnz.cleanPrv=function(){m.prv.i=0;m.prv.tm=2;m.prv.a=0;m.prv.list=[];if(e.get("MPU-A")==0){m.prv.nz=1;m.prv.rg=false;m.prv.pr=false}else{m.prv.nz=0;m.prv.rg=0;m.prv.pr=0}m.vm.cleanPrv=false;b(function(){h.url("/"+m.vm.loc+"/home")},2000)};m.fnz.savePrv=function(o){i.post("php/preventivo.php",{ID:m.dataPrv.ID,a:m.prv.a,i:m.prv.i,b:m.prv.b,l:m.prv.l,list:m.prv.list,m:m.prv.m,k:m.prv.k,nz:m.prv.nz,rg:m.prv.rg,pr:m.prv.pr,t:m.prv.t,j:m.prv.j,tm:m.prv.tm,z:m.prv.z,u:m.prv.u,g:m.prv.g}).success(function(p){console.log(p);if(o=="s"){m.vm.prvShareUrl="http://mobiliperufficio.com/print/"+m.vm.loc+"/preventivo/"+m.dataPrv.ID}if(o=="p"){i.post("php/email.php",{cod:m.dataPrv.ID,type:"print",RIV:m.dataPrv.rivID,loc:m.vm.loc}).success(function(q){})}if(o=="o"){h.url("/"+m.vm.loc+"/form")}})};m.fnz.saveOrder=function(){m.vm.sendingOrder=true;if(m.cliente.a&&m.cliente.c&&m.cliente.cv&&m.cliente.py&&m.cliente.e&&m.cliente.n&&m.cliente.p&&m.cliente.t1){i.post("php/ordine.php?action=put",{ID:e.get("MPU-Q"),cliente:m.cliente,loc:m.vm.loc}).success(function(o){});i.post("php/email.php",{ID:e.get("MPU-Q"),cliente:m.cliente,RIV:m.dataPrv.rivID,loc:m.vm.loc,type:"order"}).success(function(o){m.vm.sendingOrder=false;h.url("/"+m.vm.loc+"/ordine")})}else{m.vm.sendingOrder=false;m.vm.orderFailed=true;b(function(){m.vm.orderFailed=false},3000)}};m.fnz.searchPrv=function(o){i.post("php/preventivo.php?p="+o,{}).success(function(p){if(p.prv){m.prv=p.prv;if(e.get("MPU-A")==0){m.prv.g=0}e.put("MPU-I",p.prv.u);e.putObject("MPU-P",p.prv);e.put("MPU-Q",o);if(p.prv.u!=0){var r=l.find(k.dt.rivenditori,function(s){return s.i==p.prv.u});if(r.v!=0){m.vm.loc=r.n}else{var q=m.fnz.convert(r.p,"province","n");m.vm.loc=q.split(" ").join("_")}b(function(){m.fnz.render(p.prv.u)});h.url("/"+m.vm.loc+"/preventivo?q="+o)}else{b(function(){m.fnz.render()});e.put("MPU-A",0);h.url("/mpu/preventivo?q="+o)}m.vm.prvSearch=false;m.vm.prvSearchID=""}else{m.vm.prvSearchError=true;b(function(){m.vm.prvSearchError=false},4000)}})};m.fnz.resetFilter=function(){m.filtro.consegna=false;m.filtro.linee=[];m.filtro.priceList=[];m.filtro.nomeLinea="";$(".categorieCheck").removeAttr("checked")};var c=function(o){return m.vm.consegna=l.sortBy(l.uniq(l.pluck(o,"e")),function(p){return p})};var j=function(o){return m.vm.priceList=l.sortBy(l.uniq(l.pluck(o,"z")),function(p){return p})};var f=function(u,p,r){var o=p;o.z=r.z;o.q=r.q;var q=m.fnz.convert(r.m,"marchi","n");q=m.fnz.replaceAll(q," ","_");var t=m.fnz.replaceAll(p.n," ","_");u=m.fnz.replaceAll(u," ","_");var v=t+"_"+u+".jpg";o.r="dashboard/archivio_dati/"+q+"/"+t+"/Vetrina/"+v;m.current.settore.push(o)};m.fnz.creaSettore=function(o,t,r){m.current.sett=o;var q=l.find(m.vm.settori,function(u){return u.i==o});m.current.cat=q.g;var p=l.filter(m.vm.lineeSettori,function(u){return u.h==o&&u.v==1});var s=l.find(m.vm.settori,function(u){return u.i==o});m.current.settore=[];l.each(p,function(u){l.each(k.dt.linee,function(v){if(u.l==v.i){f(s.n,v,u)}})});c(m.current.settore);j(m.current.settore);if(t){m.fnz.creaLinea(t,r)}};m.fnz.myLoop=function(o,p){b(function(){angular.element(document.querySelector("#D"+o)).removeClass("SWD");if(o<p){m.fnz.myLoop(o,p)}},300);return o++}}]);angular.module("mpu").controller("categoriaCtrl",["$scope","$rootScope","$location","dataSvc","$timeout","priceLinee",function(d,c,f,b,e,a){d.filters={show:"settori"};$.getScript("js/blueimp-gallery.min.js");$.getScript("js/jquery.blueimp-gallery.min.js");d.fnz.loadMore=function(){d.vm.catLimit++};d.fnz.toggleFilters=function(g){d.filters.show=g};c.dt.priceLinee=a;d.fnz.setCurCat(parseInt(f.search().c));d.vm.categorie=d.fnz.categorie(c.dt.marchi);d.vm.lineeSettori=d.fnz.lineeSettori(c.dt.marchi);d.vm.settori=d.fnz.settori();d.fnz.changeValue=function(g){if(!d.filtro.consegna){d.filtro.consegna=g}else{d.filtro.consegna=false}};d.fnz.toggleValue=function(g,h){if(d.filtro[h].indexOf(g)==-1){d.filtro[h].push(parseInt(g))}else{d.filtro[h].splice(d.filtro[h].indexOf(g),1)}};d.fnz.checkChecked=function(g,h){return _.contains(d.filtro[h],g)}}]);angular.module("mpu").controller("lineaCtrl",["$scope","$rootScope","$location","_","dataSvc","priceLinee","$window","$timeout","$http","lineeManager",function(n,l,f,m,d,h,b,c,j,k){var g=document.getElementsByClassName("SWD");var e=-1;c(function(){n.fnz.myLoop(e,g.length)});$.getScript("js/blueimp-gallery.min.js");$.getScript("js/jquery.blueimp-gallery.min.js");n.vm.lineeManager=k;var a=function(){switch(n.fnz.findPage()){case"vetrina":n.current.page=1;n.fnz.creaVetrine();break;case"composizione":n.current.page=1;n.fnz.creaVetrine();break;case"listino":n.current.page=2;n.fnz.creaListino();break;case"articolo":n.current.page=2;n.fnz.creaListino();break}};if(!n.current.page){if(f.search().a){n.current.art=m.findWhere(l.dt.prodotti,{i:parseInt(f.search().a)});n.current.lin=m.findWhere(l.dt.linee,{i:n.current.art.l})}else{if(f.search().v){n.current.cmp=m.findWhere(l.dt.vetrine,{i:parseInt(f.search().v)});n.current.cmp.p=m.filter(l.dt.vetrineProdotti,function(i){return i.c==n.current.cmp.i});n.current.lin=m.findWhere(l.dt.linee,{i:n.current.cmp.l})}else{n.current.lin=m.findWhere(l.dt.linee,{i:parseInt(f.search().l)})}}a()}else{switch(n.current.page){case 1:n.fnz.creaVetrine();break;case 2:n.fnz.creaListino();break}}if(n.fnz.findPage()=="listino"){n.vm.listinoLoaded=true;c(function(){n.vm.listinoLoaded=false},1000)}n.fnz.setCurPage=function(i){n.nm.linea=false;switch(i){case 1:f.url("/"+n.vm.loc+"/vetrina?l="+n.current.lin.i);n.filtro.cmp=false;n.current.cmp=false;n.current.page=1;break;case 2:f.url("/"+n.vm.loc+"/listino?l="+n.current.lin.i);n.filtro.tbpr=false;n.filtro.prd="";n.filtro.prdValue="";n.current.page=2;break}};if(f.search().v){n.fnz.creaComposizione(parseInt(f.search().v))}n.fnz.changeCmp=function(i){if(i){f.url("/"+n.vm.loc+"/composizione?&v="+i.i)}};n.fnz.changePrd=function(){f.url("/"+n.vm.loc+"/listino?l="+n.current.lin.i);n.nm.linea=false;n.fnz.scrollTop()}}]);angular.module("mpu").controller("preventivoCtrl",["$scope","$rootScope","$location","_","$cookies","tm","dataSvc",function(d,b,g,f,e,c,a){d.vm.tm=c;d.vm.categorie=d.fnz.categorie(b.dt.marchi);d.vm.lineeSettori=d.fnz.lineeSettori(b.dt.marchi);d.vm.settori=d.fnz.settori();d.fnz.numberRange=function(){if(d.prv.a>0){d.prv.a=0}if(d.prv.a<-100){d.prv.a=-100}};d.fnz.randomID=function(h){var m="";var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var k=0;k<h;k++){m+=j.charAt(Math.floor(Math.random()*j.length))}return m};d.fnz.resetPrv=function(){d.prv.pr=(e.get("MPU-A")!=0)?0:false;e.remove("MPU-Q")};d.$watchCollection("prv",function(h,i){if(h!==i){if(g.search().q){d.dataPrv.ID=g.search().q;g.search("q",null)}else{d.dataPrv.ID=d.fnz.randomID(10)}e.put("MPU-Q",d.dataPrv.ID)}d.fnz.lookPrv(h.pr)});d.fnz.lookPrv=function(h){if(!h&&e.get("MPU-I")!=0){k=angular.copy(f.find(b.dt.rivenditori,function(l){return l.i==e.get("MPU-I")}));d.dataPrv.rivID=k.i;d.dataPrv.rivNome=k.n;d.dataPrv.rivTel=k.h;d.dataPrv.rivenditore=(k.v==0);h=k.p;if(e.get("MPU-A")!=0){d.dataPrv.agente=f.find(b.dt.agenti,function(l){return l.i==e.get("MPU-A")})}}else{k=f.find(b.dt.rivenditori,function(l){return l.p==h});if(k){d.dataPrv.rivID=k.i;d.dataPrv.rivNome=k.n;d.dataPrv.rivTel=k.h;d.dataPrv.rivenditore=true}else{k=f.find(b.dt.province,function(l){return l.i==h});d.dataPrv.rivID=0;d.dataPrv.rivenditore=false}}if(k){d.dataPrv.prNome=d.fnz.convert(h,"province","n");d.prv.z=0;f.each(d.prv.list,function(l){d.prv.z+=l.z*l.q});var i=false;var k;d.prv.l=k.l;d.prv.b=k.b;e.putObject("MPU-P",d.prv);d.dataPrv.sav=Math.ceil((d.prv.z*d.prv.a)/100);d.dataPrv.sas=d.fnz.convertPrice(d.dataPrv.sav);if(d.prv.tm==2||d.prv.tm==1){switch(k.j){case 1:if(k.t==0){d.prv.t=0;d.dataPrv.trasporto="gratuito"}else{d.prv.t=k.t;d.dataPrv.trasporto=d.fnz.convertPrice(d.prv.t)+" €"}d.dataPrv.quantificare=false;d.prv.j=1;break;case 2:d.prv.t=Math.ceil((d.prv.z*k.t)/100);d.dataPrv.trasporto=d.fnz.convertPrice(d.prv.t)+" €";d.dataPrv.quantificare=false;d.prv.j=2;break;case 3:d.prv.t=0;d.dataPrv.trasporto="N/A**";d.dataPrv.quantificare=true;d.prv.b=0;d.prv.j=3;break}if(d.prv.tm==2){switch(k.k){case 1:if(k.m==0){d.prv.m=0;d.dataPrv.montaggio="gratuito"}else{d.prv.m=k.m;d.dataPrv.montaggio=d.fnz.convertPrice(d.prv.m)+" €"}d.prv.k=1;d.dataPrv.quantificare=false;break;case 2:d.prv.m=Math.ceil((d.prv.z*k.m)/100);d.dataPrv.montaggio=d.fnz.convertPrice(d.prv.m)+" €";d.dataPrv.quantificare=false;d.prv.k=2;break;case 3:d.prv.m=0;d.dataPrv.montaggio="N/A**";d.dataPrv.quantificare=true;d.prv.b=0;d.prv.k=3;break}}else{d.prv.m=0;d.dataPrv.montaggio="non richiesto";d.dataPrv.quantificare=false}}else{d.prv.t=0;d.dataPrv.trasporto="non richiesto";d.prv.m=0;d.dataPrv.montaggio="non richiesto";d.dataPrv.quantificare=false}if(d.prv.z<d.prv.l&&!d.dataPrv.quantificare){d.dataPrv.minimo=d.fnz.convertPrice(d.prv.b);d.dataPrv.limite=d.fnz.convertPrice(d.prv.l)}else{d.prv.b=0;d.dataPrv.minimo=false;d.dataPrv.limite=false}var j=d.prv.z+d.prv.b+d.prv.t+d.prv.m+d.dataPrv.sav;d.dataPrv.ivaNumber=(j*22)/100;d.dataPrv.iva=d.fnz.convertPrice(d.dataPrv.ivaNumber)+" €";d.dataPrv.complessivo=d.fnz.convertPrice(d.prv.z+d.prv.b+d.prv.t+d.prv.m+d.dataPrv.sav+d.dataPrv.ivaNumber)}else{d.prv.z=0;f.each(d.prv.list,function(l){d.prv.z+=l.z*l.q});d.dataPrv.totale=d.fnz.convertPrice(d.prv.z)}};d.$on("prv.list",function(){if(!d.dataPrv.ID){d.dataPrv.ID=d.fnz.randomID(10)}d.fnz.lookPrv(e.getObject("MPU-P").pr);d.dataPrv.totale=d.fnz.convertPrice(d.prv.z)});if(g.search().q){d.fnz.lookPrv(e.getObject("MPU-P").pr)}d.fnz.convertToPositive=function(h){return Math.abs(h)}}]);angular.module("mpu").controller("formCtrl",["$scope","$location","cliente","spedizione","pagamenti",function(h,e,f,c,g){h.vm.validated=false;h.tipologia=f;h.spedizione=c;h.pagamenti=g;var a=function(){return(d.s==""||d.v==""||d.e==""||d.a==""||d.c==""||d.p==""||d.t1==""||d.n=="")};var b=function(){return(d.v==""||d.e==""||d.a==""||d.c==""||d.p==""||d.t1=="")};var i=function(){return(d.dn==""||d.de==""||d.da==""||d.dc==""||d.dp==""||d.dt1=="")};h.$watchCollection("cliente",function(){h.vm.validated=false;h.fnz.checkDatiCliente()});var d=h.cliente;h.fnz.checkDatiCliente=function(){if(d.t==1&&d.d==1){h.vm.validated=(!a()&&d.d==1&&d.py&&d.cv)}if(d.t==2&&d.d==1){h.vm.validated=(!b()&&d.d==1&&d.py&&d.cv)}if(d.t==1&&d.d==0){h.vm.validated=(!a()&&!i()&&d.py&&d.cv)}if(d.t==2&&d.d==0){h.vm.validated=(!b()&&!i()&&d.py&&d.cv)}}}]);angular.module("mpu").controller("ordineCtrl",["$scope","$location","$http","$cookies","$rootScope",function(b,e,d,c,a){b.fnz.getOrder=function(f){if(c.get("MPU-I")==0){var h=_.find(a.dt.rivenditori,function(i){return i.p==c.get("MPU-Q").pr});if(h){var g=h.i}else{g=0}}else{h=angular.copy(_.find(a.dt.rivenditori,function(i){return i.i==c.get("MPU-I")}));g=h.i}d.post("php/ordine.php?action=get",{ID:f,RIV:g}).success(function(i){b.cliente=i.cliente;b.ordine.data=new Date(i.data*1000);b.ordine.id=i.id})};if(e.search().q){b.dataPrv.ID=e.search().q;c.put("MPU-Q",e.search().q)}else{b.dataPrv.ID=c.get("MPU-Q")}b.ordine={};b.fnz.getOrder(b.dataPrv.ID)}]);angular.module("mpu").controller("faqCtrl",["$scope","dataSvc",function(c,a){a.faq().then(function(d){c.vm.faq=d.data});var b=[];c.fnz.manageFaq=function(d){if(_.contains(b,d)){var e=b.indexOf(d);b.splice(e,1)}else{b.push(d)}};c.fnz.checkFaq=function(d){return _.contains(b,d)}}]);