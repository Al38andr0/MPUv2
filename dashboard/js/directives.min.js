var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,g){a instanceof String&&(a=String(a));for(var c=a.length,f=0;f<c;f++){var d=a[f];if(e.call(g,d,f,a))return{i:f,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,g){a!=Array.prototype&&a!=Object.prototype&&(a[e]=g.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,g,c){if(e){g=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var f=a[c];f in g||(g[f]={});g=g[f]}a=a[a.length-1];c=g[a];e=e(c);e!=c&&null!=e&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,g){return $jscomp.findInternal(this,a,g).v}},"es6","es3");angular.module("mpuDashboard").directive("fileread",[function(){return{scope:{fileread:"="},link:function(a,e,g){e.bind("change",function(c){var f=new FileReader;f.onload=function(d){a.$apply(function(){a.fileread=d.target.result})};f.readAsDataURL(c.target.files[0])})}}}]);
angular.module("mpuDashboard").directive("categorie",function(){return{restrict:"E",templateUrl:"template/categorie.html",scope:{categoriaOriginal:"=",vm:"="},controller:function(a,e,g,c){console.log(a.categoriaOriginal);a.$watch("categoriaOriginal",function(c){a.cat=angular.copy(c.categoria);a.cat.r="../dashboard/archivio_dati/Categorie/"+a.cat.i+".jpg"});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.cat.n||!a.cat.r||!a.cat.x||
isNaN(a.cat.y)};a.newItem=function(){a.categoriaOriginal.selected=!1;c.saving=!1;a.vm.nuovaCategoria={i:a.vm.nuovaCategoria.i+1,v:1,r:!1}};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/categorie.php?type=update",{id:a.cat.i,nome:a.cat.n,pos:a.cat.y,show:a.cat.v,text:a.cat.x,image:a.cat.r}).success(function(d){a.vm.saveCategorieData();_.each(a.vm.categorie,function(b){b.i==a.cat.i&&(b.n=a.cat.n,b.y=a.cat.y,b.v=a.cat.v,b.r=a.cat.r,b.x=a.cat.x,a.cat=angular.copy(b),delete b.r)});c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/categorie.php?type=delete",{id:a.cat.i,nome:a.cat.n,pos:a.cat.y,show:a.cat.v,text:a.cat.x,image:a.cat.r}).success(function(d){a.vm.categorie=_.filter(a.vm.categorie,function(b){return b.i!=a.cat.i});a.vm.saveCategorieData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("settori",function(){return{restrict:"E",templateUrl:"template/settori.html",scope:{settoreOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("settoreOriginal",function(c){a.set=angular.copy(c.settore);a.set.r="../dashboard/archivio_dati/Settori/"+a.set.i+".jpg"});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.set.n||!a.set.x||isNaN(a.set.y)};a.newSettore=function(){a.settoreOriginal.selected=
!1;c.saving=!1;a.vm.nuovoSettore={i:a.vm.nuovoSettore.i+1,v:1,o:1,g:!1,r:!1}};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/settori.php?type=update",{id:a.set.i,nome:a.set.n,pos:a.set.y,show:a.set.v,cat:a.set.g,image:a.set.r,text:a.set.x,home:a.set.o}).success(function(d){a.vm.saveSettoriData();_.each(a.vm.settori,function(b){b.i==a.set.i&&(b.n=a.set.n,b.y=a.set.y,b.v=a.set.v,b.g=a.set.g,b.r=a.set.r,b.x=a.set.x,b.o=a.set.o,a.set=angular.copy(b),delete b.r)});c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/settori.php?type=delete",{id:a.set.i,nome:a.set.n,pos:a.set.y,show:a.set.v,cat:a.set.g,image:a.set.r,text:a.set.x,home:a.set.o}).success(function(d){a.vm.settori=_.filter(a.vm.settori,function(b){return b.i!=a.set.i});a.vm.saveSettoriData();a.newSettore()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("marchi",function(){return{restrict:"E",templateUrl:"template/marchi.html",scope:{marchioOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("marchioOriginal",function(c){a.mark=angular.copy(c.marchio)});a.errore={marchio:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.selectedCat=function(c){return-1!=a.mark.g.indexOf(c)};a.toggleSet=function(c){-1==a.mark.g.indexOf(c)?a.mark.g.push(parseInt(c)):a.mark.g.splice(a.mark.g.indexOf(c),
1)};a.updateCheck=function(){return!a.mark.n||0==a.mark.g.length||isNaN(a.mark.b)||isNaN(a.mark.s)};a.deleteCheck=function(){return a.mark.n!==a.marchioOriginal.marchio.n};a.newMarchio=function(){a.marchioOriginal.selected=!1;c.saving=!1;a.errore.marchio=!1;a.vm.nuovoMarchio={i:a.vm.nuovoMarchio.i+1,v:1,g:[],b:0,s:0}};a.action=function(f){if("U"==f){var d=a.mark.n!==a.marchioOriginal.marchio.n?_.findWhere(a.vm.marchi,{n:a.mark.n}):!1;d?a.errore.marchio=!0:(c.saving=!0,e.post("php/marchi.php?type=update",
{id:a.mark.i,nome:a.mark.n,show:a.mark.v,list:a.mark.b,disc:a.mark.s,cat_array:a.mark.g}).success(function(b){a.vm.saveMarchiData();_.each(a.vm.marchi,function(b){b.i==a.mark.i&&(b.n=a.mark.n,b.v=a.mark.v,b.g=a.mark.g,b.b=a.mark.b,b.s=a.mark.s,a.mark=angular.copy(b));return a.vm.marchi});a.errore.marchio=!1;c.saving=!1}).error(function(a,d){console.log(d)}))}"D"==f&&(c.saving=!0,e.post("php/marchi.php?type=delete",{id:a.mark.i,nome:a.mark.n,show:a.mark.v,list:a.mark.b,disc:a.mark.s,cat_array:a.mark.g}).success(function(b){a.vm.marchi=
_.filter(a.vm.marchi,function(b){return b.i!=a.mark.i});a.vm.saveMarchiData();a.newMarchio()}).error(function(a,d){console.log(d)}))}}}});
angular.module("mpuDashboard").directive("tbpr",function(){return{restrict:"E",templateUrl:"template/marchiTabelle.html",scope:{tbprOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("tbprOriginal",function(d){a.tbpr=angular.copy(d.tbpr)});a.errore={tbpr:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.tbpr.n||isNaN(a.tbpr.y)};a.copyCheck=function(){return!a.tbpr.n||isNaN(a.tbpr.y)||a.tbpr.n===a.tbprOriginal.tbpr.n&&a.tbpr.m===
a.tbprOriginal.tbpr.m};a.newTbpr=function(){a.tbprOriginal.selected=!1;c.saving=!1;a.errore.tbpr=!1;a.vm.nuovaTbpr={i:a.vm.nuovaTbpr.i+1,m:!1,y:1}};var f=function(){return a.tbpr.n!=a.tbprOriginal.tbpr.n||a.tbpr.m!=a.tbprOriginal.tbpr.m?_.findWhere(a.vm.tbpr,{n:a.tbpr.n,m:a.tbpr.m}):!1};a.checkCopy=function(){return _.findWhere(a.vm.tbpr,{n:a.tbpr.n,m:a.tbpr.m})};a.action=function(d){"U"==d&&(f()?a.errore.tbpr=!0:(c.saving=!0,e.post("php/marchiTabelle.php?type=update",{id:a.tbpr.i,nome:a.tbpr.n,pos:a.tbpr.y,
mark:a.tbpr.m}).success(function(b){a.vm.saveTbprData();_.each(a.vm.tbpr,function(b){b.i==a.tbpr.i&&(b.n=a.tbpr.n,b.m=a.tbpr.m,b.y=a.tbpr.y,a.tbpr=angular.copy(b))});c.saving=!1;a.errore.tbpr=!1}).error(function(a,d){console.log(d)})));"C"==d&&(f()?a.errore.tbpr=!0:(c.saving=!0,e.post("php/marchiTabelle.php?type=new",{id:a.vm.nuovaTbpr.i,nome:a.tbpr.n,pos:a.tbpr.y,mark:a.tbpr.m}).success(function(b){a.vm.copiedTbpr={i:a.vm.nuovaTbpr.i,n:a.tbpr.n,y:a.tbpr.y,m:a.tbpr.m};a.vm.tbpr.push(a.vm.copiedTbpr);
a.vm.saveTbprData();a.vm.nuovaTbpr={i:a.vm.nuovaTbpr.i+1};c.saving=!1;a.errore.tbpr=!1}).error(function(a,d){console.log(d)})));"D"==d&&(c.saving=!0,e.post("php/marchiTabelle.php?type=delete",{id:a.tbpr.i,nome:a.tbpr.n,pos:a.tbpr.y,mark:a.tbpr.m}).success(function(b){a.vm.tbpr=_.filter(a.vm.tbpr,function(b){return b.i!=a.tbpr.i});a.vm.saveTbprData();a.newTbpr()}).error(function(a,d){console.log(d)}))}}}});
angular.module("mpuDashboard").directive("finiture",function(){return{restrict:"E",templateUrl:"template/finiture.html",scope:{finituraOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(d){_.each(a.vm.marchi,function(a){a.i==d&&(markByName=a.n)});return markByName}a.errore={finitura:!1};a.$watch("finituraOriginal",function(d){a.finitura=angular.copy(d.finitura);d=f(a.finitura.m);d=d.replace(/ /g,"_");var b=a.finitura.n.replace(/ /g,"_")+"_"+a.finitura.c.replace(" ","_")+".jpg";a.finitura.r=
"../dashboard/archivio_dati/"+d+"/Finiture/"+b});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.finitura.n||!a.finitura.c||!a.finitura.m};a.deleteCheck=function(){return a.finitura.n!==a.finituraOriginal.finitura.n||a.finitura.c!==a.finituraOriginal.finitura.c||a.finitura.m!==a.finituraOriginal.finitura.m};a.copyCheck=function(){return!a.finitura.n||!a.finitura.c||!a.finitura.m||a.finitura.n===a.finituraOriginal.finitura.n&&a.finitura.c===
a.finituraOriginal.finitura.c};a.newFinitura=function(){c.saving=!1;a.errore.finitura=!1;a.finituraOriginal.selected=!1;a.vm.nuovaFinitura={i:a.vm.nuovaFinitura.i+1,v:1,p:0,m:!1,r:!1}};a.action=function(d){if("U"==d){var b=a.finitura.n!=a.finituraOriginal.finitura.n||a.finitura.c!=a.finituraOriginal.finitura.c||a.finitura.m!=a.finituraOriginal.finitura.m?_.findWhere(a.vm.finiture,{n:a.finitura.n,c:a.finitura.c,m:a.finitura.m}):!1;b?a.errore.finitura=!0:(c.saving=!0,e.post("php/finiture.php?type=update",
{id:a.finitura.i,nome:a.finitura.n,cod:a.finitura.c,show:a.finitura.v,mark:a.finitura.m,type:a.finitura.p,image:a.finitura.r,sourceNome:a.finituraOriginal.finitura.n,sourceCod:a.finituraOriginal.finitura.c,sourceMark:a.finituraOriginal.finitura.m}).success(function(b){a.errore.finitura=!1;a.vm.saveFinituraData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.finiture,function(b){b.i==a.finitura.i&&(b.n=a.finitura.n,b.m=a.finitura.m,b.c=a.finitura.c,b.r=a.finitura.r,b.p=a.finitura.p,b.v=a.finitura.v,
a.finitura=angular.copy(b))});c.saving=!1;a.errore.finitura=!1}).error(function(a,b){console.log(b)}))}"C"==d&&(_.findWhere(a.vm.finiture,{n:a.finitura.n,c:a.finitura.c,m:a.finitura.m})?a.errore.finitura=!0:(c.saving=!0,e.post("php/finiture.php?type=new",{id:a.vm.nuovaFinitura.i,nome:a.finitura.n,cod:a.finitura.c,show:a.finitura.v,mark:a.finitura.m,type:a.finitura.p,image:a.finitura.r,sourceNome:a.finituraOriginal.finitura.n,sourceCod:a.finituraOriginal.finitura.c,sourceMark:a.finituraOriginal.finitura.m}).success(function(b){a.vm.copiedfinitura=
{i:a.vm.nuovaFinitura.i,n:a.finitura.n,c:a.finitura.c,v:a.finitura.v,m:a.finitura.m,p:a.finitura.p};a.vm.finiture.push(a.vm.copiedfinitura);a.vm.nuovaFinitura={i:a.vm.nuovaFinitura.i+1};a.vm.saveFinituraData();c.saving=!1;a.errore.finitura=!1}).error(function(a,b){console.log(b)})));"D"==d&&(c.saving=!0,e.post("php/finiture.php?type=delete",{id:a.finitura.i,nome:a.finitura.n,cod:a.finitura.c,show:a.finitura.v,mark:a.finitura.m,type:a.finitura.p,image:a.finitura.r}).success(function(b){a.vm.finiture=
_.filter(a.vm.finiture,function(b){return b.i!=a.finitura.i});a.vm.saveFinituraData();a.newFinitura()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("linee",function(){return{restrict:"E",templateUrl:"template/linee.html",scope:{lineaOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(d){_.each(a.vm.marchi,function(a){a.i==d&&(markByName=a.n)});return markByName}a.errore={linea:!1};a.priceName=[{n:"economico",i:2},{n:"design",i:3},{n:"top class",i:4}];a.$watch("lineaOriginal",function(d){a.linea=angular.copy(d.linea);d=f(a.linea.m);d=d.replace(/ /g,"_");lineaName=a.linea.n.replace(/ /g,"_");var b=
a.linea.n.replace(" ","_")+"_specifiche.pdf",h=a.linea.n.replace(" ","_")+"_catalogo.pdf",c=a.linea.n.replace(" ","_")+".jpg";a.linea.ctlPath="../dashboard/archivio_dati/"+d+"/"+lineaName+"/"+h;a.linea.jPath="../dashboard/archivio_dati/"+d+"/"+lineaName+"/"+b;a.linea.r="../dashboard/archivio_dati/"+d+"/"+lineaName+"/"+c});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.linea.n||isNaN(a.linea.e)||isNaN(a.linea.w)||isNaN(a.linea.s)||
!a.linea.m};a.deleteCheck=function(){return a.linea.n!==a.lineaOriginal.linea.n||a.linea.m!==a.lineaOriginal.linea.m};a.addLink=function(){a.linea.a.push(!1)};a.removeLink=function(d){1==a.linea.a.length?a.linea.a=[!1]:a.linea.a.splice(d,1)};a.selectedCat=function(d){return-1!=a.linea.q.indexOf(d)};a.toggleSet=function(d){-1==a.linea.q.indexOf(d)?a.linea.q.push(parseInt(d)):a.linea.q.splice(a.linea.q.indexOf(d),1)};a.newLinea=function(){c.saving=!1;a.errore.linea=!1;a.lineaOriginal.selected=!1;a.vm.nuovaLinea=
{i:a.vm.nuovaLinea.i+1,q:[],a:[!1],v:1,z:2,b:0,y:100,c:0,s:0,e:25,w:2,r:!1,k:!1,j:!1}};a.action=function(d){if("U"==d){var b=a.linea.n!=a.lineaOriginal.linea.n||a.linea.m!=a.lineaOriginal.linea.m?_.findWhere(a.vm.linee,{n:a.linea.n,m:a.linea.m}):!1;b?a.errore.linea=!0:(c.saving=!0,e.post("php/linee.php?type=update",{id:a.linea.i,nome:a.linea.n,mark:a.linea.m,disc:a.linea.s,time:a.linea.e,war:a.linea.w,ctl:a.linea.k,spc:a.linea.j,image:a.linea.r,show:a.linea.v,price:a.linea.z,cat:a.linea.g,set:a.linea.q,
link:a.linea.a,vtr:a.linea.c,pos:a.linea.y,sourceNome:a.lineaOriginal.linea.n,sourceMark:a.lineaOriginal.linea.m,sourceCtl:a.lineaOriginal.linea.k,sourceSpc:a.lineaOriginal.linea.j}).success(function(b){a.errore.linea=!1;a.vm.saveLineaData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.linee,function(b){b.i==a.linea.i&&(b.n=a.linea.n,b.m=a.linea.m,b.e=a.linea.e,b.w=a.linea.w,b.j=a.linea.j,b.k=a.linea.k,b.s=a.linea.s,b.r=a.linea.r,b.v=a.linea.v,b.z=a.linea.z,b.g=a.linea.g,b.y=a.linea.y,b.a=
a.linea.a,b.c=a.linea.c,a.linea=angular.copy(b));return a.vm.linee});c.saving=!1;a.errore.linea=!1}).error(function(a,b){console.log(b)}))}"D"==d&&(c.saving=!0,e.post("php/linee.php?type=delete",{id:a.linea.i,nome:a.linea.n,mark:a.linea.m,disc:a.linea.s,time:a.linea.e,war:a.linea.w,ctl:a.linea.k,spc:a.linea.j,image:a.linea.r,show:a.linea.v,price:a.linea.z,cat:a.linea.g,set:a.linea.q,link:a.linea.a,vtr:a.linea.c,pos:a.linea.y}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.linee=
_.filter(a.vm.linee,function(b){return b.i!=a.linea.i});a.vm.saveLineaData();a.newLinea()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("finitureTabelle",function(){return{restrict:"E",templateUrl:"template/finitureTabelle.html",scope:{finituraTabellaOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("finituraTabellaOriginal",function(c){a.finituraTabella=angular.copy(c.finituraTabella)});a.errore={finituraTabella:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.finituraTabella.n||!a.finituraTabella.m||!a.finituraTabella.l};
a.copyCheck=function(){return!a.finituraTabella.n||!a.finituraTabella.m||!a.finituraTabella.l||a.finituraTabella.n===a.finituraTabellaOriginal.finituraTabella.n&&a.finituraTabella.m===a.finituraTabellaOriginal.finituraTabella.m&&a.finituraTabella.l===a.finituraTabellaOriginal.finituraTabella.l};a.newFinituraTabella=function(){c.saving=!1;a.errore.finituraTabella=!1;a.finituraTabellaOriginal.selected=!1;a.vm.nuovaFinituraTabella={i:a.vm.nuovaFinituraTabella.i+1,m:!1,l:!1}};a.action=function(f){if("U"==
f){var d=a.finituraTabella.n!=a.finituraTabellaOriginal.finituraTabella.n||a.finituraTabella.m!=a.finituraTabellaOriginal.finituraTabella.m||a.finituraTabella.l!=a.finituraTabellaOriginal.finituraTabella.l?_.findWhere(a.vm.finitureTabelle,{n:a.finituraTabella.n,m:a.finituraTabella.m,l:a.finituraTabella.l}):!1;d?a.errore.finituraTabella=!0:(c.saving=!0,e.post("php/finitureTabelle.php?type=update",{id:a.finituraTabella.i,nome:a.finituraTabella.n,line:a.finituraTabella.l,mark:a.finituraTabella.m}).success(function(b){a.vm.saveFinitureTabelleData();
_.each(a.vm.finitureTabelle,function(b){b.i==a.finituraTabella.i&&(b.n=a.finituraTabella.n,b.m=a.finituraTabella.m,b.l=a.finituraTabella.l,a.finituraTabella=angular.copy(b))});c.saving=!1;a.errore.finituraTabella=!1}).error(function(a,d){console.log(d)}))}"C"==f&&(_.findWhere(a.vm.finitureTabelle,{n:a.finituraTabella.n,m:a.finituraTabella.m,l:a.finituraTabella.l})?a.errore.finituraTabella=!0:(c.saving=!0,e.post("php/finitureTabelle.php?type=new",{id:a.vm.nuovaFinituraTabella.i,nome:a.finituraTabella.n,
line:a.finituraTabella.l,mark:a.finituraTabella.m}).success(function(b){a.vm.copiedFinituraTabella={i:a.vm.nuovaFinituraTabella.i,n:a.finituraTabella.n,l:a.finituraTabella.l,m:a.finituraTabella.m};a.vm.finitureTabelle.push(a.vm.copiedFinituraTabella);a.vm.nuovaFinituraTabella={i:a.vm.nuovaFinituraTabella.i+1};a.vm.saveFinitureTabelleData();c.saving=!1;a.errore.finituraTabella=!1}).error(function(a,d){console.log(d)})));"D"==f&&(c.saving=!0,e.post("php/finitureTabelle.php?type=delete",{id:a.finituraTabella.i,
nome:a.finituraTabella.n,line:a.finituraTabella.l,mark:a.finituraTabella.m}).success(function(b){a.vm.finitureTabelle=_.filter(a.vm.finitureTabelle,function(b){return b.i!=a.finituraTabella.i});a.vm.saveFinitureTabelleData();a.newFinituraTabella()}).error(function(a,d){console.log(d)}))}}}});
angular.module("mpuDashboard").directive("abbinamenti",function(){return{restrict:"E",templateUrl:"template/abbinamenti.html",scope:{abbinamentoOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(){return _.filter(a.abbinamento.f,function(a){return!a.i||!a.n}).length}a.$watch("abbinamentoOriginal",function(d){a.abbinamento=angular.copy(d.abbinamento)});a.errore={abbinamento:!1};a.addAbbinamento=function(){a.abbinamento.f.push({i:!1,n:""})};a.removeAbbinamento=function(d){a.abbinamento.f.splice(d,
1)};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.abbinamento.c||!a.abbinamento.u};a.copyCheck=function(){return!a.abbinamento.c||!a.abbinamento.m||!a.abbinamento.l||a.abbinamento.c===a.abbinamentoOriginal.abbinamento.c&&a.abbinamento.m===a.abbinamentoOriginal.abbinamento.m&&a.abbinamento.l===a.abbinamentoOriginal.abbinamento.l};a.newAbbinamento=function(){c.saving=!1;a.errore.abbinamento=!1;a.abbinamentoOriginal.selected=!1;a.vm.nuovoAbbinamento=
{i:a.vm.nuovoAbbinamento.i+1,m:!1,l:!1,u:!1,f:[{i:!1,n:""}]}};a.action=function(d){if("U"==d){var b=a.abbinamento.c!=a.abbinamentoOriginal.abbinamento.c||a.abbinamento.m!=a.abbinamentoOriginal.abbinamento.m||a.abbinamento.l!=a.abbinamentoOriginal.abbinamento.l?_.findWhere(a.vm.abbinamenti,{n:a.abbinamento.c,m:a.abbinamento.m,l:a.abbinamento.l}):!1;b||0!==f()?a.errore.abbinamento=!0:(c.saving=!0,e.post("php/abbinamenti.php?type=update",{id:a.abbinamento.i,cod:a.abbinamento.c,line:a.abbinamento.l,mark:a.abbinamento.m,
abb_array:a.abbinamento.f,tab:a.abbinamento.u}).success(function(b){a.vm.saveAbbinamentiData();_.each(a.vm.abbinamenti,function(b){b.i==a.abbinamento.i&&(b.c=a.abbinamento.c,b.l=a.abbinamento.l,b.m=a.abbinamento.m,b.f=a.abbinamento.f,b.u=a.abbinamento.u,a.abbinamento=angular.copy(b))});c.saving=!1;a.errore.abbinamento=!1}).error(function(a,b){console.log(b)}))}"C"==d&&(_.findWhere(a.vm.abbinamenti,{c:a.abbinamento.c,m:a.abbinamento.m,l:a.abbinamento.l,u:a.abbinamento.u})?a.errore.abbinamento=!0:(c.saving=
!0,e.post("php/abbinamenti.php?type=new",{id:a.vm.nuovoAbbinamento.i,cod:a.abbinamento.c,line:a.abbinamento.l,mark:a.abbinamento.m,abb_array:a.abbinamento.f,tab:a.abbinamento.u}).success(function(b){a.vm.copiedAbbinamento=angular.copy({i:a.vm.nuovoAbbinamento.i,c:a.abbinamento.c,l:a.abbinamento.l,m:a.abbinamento.m,f:a.abbinamento.f,u:a.abbinamento.u});a.vm.abbinamenti.push(a.vm.copiedAbbinamento);a.vm.nuovoAbbinamento={i:a.vm.nuovoAbbinamento.i+1};a.vm.saveAbbinamentiData();c.saving=!1;a.errore.abbinamento=
!1}).error(function(a,b){console.log(b)})));"D"==d&&(c.saving=!0,e.post("php/abbinamenti.php?type=delete",{id:a.abbinamento.i,cod:a.abbinamento.c,line:a.abbinamento.l,mark:a.abbinamento.m,abb_array:a.abbinamento.f,tab:a.abbinamento.u}).success(function(b){a.vm.abbinamenti=_.filter(a.vm.abbinamenti,function(b){return b.i!=a.abbinamento.i});a.vm.saveAbbinamentiData();a.newAbbinamento()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("lineeSettori",function(){return{restrict:"E",templateUrl:"template/lineeSettori.html",scope:{lineaSettoreOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function d(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}function b(b){_.each(a.vm.settori,function(a){a.i==b&&(setByName=a.n)});return setByName}a.errore={lineaSettore:!1};a.$watch("lineaSettoreOriginal",
function(c){a.lineaSettore=angular.copy(c.lineaSettore);c=f(a.lineaSettore.m);var h=d(a.lineaSettore.l),e=b(a.lineaSettore.h);c=c.replace(/ /g,"_");h=h.replace(/ /g,"_");e=e.replace(/ /g,"_");a.lineaSettore.r="../dashboard/archivio_dati/"+c+"/"+h+"/Vetrina/"+(h+"_"+e+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.toggleSet=function(b){-1==a.lineaSettore.q.indexOf(b)?a.lineaSettore.q.push(parseInt(b)):a.lineaSettore.q.splice(a.lineaSettore.q.indexOf(b),
1)};a.checkList=function(b){return-1!=a.lineaSettore.q.indexOf(b)};a.updateCheck=function(){return!a.lineaSettore.m||!a.lineaSettore.l||!a.lineaSettore.h};a.deleteCheck=function(){return a.lineaSettore.m!==a.lineaSettoreOriginal.lineaSettore.m||a.lineaSettore.l!==a.lineaSettoreOriginal.lineaSettore.l||a.lineaSettore.h!==a.lineaSettoreOriginal.lineaSettore.h};a.newItem=function(){c.saving=!1;a.lineaSettoreOriginal.selected=!1;a.vm.nuovaLineaSettore={i:a.vm.nuovaLineaSettore.i+1,v:1,p:0,z:1,q:[],m:!1,
r:!1};a.errore.lineaSettore=!1};a.action=function(b){if("U"==b){var d=a.lineaSettore.m!=a.lineaSettoreOriginal.lineaSettore.m||a.lineaSettore.l!=a.lineaSettoreOriginal.lineaSettore.l||a.lineaSettore.h!=a.lineaSettoreOriginal.lineaSettore.h?_.findWhere(a.vm.lineeSettori,{m:a.lineaSettore.m,l:a.lineaSettore.l,h:a.lineaSettore.h}):!1;d||0==a.lineaSettore.q.length?a.errore.lineaSettore=!0:(c.saving=!0,e.post("php/lineeSettori.php?type=update",{id:a.lineaSettore.i,mark:a.lineaSettore.m,line:a.lineaSettore.l,
set:a.lineaSettore.h,show:a.lineaSettore.v,price:a.lineaSettore.z,man:a.lineaSettore.q,image:a.lineaSettore.r,sourceMark:a.lineaSettoreOriginal.lineaSettore.m,sourceLine:a.lineaSettoreOriginal.lineaSettore.l,sourceSet:a.lineaSettoreOriginal.lineaSettore.h}).success(function(b){a.errore.lineaSettore=!1;a.vm.saveLineaSettoreData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.lineeSettori,function(b){b.i==a.lineaSettore.i&&(b.m=a.lineaSettore.m,b.l=a.lineaSettore.l,b.h=a.lineaSettore.h,b.r=
a.lineaSettore.r,b.z=a.lineaSettore.z,b.q=a.lineaSettore.q,b.v=a.lineaSettore.v,a.lineaSettore=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}))}"D"==b&&(c.saving=!0,e.post("php/lineeSettori.php?type=delete",{id:a.lineaSettore.i,mark:a.lineaSettore.m,line:a.lineaSettore.l,set:a.lineaSettore.h,show:a.lineaSettore.v,price:a.lineaSettore.z,man:a.lineaSettore.q,image:a.lineaSettore.r}).success(function(b){a.vm.lineeSettori=_.filter(a.vm.lineeSettori,function(b){return b.i!=a.lineaSettore.i});
a.vm.saveLineaSettoreData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("prodotti",function(){return{restrict:"E",templateUrl:"template/prodotti.html",scope:{prodottoOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function d(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={prodotto:!1};a.addProdotto=function(){a.prodotto.z.push({z:"",a:""})};a.removeProdotto=function(b){a.prodotto.z.splice(b,1)};a.$watch("prodottoOriginal",
function(b){a.prodotto=angular.copy(b.prodotto);b=f(a.prodotto.m);var c=d(a.prodotto.l);b=b.replace(/ /g,"_");c=c.replace(/ /g,"_");a.prodotto.r="../dashboard/archivio_dati/"+b+"/"+c+"/Prodotti/"+(a.prodotto.c+".jpg")});a.confirm=!1;a.confirmAll=!1;a.askConfirm=function(b){b?(a.confirmAll=!0,g(function(){a.confirmAll=!1},4E3)):(a.confirm=!0,g(function(){a.confirm=!1},4E3))};a.updateCheck=function(){return!a.prodotto.c||!a.prodotto.n||!a.prodotto.m||!a.prodotto.l||!a.prodotto.x||!a.prodotto.t||!a.prodotto.r};
a.deleteCheck=function(){return a.prodotto.c!==a.prodottoOriginal.prodotto.c||a.prodotto.m!==a.prodottoOriginal.prodotto.m||a.prodotto.l!==a.prodottoOriginal.prodotto.l};a.copyCheck=function(){return!a.prodotto.c||!a.prodotto.m||!a.prodotto.l||a.prodotto.c===a.prodottoOriginal.prodotto.c};var b=function(){return _.filter(a.prodotto.z,function(a){return isNaN(a.z)||!a.z||!a.a}).length};a.newProdotto=function(){c.saving=!1;a.errore.prodotto=!1;a.prodottoOriginal.selected=!1;a.vm.nuovoProdotto={i:a.vm.nuovoProdotto.i+
1,m:!1,l:!1,t:!1,a:"",y:1,f:0,z:[{z:"",a:""}]}};a.action=function(d){if("U"===d){var f=a.prodotto.c!=a.prodottoOriginal.prodotto.c||a.prodotto.l!=a.prodottoOriginal.prodotto.l?_.findWhere(a.vm.prodotti,{c:a.prodotto.c,l:a.prodotto.l}):!1;f||0!==b()?a.errore.prodotto=!0:(c.saving=!0,e.post("php/prodotti.php?type=update",{id:a.prodotto.i,mark:a.prodotto.m,line:a.prodotto.l,cod:a.prodotto.c,title:a.prodotto.n,tbpr:a.prodotto.t,dim:a.prodotto.d,pos:a.prodotto.y,lnfn:a.prodotto.x,note:a.prodotto.o,abb:a.prodotto.a,
fin:a.prodotto.f,prices:a.prodotto.z,image:a.prodotto.r,sourceCod:a.prodottoOriginal.prodotto.c,sourceMark:a.prodottoOriginal.prodotto.m,sourceLine:a.prodottoOriginal.prodotto.l}).success(function(b){a.errore.prodotto=!1;a.vm.saveProdottoData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.prodotti,function(b){b.i==a.prodotto.i&&(b.m=a.prodotto.m,b.l=a.prodotto.l,b.c=a.prodotto.c,b.n=a.prodotto.n,b.t=a.prodotto.t,b.d=a.prodotto.d,b.y=a.prodotto.y,b.x=a.prodotto.x,b.o=a.prodotto.o,b.a=a.prodotto.a,
b.f=a.prodotto.f,b.z=a.prodotto.z,b.r=a.prodotto.r,a.prodotto=angular.copy(b))});c.saving=!1;a.errore.prodotto=!1}).error(function(a,b){console.log(b)}))}"C"===d&&(_.findWhere(a.vm.prodotti,{c:a.prodotto.c,m:a.prodotto.m,l:a.prodotto.l})||0!==b()?a.errore.prodotto=!0:(c.saving=!0,e.post("php/prodotti.php?type=new",{id:a.vm.nuovoProdotto.i,mark:a.prodotto.m,line:a.prodotto.l,cod:a.prodotto.c,title:a.prodotto.n,tbpr:a.prodotto.t,dim:a.prodotto.d,pos:a.prodotto.y,lnfn:a.prodotto.x,note:a.prodotto.o,
abb:a.prodotto.a,fin:a.prodotto.f,prices:a.prodotto.z,image:a.prodotto.r,sourceCod:a.prodottoOriginal.prodotto.c,sourceMark:a.prodottoOriginal.prodotto.m,sourceLine:a.prodottoOriginal.prodotto.l}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.prodotti.push(angular.copy({i:a.vm.nuovoProdotto.i,m:a.prodotto.m,l:a.prodotto.l,c:a.prodotto.c,n:a.prodotto.n,t:a.prodotto.t,d:a.prodotto.d,y:a.prodotto.y,x:a.prodotto.x,o:a.prodotto.o,a:a.prodotto.a,f:a.prodotto.f,z:a.prodotto.z}));a.vm.nuovoProdotto=
{i:a.vm.nuovoProdotto.i+1};a.vm.saveProdottoData();c.saving=!1;a.errore.prodotto=!1}).error(function(a,b){console.log(b)})));"D"===d&&(c.saving=!0,e.post("php/prodotti.php?type=delete",{id:a.prodotto.i,mark:a.prodotto.m,line:a.prodotto.l,cod:a.prodotto.c,title:a.prodotto.n,tbpr:a.prodotto.t,dim:a.prodotto.d,pos:a.prodotto.y,lnfn:a.prodotto.x,note:a.prodotto.o,abb:a.prodotto.a,fin:a.prodotto.f,prices:a.prodotto.z,image:a.prodotto.r}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.prodotti=
_.filter(a.vm.prodotti,function(b){return b.i!=a.prodotto.i});a.vm.saveProdottoData();a.newProdotto()}).error(function(a,b){console.log(b)}));"A"===d&&(c.saving=!0,e.post("php/prodotti.php?type=deleteAll",{mark:a.prodotto.m,line:a.prodotto.l}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.prodotti=_.filter(a.vm.prodotti,function(b){return b.i!=a.prodotto.i});a.vm.saveProdottoData();a.newProdotto()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("prodottiSettori",function(){return{restrict:"E",templateUrl:"template/prodottiSettori.html",scope:{prodottoSettoreOriginal:"=",vm:"="},controller:function(a,e,g,c,f){a.$watch("prodottoSettoreOriginal",function(d){a.prodottoSettore=angular.copy(d.prodottoSettore)});a.saveDataDB=function(){c.saving=!0;e.post("php/prodottiSettori.php?type=db").success(function(){c.saving=!1;f.prodottiSettori().then(function(d){a.vm.prodottiSettori=d})}).error(function(a,b){console.log(b)})};
a.errore={prodottoSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("prodottoSettore",function(d){a.prodottiAvailable=[{c:" Tutti",i:-1},{c:a.prodottoSettore.n,i:a.prodottoSettore.c}];d=_.where(a.vm.prodotti,{l:d.l});_.each(d,function(b){_.find(a.vm.prodottiSettori,function(a){return a.c===b.i})||a.prodottiAvailable.push(b)})});a.$watch("prodottoSettore.w",function(d){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:d});_.each(a.settoriAvailable,
function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.$watch("prodottoSettore.c",function(d){if(d&&-1!=d){var b=_.find(a.vm.prodotti,function(a){return a.i==d});a.prodottoSettore.n=b.c}});a.selectedCat=function(d){return-1!=a.prodottoSettore.h.indexOf(d)};a.toggleSet=function(d){-1==a.prodottoSettore.h.indexOf(d)?a.prodottoSettore.h.push(parseInt(d)):a.prodottoSettore.h.splice(a.prodottoSettore.h.indexOf(d),1)};a.updateCheck=function(){return-1==a.prodottoSettore.c};a.enableUpdate=!1;a.$watchCollection("prodottoSettore.h",
function(d){a.prodottoSettore.i==a.prodottoSettoreOriginal.prodottoSettore.i&&d!=a.prodottoSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1===a.prodottoSettore.c||a.prodottoSettore.c===a.prodottoSettoreOriginal.prodottoSettore.c};a.newProdottoSettore=function(){c.saving=!1;a.errore.prodottoSettore=!1;a.prodottoSettoreOriginal.selected=!1;a.vm.nuovoProdottoSettore={i:a.vm.nuovoProdottoSettore.i+1,m:!1,l:!1,c:!1,h:[]}};a.action=function(d){"U"==d&&(0!=a.prodottoSettore.h.length?
(c.saving=!0,e.post("php/prodottiSettori.php?type=update",{id:a.prodottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){_.each(a.vm.prodottiSettori,function(b,d){b.i==a.prodottoSettore.i&&(b.c=a.prodottoSettore.c,b.n=a.prodottoSettore.n,b.m=a.prodottoSettore.m,b.l=a.prodottoSettore.l,b.w=a.prodottoSettore.w,b.h=a.prodottoSettore.h,a.prodottoSettore=angular.copy(b))});c.saving=!1;a.errore.prodottoSettore=
!1;a.vm.saveProdottoSettoreData()}).error(function(a,d){console.log(d)})):a.errore.prodottoSettore=!0);"C"==d&&(0!=a.prodottoSettore.h.length?(c.saving=!0,e.post("php/prodottiSettori.php?type=new",{id:a.vm.nuovoProdottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){a.vm.copiedProdottoSettore={i:a.vm.nuovoProdottoSettore.i,c:a.prodottoSettore.c,n:a.prodottoSettore.n,m:a.prodottoSettore.m,l:a.prodottoSettore.l,
w:a.prodottoSettore.w,h:a.prodottoSettore.h};a.vm.prodottiSettori.push(a.vm.copiedProdottoSettore);a.vm.nuovoProdottoSettore={i:a.vm.nuovoProdottoSettore.i+1};a.vm.saveProdottoSettoreData();c.saving=!1;a.errore.prodottoSettore=!1}).error(function(a,d){console.log(d)})):a.errore.prodottoSettore=!0);"D"==d&&(c.saving=!0,e.post("php/prodottiSettori.php?type=delete",{id:a.prodottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){-1!=
a.prodottoSettore.c?(a.vm.prodottiSettori=_.filter(a.vm.prodottiSettori,function(b){return b.i!=a.prodottoSettore.i}),a.vm.saveProdottoSettoreData()):a.saveDataDB();a.newProdottoSettore()}).error(function(a,d){console.log(d)}))}}}});
angular.module("mpuDashboard").directive("vetrine",function(){return{restrict:"E",templateUrl:"template/vetrine.html",scope:{vetrinaOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function d(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={vetrina:!1};a.generateSettoriInLinea=function(b){if(b){var d=[],c=_.find(a.vm.linee,function(a){return a.i===b}).q;_.each(c,function(b){var c=
_.find(a.vm.settori,function(a){return a.i===b}).n;d.push({i:b,n:c})});return d}};a.selectedCat=function(b){console.log(a.vetrina);return-1!=a.vetrina.s.indexOf(b)};a.toggleSet=function(b){-1==a.vetrina.s.indexOf(b)?a.vetrina.s.push(parseInt(b)):a.vetrina.s.splice(a.vetrina.s.indexOf(b),1)};a.$watch("vetrinaOriginal",function(b){a.vetrina=angular.copy(b.vetrina);b=f(a.vetrina.m);var c=d(a.vetrina.l);b=b.replace(/ /g,"_");c=c.replace(/ /g,"_");a.vetrina.r="../dashboard/archivio_dati/"+b+"/"+c+"/Vetrina/"+
(c+"_"+a.vetrina.c+".jpg")});a.settoriInLinea=!1;a.$watch("vetrina.l",function(b){a.settoriInLinea=a.generateSettoriInLinea(b)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.vetrina.c||!a.vetrina.n||!a.vetrina.m||!a.vetrina.l||!a.vetrina.r||!a.vetrina.s||isNaN(a.vetrina.y)};a.deleteCheck=function(){return a.vetrina.c!==a.vetrinaOriginal.vetrina.c||a.vetrina.m!==a.vetrinaOriginal.vetrina.m||a.vetrina.l!==a.vetrinaOriginal.vetrina.l};
a.copyCheck=function(){return!a.vetrina.c||!a.vetrina.m||!a.vetrina.l||a.vetrina.c===a.vetrinaOriginal.vetrina.c&&a.vetrina.l===a.vetrinaOriginal.vetrina.l};a.newVetrina=function(){c.saving=!1;a.errore.vetrina=!1;a.vetrinaOriginal.selected=!1;a.vm.nuovaVetrina={i:a.vm.nuovaVetrina.i+1,m:!1,l:!1,s:!1,y:1,v:1}};a.action=function(b){if("U"==b){var d=a.vetrina.c!=a.vetrinaOriginal.vetrina.c||a.vetrina.l!=a.vetrinaOriginal.vetrina.l?_.findWhere(a.vm.vetrine,{c:a.vetrina.c,l:a.vetrina.l}):!1;d?a.errore.vetrina=
!0:(c.saving=!0,e.post("php/vetrine.php?type=update",{id:a.vetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r,sourceCod:a.vetrinaOriginal.vetrina.c,sourceMark:a.vetrinaOriginal.vetrina.m,sourceLine:a.vetrinaOriginal.vetrina.l}).success(function(b){a.errore.vetrina=!1;a.vm.saveVetrinaData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.vetrine,function(b){b.i==a.vetrina.i&&(b.m=
a.vetrina.m,b.l=a.vetrina.l,b.c=a.vetrina.c,b.n=a.vetrina.n,b.s=a.vetrina.s,b.v=a.vetrina.v,b.y=a.vetrina.y,b.o=a.vetrina.o,b.r=a.vetrina.r,a.vetrina=angular.copy(b))});c.saving=!1;a.errore.vetrina=!1}).error(function(a,b){console.log(b)}))}"C"==b&&(_.findWhere(a.vm.vetrine,{c:a.vetrina.c,m:a.vetrina.m,l:a.vetrina.l})?a.errore.vetrina=!0:(c.saving=!0,e.post("php/vetrine.php?type=new",{id:a.vm.nuovaVetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,
note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r,sourceCod:a.vetrinaOriginal.vetrina.c,sourceMark:a.vetrinaOriginal.vetrina.m,sourceLine:a.vetrinaOriginal.vetrina.l}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedVetrina={i:a.vm.nuovoProdotto.i,m:a.vetrina.m,l:a.vetrina.l,c:a.vetrina.c,n:a.vetrina.n,s:a.vetrina.s,v:a.vetrina.v,y:a.vetrina.y,o:a.vetrina.o};a.vm.vetrine.push(a.vm.copiedVetrina);a.vm.nuovaVetrina={i:a.vm.nuovaVetrina.i+1};a.vm.saveVetrinaData();c.saving=
!1;a.errore.vetrina=!1}).error(function(a,b){console.log(b)})));"D"==b&&(c.saving=!0,e.post("php/vetrine.php?type=delete",{id:a.vetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r}).success(function(b){a.vm.vetrine=_.filter(a.vm.vetrine,function(b){return b.i!=a.vetrina.i});a.vm.saveVetrinaData();a.newVetrina()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("vetrineProdotti",function(){return{restrict:"E",templateUrl:"template/vetrineProdotti.html",scope:{vetrinaProdottoOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("vetrinaProdottoOriginal",function(c){a.vetrinaProdotto=angular.copy(c.vetrinaProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("vetrinaProdotto.p",function(c,d){c!=d&&a.vetrinaProdottoOriginal.i==a.vetrinaProdotto&&(a.vetrinaProdotto.u=
!1);if(c){c=_.findWhere(a.vm.prodotti,{i:c});c=_.pluck(c.z,"a");a.tabsAvailable=[];for(d=0;d<c.length;d++){var b=_.findWhere(a.vm.finitureTabelle,{i:c[d]});a.tabsAvailable.push({i:c[d],n:b.n})}return a.tabsAvailable}});a.$watch("vetrinaProdotto.u",function(c,d){c!=d&&a.vetrinaProdottoOriginal.i==a.vetrinaProdotto&&(a.vetrinaProdotto.f=!1);if(c)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:c}),a.finsAvailable});a.newVetrinaProdotto=function(){c.saving=!1;a.vetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i+
1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.vetrinaProdotto.c||!a.vetrinaProdotto.p||!a.vetrinaProdotto.l||!a.vetrinaProdotto.j||!a.vetrinaProdotto.u||!a.vetrinaProdotto.f||isNaN(a.vetrinaProdotto.y)||isNaN(a.vetrinaProdotto.q)};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/vetrineProdotti.php?type=update",{id:a.vetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,
cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(d){a.vm.saveVetrineProdottiData();console.log("Risposta dalla pagina PHP",d);_.each(a.vm.vetrineProdotti,function(b){b.i==a.vetrinaProdotto.i&&(b.c=a.vetrinaProdotto.c,b.p=a.vetrinaProdotto.p,b.l=a.vetrinaProdotto.l,b.j=a.vetrinaProdotto.j,b.m=a.vetrinaProdotto.m,b.k=a.vetrinaProdotto.k,b.f=a.vetrinaProdotto.f,b.u=a.vetrinaProdotto.u,b.y=a.vetrinaProdotto.y,
b.q=a.vetrinaProdotto.q,a.vetrinaProdotto=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==f&&(c.saving=!0,e.post("php/vetrineProdotti.php?type=new",{id:a.vm.nuovoVetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(d){console.log("Risposta dalla pagina PHP",
d);a.vm.copiedVetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i,c:a.vetrinaProdotto.c,p:a.vetrinaProdotto.p,l:a.vetrinaProdotto.l,j:a.vetrinaProdotto.j,m:a.vetrinaProdotto.m,k:a.vetrinaProdotto.k,f:a.vetrinaProdotto.f,u:a.vetrinaProdotto.u,y:a.vetrinaProdotto.y,q:a.vetrinaProdotto.q};a.vm.vetrineProdotti.push(a.vm.copiedVetrinaProdotto);a.vm.nuovoVetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i+1};a.vm.saveVetrineProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/vetrineProdotti.php?type=delete",
{id:a.vetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(d){a.vm.vetrineProdotti=_.filter(a.vm.vetrineProdotti,function(b){return b.i!=a.vetrinaProdotto.i});a.vm.saveVetrineProdottiData();a.newVetrinaProdotto()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("nazioni",function(){return{restrict:"E",templateUrl:"template/nazioni.html",scope:{cat:"=",vm:"="},controller:function(a,e,g,c){a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.cat.n||!a.cat.x};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/nazioni.php?type=update",{id:a.cat.i,nome:a.cat.n,show:a.cat.v,prx:a.cat.x}).success(function(d){a.vm.saveNazioniData();c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/nazioni.php?type=delete",{id:a.cat.i,nome:a.cat.n,show:a.cat.v,prx:a.cat.x}).success(function(d){a.vm.nazioni=_.filter(a.vm.nazioni,function(b){return b.i!=a.cat.i});a.vm.saveNazioniData();c.saving=!1}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("regioni",function(){return{restrict:"E",templateUrl:"template/regioni.html",scope:{regioneOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("regioneOriginal",function(c){a.regione=angular.copy(c.regione)});a.errore={regione:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.regione.n||!a.regione.z};a.newItem=function(){a.regioneOriginal.selected=!1;a.errore.regione=!1;c.saving=
!1;a.vm.nuovaRegione={i:a.vm.nuovaRegione.i+1,z:!1}};a.action=function(f){"U"==f&&(_.findWhere(a.vm.regioni,{n:a.regione.n,z:a.regione.z})?a.errore.regione=!0:(c.saving=!0,e.post("php/regioni.php?type=update",{id:a.regione.i,nome:a.regione.n,nazione:a.regione.z}).success(function(d){a.vm.saveRegioniData();_.each(a.vm.regioni,function(b){b.i==a.regione.i&&(b.n=a.regione.n,b.z=a.regione.z,a.regione=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)})));"D"==f&&(c.saving=!0,e.post("php/regioni.php?type=delete",
{id:a.regione.i,nome:a.regione.n,nazioni:a.regione.z}).success(function(d){a.vm.regioni=_.filter(a.vm.regioni,function(b){return b.i!=a.regione.i});a.vm.saveRegioniData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("province",function(){return{restrict:"E",templateUrl:"template/province.html",scope:{provinciaOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("provinciaOriginal",function(c){a.provincia=angular.copy(c.provincia)});a.errore={provincia:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.copyCheck=function(){return!a.provincia.n||!a.provincia.c||!a.provincia.r||!a.provincia.z||a.provincia.n===a.provinciaOriginal.provincia.n};
a.newItem=function(){c.saving=!1;a.provinciaOriginal.selected=!1;a.errore.provincia=!1;a.vm.nuovaProvincia={i:a.vm.nuovaProvincia.i+1,z:!1,r:!1,b:0,l:0,t:0,j:1,m:0,k:1}};a.action=function(f){"U"==f&&(a.provincia.n&&a.provincia.z?(c.saving=!0,e.post("php/province.php?type=update",{id:a.provincia.i,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,limite:a.provincia.l,
minimo:a.provincia.b}).success(function(d){a.vm.saveProvinceData();_.each(a.vm.province,function(b){b.i==a.provincia.i&&(b.n=a.provincia.n,b.c=a.provincia.c,b.z=a.provincia.z,b.r=a.provincia.r,b.t=a.provincia.t,b.j=a.provincia.j,b.m=a.provincia.m,b.k=a.provincia.k,b.l=a.provincia.l,b.b=a.provincia.b,a.provincia=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)})):a.errore.provincia=!0);"C"==f&&(_.findWhere(a.vm.province,{n:a.provincia.n,c:a.provincia.c,z:a.provincia.z,r:a.provincia.r})?
a.errore.provincia=!0:(c.saving=!0,e.post("php/province.php?type=new",{id:a.vm.nuovaProvincia.i+1,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,limite:a.provincia.l,minimo:a.provincia.b}).success(function(d){a.vm.copiedProvincia={i:a.vm.nuovaProvincia.i,n:a.provincia.n,c:a.provincia.c,z:a.provincia.z,r:a.provincia.r,t:a.provincia.t,j:a.provincia.j,m:a.provincia.m,
k:a.provincia.k,l:a.provincia.l,b:a.provincia.b};a.vm.province.push(a.vm.copiedProvincia);a.vm.nuovaProvincia={i:a.vm.nuovaProvincia.i+1};a.vm.saveProvinceData();c.saving=!1;a.errore.provincia=!1}).error(function(a,b){console.log(b)})));"D"==f&&(c.saving=!0,e.post("php/province.php?type=delete",{id:a.provincia.i,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,
limite:a.provincia.l,minimo:a.provincia.b}).success(function(d){a.vm.province=_.filter(a.vm.province,function(b){return b.i!=a.provincia.i});a.vm.saveProvinceData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("convenzioni",function(){return{restrict:"E",templateUrl:"template/convenzioni.html",scope:{cat:"=",vm:"="},controller:function(a,e,g,c){a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.cat.n};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/convenzioni.php?type=update",{id:a.cat.i,nome:a.cat.n,email:a.cat.e}).success(function(d){a.vm.saveConvenzioniData();c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/convenzioni.php?type=delete",{id:a.cat.i,nome:a.cat.n,email:a.cat.e}).success(function(d){a.vm.convenzioni=_.filter(a.vm.convenzioni,function(b){return b.i!=a.cat.i});a.vm.saveConvenzioniData();c.saving=!1}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("agenti",function(){return{restrict:"E",templateUrl:"template/agenti.html",scope:{agenteOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("agenteOriginal",function(c){a.agente=angular.copy(c.agente)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.agente.n||!a.agente.e||!a.agente.p||!a.agente.r||!a.agente.t};a.newItem=function(){c.saving=!1;a.agenteOriginal.selected=!1;a.vm.nuovoAgente=
{i:a.vm.nuovoAgente.i+1,r:!1}};a.convert=function(c,d,b){var f=[],e="";if("object"===typeof c){for(var g=0;g<c.length;g++)_.each(a.vm[d],function(a){a.i==c[g]&&f.push(a[b])});return f}_.each(a.vm[d],function(a){a.i==c&&(e=a[b])});return e};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/agenti.php?type=update",{id:a.agente.i,nome:a.agente.n,email:a.agente.e,password:a.agente.p,tel:a.agente.t,riv:a.agente.r}).success(function(d){a.vm.saveAgentiData();_.each(a.vm.agenti,function(b){b.i==a.agente.i&&
(b.n=a.agente.n,b.e=a.agente.e,b.p=a.agente.p,b.t=a.agente.t,b.r=a.agente.r,a.agente=angular.copy(b))});console.log("Risposta dalla pagina PHP",d);c.saving=!1}).error(function(a,b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/agenti.php?type=delete",{id:a.agente.i,nome:a.agente.n,email:a.agente.e,password:a.agente.p,tel:a.agente.t,riv:a.agente.r}).success(function(d){a.vm.agenti=_.filter(a.vm.agenti,function(b){return b.i!=a.agente.i});a.vm.saveAgentiData();a.newItem();c.saving=!1}).error(function(a,
b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("rivenditori",function(){return{restrict:"E",templateUrl:"template/rivenditori.html",scope:{rivenditoreOriginal:"=",vm:"="},controller:function(a,e,g,c){a.errore={rivenditore:!1};a.convert=function(d,b,c){var f=[],e="";if("object"===typeof d){for(var h=0;h<d.length;h++)_.each(a.vm[b],function(a){a.i==d[h]&&f.push(a[c])});return f}_.each(a.vm[b],function(a){a.i==d&&(e=a[c])});return e};a.$watch("rivenditoreOriginal",function(d){a.rivenditore=angular.copy(d.rivenditore);
a.rivenditore.g="../dashboard/archivio_dati/Rivenditori/"+(a.rivenditore.i+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return(!a.rivenditore.z||!a.rivenditore.r||!a.rivenditore.p)&&!a.rivenditore.v||!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||!a.rivenditore.h&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||!a.rivenditore.g};a.copyCheck=function(){return a.rivenditore.v?!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||
!a.rivenditore.t&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||a.rivenditore.n===a.rivenditoreOriginal.rivenditore.n:!a.rivenditore.z||!a.rivenditore.r||!a.rivenditore.p||!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||!a.rivenditore.t&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||a.rivenditore.p===a.rivenditoreOriginal.rivenditore.p};a.openMarchi=function(){a.vm.mv=!a.vm.mv};var f=function(){a.vm.mv=!1;a.vm.nuovoRivenditore.y=angular.copy(a.vm.marchi);_.each(a.vm.nuovoRivenditore.y,
function(a){a.s=0;delete a.n;delete a.b;delete a.g});return a.vm.nuovoRivenditore.y};f();a.newItem=function(){c.saving=!1;a.errore.rivenditore=!1;a.rivenditoreOriginal.selected=!1;a.vm.nuovoRivenditore={i:a.vm.nuovoRivenditore.i+1,z:!1,r:!1,p:!1,b:0,l:0,t:0,j:1,m:0,k:1,v:!1,c:"",h:"",f:"",a:""};f()};a.action=function(d){if("U"==d){var b=a.rivenditore.p&&a.rivenditore.p!=a.rivenditoreOriginal.rivenditore.p?_.findWhere(a.vm.rivenditori,{p:a.rivenditore.p}):!1;b?a.errore.rivenditore=!0:(c.saving=!0,
e.post("php/rivenditori.php?type=update",{id:a.rivenditore.i,nome:a.rivenditore.n,naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.x,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,
coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g}).success(function(b){a.errore.rivenditore=!1;a.vm.saveRivenditoreData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.rivenditori,function(b){b.i==a.rivenditore.i&&(b.n=a.rivenditore.n,b.z=a.rivenditore.z,b.r=a.rivenditore.r,b.p=a.rivenditore.p,b.v=a.rivenditore.v,b.r=a.rivenditore.r,b.s=a.rivenditore.s,b.h=a.rivenditore.h,b.f=a.rivenditore.f,b.c=a.rivenditore.c,b.q=a.rivenditore.q,b.e=a.rivenditore.e,b.w=a.rivenditore.w,
b.l=a.rivenditore.l,b.b=a.rivenditore.b,b.t=a.rivenditore.t,b.j=a.rivenditore.j,b.m=a.rivenditore.m,b.k=a.rivenditore.k,b.y=a.rivenditore.y,b.o=a.rivenditore.o,b.a=a.rivenditore.a,b.g=a.rivenditore.g,a.rivenditore=angular.copy(b))});c.saving=!1;a.errore.rivenditore=!1}).error(function(a,b){console.log(b)}))}"C"==d&&(b=a.rivenditore.p?_.findWhere(a.vm.rivenditori,{p:a.rivenditore.p}):void 0,b?a.errore.rivenditore=!0:(c.saving=!0,e.post("php/rivenditori.php?type=new",{id:a.vm.nuovoRivenditore.i+1,nome:a.rivenditore.n,
naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.x,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g,sourceID:a.rivenditoreOriginal.rivenditore.i}).success(function(b){a.vm.copiedRivenditore=
{i:a.vm.nuovoRivenditore.i+1,n:a.rivenditore.n,z:a.rivenditore.z,r:a.rivenditore.r,p:a.rivenditore.p,v:a.rivenditore.v,x:a.rivenditore.x,s:a.rivenditore.s,h:a.rivenditore.h,f:a.rivenditore.f,c:a.rivenditore.c,q:a.rivenditore.q,e:a.rivenditore.e,w:a.rivenditore.w,l:a.rivenditore.l,b:a.rivenditore.b,t:a.rivenditore.t,j:a.rivenditore.j,m:a.rivenditore.m,k:a.rivenditore.k,y:a.rivenditore.y,o:a.rivenditore.o,a:a.rivenditore.a};a.vm.rivenditori.push(a.vm.copiedRivenditore);a.vm.nuovoRivenditore={i:a.vm.nuovoRivenditore.i+
1};a.vm.saveRivenditoreData();c.saving=!1;a.errore.rivenditore=!1}).error(function(a,b){console.log(b)})));"D"==d&&(c.saving=!0,e.post("php/rivenditori.php?type=delete",{id:a.rivenditore.i,nome:a.rivenditore.n,naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.r,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,
trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g}).success(function(b){a.vm.rivenditori=_.filter(a.vm.rivenditori,function(b){return b.i!=a.rivenditore.i});a.vm.saveRivenditoreData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioni",function(){return{restrict:"E",templateUrl:"template/esposizioni.html",scope:{esposizioneOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function d(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={esposizione:!1};a.$watch("esposizioneOriginal",function(b){a.esposizione=angular.copy(b.esposizione);b=f(a.esposizione.m);
var c=d(a.esposizione.l);b=b.replace(/ /g,"_");c=c.replace(/ /g,"_");var e=a.esposizione.f.replace(/ /g,"_");a.esposizione.r="../dashboard/archivio_dati/"+b+"/"+c+"/Render/"+(c+"_"+a.esposizione.c+"_"+e+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.esposizione.c||!a.esposizione.f||!a.esposizione.m||!a.esposizione.l||!a.esposizione.t||!a.esposizione.r||isNaN(a.esposizione.y)};a.deleteCheck=function(){return a.esposizione.c!==
a.esposizioneOriginal.esposizione.c||a.esposizione.m!==a.esposizioneOriginal.esposizione.m||a.esposizione.l!==a.esposizioneOriginal.esposizione.l||a.esposizione.f!==a.esposizioneOriginal.esposizione.f};a.copyCheck=function(){return!a.esposizione.c||!a.esposizione.m||!a.esposizione.l||!a.esposizione.f||a.esposizione.c===a.esposizioneOriginal.esposizione.c&&a.esposizione.l===a.esposizioneOriginal.esposizione.l&&a.esposizione.f===a.esposizioneOriginal.esposizione.f};a.newItem=function(){c.saving=!1;
a.errore.esposizione=!1;a.esposizioneOriginal.selected=!1;a.vm.nuovoComposto={i:a.vm.nuovaEsposizione.i+1,m:!1,l:!1,t:!1,y:1}};a.action=function(b){if("U"==b){var d=a.esposizione.c!=a.esposizioneOriginal.esposizione.c||a.esposizione.l!=a.esposizioneOriginal.esposizione.l||a.esposizione.f!=a.esposizioneOriginal.esposizione.f?_.findWhere(a.vm.esposizioni,{c:a.esposizione.c,l:a.esposizione.l,f:a.esposizione.f}):!1;d?a.errore.esposizione=!0:(c.saving=!0,e.post("php/esposizioni.php?type=update",{id:a.esposizione.i,
mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r,sourceCod:a.esposizioneOriginal.esposizione.c,sourceMark:a.esposizioneOriginal.esposizione.m,sourceLine:a.esposizioneOriginal.esposizione.l,sourceFin:a.esposizioneOriginal.esposizione.f}).success(function(b){a.errore.esposizione=!1;a.vm.saveEsposizioneData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.esposizioni,
function(b){b.i==a.esposizione.i&&(b.m=a.esposizione.m,b.l=a.esposizione.l,b.t=a.esposizione.t,b.c=a.esposizione.c,b.f=a.esposizione.f,b.d=a.esposizione.d,b.y=a.esposizione.y,b.n=a.esposizione.n,b.r=a.esposizione.r,a.esposizione=angular.copy(b))});c.saving=!1;a.errore.esposizione=!1}).error(function(a,b){console.log(b)}))}"C"==b&&(_.findWhere(a.vm.esposizioni,{c:a.esposizione.c,m:a.esposizione.m,l:a.esposizione.l,f:a.esposizione.f})?a.errore.esposizione=!0:(c.saving=!0,e.post("php/esposizioni.php?type=new",
{id:a.vm.nuovaEsposizione.i,mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r,sourceCod:a.esposizioneOriginal.esposizione.c,sourceMark:a.esposizioneOriginal.esposizione.m,sourceLine:a.esposizioneOriginal.esposizione.l,sourceFin:a.esposizioneOriginal.esposizione.f}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedEsposizione={i:a.vm.nuovaEsposizione.i,
m:a.esposizione.m,l:a.esposizione.l,t:a.esposizione.t,c:a.esposizione.c,f:a.esposizione.f,d:a.esposizione.d,y:a.esposizione.y,n:a.esposizione.n};a.vm.esposizioni.push(a.vm.copiedEsposizione);a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1};a.vm.saveEsposizioneData();c.saving=!1;a.errore.esposizione=!1}).error(function(a,b){console.log(b)})));"D"==b&&(c.saving=!0,e.post("php/esposizioni.php?type=delete",{id:a.esposizione.i,mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,
fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.esposizioni=_.filter(a.vm.esposizioni,function(b){return b.i!=a.esposizione.i});a.vm.saveEsposizioneData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("composti",function(){return{restrict:"E",templateUrl:"template/composti.html",scope:{compostoOriginal:"=",vm:"="},controller:function(a,e,g,c){function f(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function d(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={composto:!1};a.$watch("compostoOriginal",function(b){a.composto=angular.copy(b.composto);b=f(a.composto.m);var c=d(a.composto.l);
b=b.replace(/ /g,"_");c=c.replace(/ /g,"_");var e=a.composto.f.replace(/ /g,"_");a.composto.r="../dashboard/archivio_dati/"+b+"/"+c+"/Render/"+(c+"_"+a.composto.c+"C_"+e+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.composto.c||!a.composto.f||!a.composto.m||!a.composto.l||!a.composto.n||!a.composto.r||isNaN(a.composto.y)};a.deleteCheck=function(){return a.composto.c!==a.compostoOriginal.composto.c||a.composto.m!==a.compostoOriginal.composto.m||
a.composto.l!==a.compostoOriginal.composto.l||a.composto.f!==a.compostoOriginal.composto.f};a.copyCheck=function(){return!a.composto.c||!a.composto.m||!a.composto.l||!a.composto.f||a.composto.c===a.compostoOriginal.composto.c&&a.composto.l===a.compostoOriginal.composto.l&&a.composto.f===a.compostoOriginal.composto.f};a.newItem=function(){c.saving=!1;a.errore.composto=!1;a.compostoOriginal.selected=!1;a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1,m:!1,l:!1,y:1}};a.action=function(b){if("U"==b){var d=
a.composto.c!=a.compostoOriginal.composto.c||a.composto.l!=a.compostoOriginal.composto.l||a.composto.f!=a.compostoOriginal.composto.f?_.findWhere(a.vm.composti,{c:a.composto.c,l:a.composto.l,f:a.composto.f}):!1;d?a.errore.composto=!0:(c.saving=!0,e.post("php/composti.php?type=update",{id:a.composto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,image:a.composto.r,sourceCod:a.compostoOriginal.composto.c,sourceMark:a.compostoOriginal.composto.m,
sourceLine:a.compostoOriginal.composto.l,sourceFin:a.compostoOriginal.composto.f}).success(function(b){a.errore.composto=!1;a.vm.saveCompostoData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.composti,function(b){b.i==a.composto.i&&(b.m=a.composto.m,b.l=a.composto.l,b.c=a.composto.c,b.f=a.composto.f,b.y=a.composto.y,b.n=a.composto.n,b.r=a.composto.r,a.composto=angular.copy(b))});c.saving=!1;a.errore.composto=!1}).error(function(a,b){console.log(b)}))}"C"==b&&(_.findWhere(a.vm.composti,
{c:a.composto.c,m:a.composto.m,l:a.composto.l,f:a.composto.f})?a.errore.composto=!0:(c.saving=!0,e.post("php/composti.php?type=new",{id:a.vm.nuovoComposto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,image:a.composto.r,sourceCod:a.compostoOriginal.composto.c,sourceMark:a.compostoOriginal.composto.m,sourceLine:a.compostoOriginal.composto.l,sourceFin:a.compostoOriginal.composto.f}).success(function(b){console.log("Risposta dalla pagina PHP",
b);a.vm.copiedComposto={i:a.vm.nuovoComposto.i,m:a.composto.m,l:a.composto.l,c:a.composto.c,f:a.composto.f,y:a.composto.y,n:a.composto.n};a.vm.composti.push(a.vm.copiedComposto);a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1};a.vm.saveCompostoData();c.saving=!1;a.errore.composto=!1}).error(function(a,b){console.log(b)})));"D"==b&&(c.saving=!0,e.post("php/composti.php?type=delete",{id:a.composto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,
image:a.composto.r}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.composti=_.filter(a.vm.composti,function(b){return b.i!=a.composto.i});a.vm.saveCompostoData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioniProdotti",function(){return{restrict:"E",templateUrl:"template/esposizioniProdotti.html",scope:{esposizioneProdottoOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("esposizioneProdottoOriginal",function(c){a.esposizioneProdotto=angular.copy(c.esposizioneProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("esposizioneProdotto.p",function(c,d){c!=d&&a.esposizioneProdottoOriginal.i==a.esposizioneProdotto&&
(a.esposizioneProdotto.u=!1);if(c){c=_.findWhere(a.vm.prodotti,{i:c});c=_.pluck(c.z,"a");a.tabsAvailable=[];for(d=0;d<c.length;d++){var b=_.findWhere(a.vm.finitureTabelle,{i:c[d]});a.tabsAvailable.push({i:c[d],n:b.n})}return a.tabsAvailable}});a.$watch("esposizioneProdotto.u",function(c,d){c!=d&&a.esposizioneProdottoOriginal.i==a.esposizioneProdotto&&(a.esposizioneProdotto.f=!1);if(c)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:c}),a.finsAvailable});a.newItem=function(){c.saving=!1;a.esposizioneProdotto=
{i:a.vm.nuovoEsposizioneProdotto.i+1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.esposizioneProdotto.c||!a.esposizioneProdotto.p||!a.esposizioneProdotto.l||!a.esposizioneProdotto.j||!a.esposizioneProdotto.u||!a.esposizioneProdotto.f||isNaN(a.esposizioneProdotto.y)||isNaN(a.esposizioneProdotto.q)};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/esposizioniProdotti.php?type=update",{id:a.esposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,
pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,fin:a.esposizioneProdotto.f,tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(d){a.vm.saveEsposizioniProdottiData();_.each(a.vm.esposizioniProdotti,function(b){b.i==a.esposizioneProdotto.i&&(b.c=a.esposizioneProdotto.c,b.p=a.esposizioneProdotto.p,b.l=a.esposizioneProdotto.l,b.j=a.esposizioneProdotto.j,b.m=a.esposizioneProdotto.m,
b.k=a.esposizioneProdotto.k,b.f=a.esposizioneProdotto.f,b.u=a.esposizioneProdotto.u,b.y=a.esposizioneProdotto.y,b.q=a.esposizioneProdotto.q,a.esposizioneProdotto=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==f&&(c.saving=!0,e.post("php/esposizioniProdotti.php?type=new",{id:a.vm.nuovoEsposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,
fin:a.esposizioneProdotto.f,tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(d){console.log("Risposta dalla pagina PHP",d);a.vm.copiedEsposizioneProdotto={i:a.vm.nuovoEsposizioneProdotto.i,c:a.esposizioneProdotto.c,p:a.esposizioneProdotto.p,l:a.esposizioneProdotto.l,j:a.esposizioneProdotto.j,m:a.esposizioneProdotto.m,k:a.esposizioneProdotto.k,f:a.esposizioneProdotto.f,u:a.esposizioneProdotto.u,y:a.esposizioneProdotto.y,q:a.esposizioneProdotto.q};
a.vm.esposizioniProdotti.push(a.vm.copiedEsposizioneProdotto);a.vm.nuovoEsposizioneProdotto={i:a.vm.nuovoEsposizioneProdotto.i+1};a.vm.saveEsposizioniProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/esposizioniProdotti.php?type=delete",{id:a.esposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,fin:a.esposizioneProdotto.f,
tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(c){a.vm.esposizioniProdotti=_.filter(a.vm.esposizioniProdotti,function(b){return b.i!=a.esposizioneProdotto.i});a.vm.saveEsposizioniProdottiData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("compostiProdotti",function(){return{restrict:"E",templateUrl:"template/compostiProdotti.html",scope:{compostoProdottoOriginal:"=",vm:"="},controller:function(a,e,g,c){a.$watch("compostoProdottoOriginal",function(c){a.compostoProdotto=angular.copy(c.compostoProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("compostoProdotto.p",function(c,d){c!=d&&a.compostoProdottoOriginal.i==a.compostoProdotto&&(a.compostoProdotto.u=
!1);if(c){c=_.findWhere(a.vm.prodotti,{i:c});c=_.pluck(c.z,"a");a.tabsAvailable=[];for(d=0;d<c.length;d++){var b=_.findWhere(a.vm.finitureTabelle,{i:c[d]});a.tabsAvailable.push({i:c[d],n:b.n})}return a.tabsAvailable}});a.$watch("compostoProdotto.u",function(c,d){c!=d&&a.compostoProdottoOriginal.i==a.compostoProdotto&&(a.compostoProdotto.f=!1);if(c)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:c}),a.finsAvailable});a.newItem=function(){c.saving=!1;a.compostoProdotto={i:a.vm.nuovoCompostoProdotto.i+
1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.compostoProdotto.c||!a.compostoProdotto.p||!a.compostoProdotto.l||!a.compostoProdotto.j||!a.compostoProdotto.u||!a.compostoProdotto.f||isNaN(a.compostoProdotto.y)||isNaN(a.compostoProdotto.q)};a.action=function(f){"U"==f&&(c.saving=!0,e.post("php/compostiProdotti.php?type=update",{id:a.compostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,
cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(d){a.vm.saveCompostoProdottiData();_.each(a.vm.compostiProdotti,function(b){b.i==a.compostoProdotto.i&&(b.c=a.compostoProdotto.c,b.p=a.compostoProdotto.p,b.l=a.compostoProdotto.l,b.j=a.compostoProdotto.j,b.m=a.compostoProdotto.m,b.k=a.compostoProdotto.k,b.f=a.compostoProdotto.f,b.u=a.compostoProdotto.u,b.y=a.compostoProdotto.y,b.q=a.compostoProdotto.q,a.compostoProdotto=
angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==f&&(c.saving=!0,e.post("php/compostiProdotti.php?type=new",{id:a.vm.nuovoCompostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(d){console.log("Risposta dalla pagina PHP",d);a.vm.copiedCompostoProdotto=
{i:a.vm.nuovoCompostoProdotto.i,c:a.compostoProdotto.c,p:a.compostoProdotto.p,l:a.compostoProdotto.l,j:a.compostoProdotto.j,m:a.compostoProdotto.m,k:a.compostoProdotto.k,f:a.compostoProdotto.f,u:a.compostoProdotto.u,y:a.compostoProdotto.y,q:a.compostoProdotto.q};a.vm.compostiProdotti.push(a.vm.copiedCompostoProdotto);a.vm.nuovoCompostoProdotto={i:a.vm.nuovoCompostoProdotto.i+1};a.vm.saveCompostoProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==f&&(c.saving=!0,e.post("php/compostiProdotti.php?type=delete",
{id:a.compostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(c){a.vm.compostiProdotti=_.filter(a.vm.compostiProdotti,function(b){return b.i!=a.compostoProdotto.i});a.vm.saveCompostoProdottiData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioniSettori",function(){return{restrict:"E",templateUrl:"template/esposizioniSettori.html",scope:{esposizioneSettoreOriginal:"=",vm:"="},controller:function(a,e,g,c,f){a.$watch("esposizioneSettoreOriginal",function(c){a.esposizioneSettore=angular.copy(c.esposizioneSettore)});a.saveDataDB=function(){c.saving=!0;e.post("php/esposizioniSettori.php?type=db").success(function(){c.saving=!1;f.esposizioniSettori().then(function(c){a.vm.esposizioniSettori=
c})}).error(function(a,b){console.log(b)})};a.errore={esposizioneSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.convert=function(c,b,e){var d="";_.each(a.vm[b],function(a){a.i==c&&(d=a[e])});return d};a.$watch("esposizioneSettore",function(c){a.esposizioniAvailable=[{c:" Tutti",i:-1},{c:a.convert(a.esposizioneSettore.c,"esposizioni","c")+"_"+a.convert(a.esposizioneSettore.c,"esposizioni","f"),i:a.esposizioneSettore.c}];var b=_.where(a.vm.esposizioni,
{l:a.esposizioneSettore.l});_.each(b,function(b){_.find(a.vm.esposizioniSettori,function(a){return a.c===b.i&&c.l===b.l})||a.esposizioniAvailable.push(b)})});a.$watch("esposizioneSettore.w",function(c){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:c});_.each(a.settoriAvailable,function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.selectedCat=function(c){return-1!=a.esposizioneSettore.h.indexOf(c)};a.toggleSet=function(c){-1==a.esposizioneSettore.h.indexOf(c)?a.esposizioneSettore.h.push(parseInt(c)):
a.esposizioneSettore.h.splice(a.esposizioneSettore.h.indexOf(c),1)};a.updateCheck=function(){return-1==a.esposizioneSettore.c};a.enableUpdate=!1;a.$watchCollection("esposizioneSettore.h",function(c){a.esposizioneSettore.i==a.esposizioneSettoreOriginal.esposizioneSettore.i&&c!=a.esposizioneSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1==a.esposizioneSettore.c||a.esposizioneSettore.c===a.esposizioneSettoreOriginal.esposizioneSettore.c};a.newItem=function(){c.saving=!1;a.errore.esposizioneSettore=
!1;a.esposizioneSettoreOriginal.selected=!1;a.vm.nuovoEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i+1,m:!1,l:!1,c:!1,v:0,h:[]}};a.action=function(d){"U"==d&&(0!=a.esposizioneSettore.h.length?(c.saving=!0,e.post("php/esposizioniSettori.php?type=update",{id:a.esposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,array:a.esposizioneSettore.h,view:a.esposizioneSettore.v}).success(function(b){_.each(a.vm.esposizioniSettori,
function(b,c){b.i==a.esposizioneSettore.i&&(b.c=a.esposizioneSettore.c,b.n=a.esposizioneSettore.n,b.m=a.esposizioneSettore.m,b.l=a.esposizioneSettore.l,b.w=a.esposizioneSettore.w,b.h=a.esposizioneSettore.h,b.v=a.esposizioneSettore.v,a.esposizioneSettore=angular.copy(b))});c.saving=!1;a.errore.esposizioneSettore=!1;a.vm.saveEsposizioneSettoreData()}).error(function(a,c){console.log(c)})):a.errore.esposizioneSettore=!0);"C"==d&&(0!=a.esposizioneSettore.h.length?(c.saving=!0,e.post("php/esposizioniSettori.php?type=new",
{id:a.vm.nuovoEsposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,view:a.esposizioneSettore.v,array:a.esposizioneSettore.h}).success(function(b){a.vm.copiedEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i,c:a.esposizioneSettore.c,n:a.esposizioneSettore.n,m:a.esposizioneSettore.m,l:a.esposizioneSettore.l,w:a.esposizioneSettore.w,v:a.esposizioneSettore.v,h:a.esposizioneSettore.h};a.vm.esposizioniSettori.push(a.vm.copiedEsposizioneSettore);
a.vm.nuovoEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i+1};a.vm.saveEsposizioneSettoreData();c.saving=!1;a.errore.esposizioneSettore=!1}).error(function(a,c){console.log(c)})):a.errore.esposizioneSettore=!0);"D"==d&&(c.saving=!0,e.post("php/esposizioniSettori.php?type=delete",{id:a.esposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,view:a.esposizioneSettore.v,array:a.esposizioneSettore.h}).success(function(b){-1!=
a.esposizioneSettore.c?(a.vm.esposizioniSettori=_.filter(a.vm.esposizioniSettori,function(b){return b.i!=a.esposizioneSettore.i}),a.vm.saveEsposizioneSettoreData()):a.saveDataDB();a.newItem()}).error(function(a,c){console.log(c)}))}}}});
angular.module("mpuDashboard").directive("compostiSettori",function(){return{restrict:"E",templateUrl:"template/compostiSettori.html",scope:{compostoSettoreOriginal:"=",vm:"="},controller:function(a,e,g,c,f){a.$watch("compostoSettoreOriginal",function(c){a.compostoSettore=angular.copy(c.compostoSettore)});a.saveDataDB=function(){c.saving=!0;e.post("php/compostiSettori.php?type=db").success(function(){c.saving=!1;f.compostiSettori().then(function(c){a.vm.compostiSettori=c})}).error(function(a,b){console.log(b)})};
a.errore={compostoSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.convert=function(c,b,e){var d="";_.each(a.vm[b],function(a){a.i==c&&(d=a[e])});return d};a.$watch("compostoSettore",function(c){a.compostiAvailable=[{c:" Tutti",i:-1},{c:a.convert(a.compostoSettore.c,"composti","c")+"_"+a.convert(a.compostoSettore.c,"composti","f"),i:a.compostoSettore.c}];var b=_.where(a.vm.composti,{l:a.compostoSettore.l});_.each(b,function(b){_.find(a.vm.compostiSettori,
function(a){return a.c===b.i&&c.l===b.l})||a.compostiAvailable.push(b)})});a.$watch("compostoSettore.w",function(c){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:c});_.each(a.settoriAvailable,function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.selectedCat=function(c){return-1!=a.compostoSettore.h.indexOf(c)};a.toggleSet=function(c){-1==a.compostoSettore.h.indexOf(c)?a.compostoSettore.h.push(parseInt(c)):a.compostoSettore.h.splice(a.compostoSettore.h.indexOf(c),1)};a.updateCheck=function(){return-1==
a.compostoSettore.c};a.enableUpdate=!1;a.$watchCollection("compostoSettore.h",function(c){a.compostoSettore.i==a.compostoSettoreOriginal.compostoSettore.i&&c!=a.compostoSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1==a.compostoSettore.c||a.compostoSettore.c===a.compostoSettoreOriginal.compostoSettore.c};a.newItem=function(){c.saving=!1;a.errore.compostoSettore=!1;a.compostoSettoreOriginal.selected=!1;a.vm.nuovoCompostoSettore={i:a.vm.nuovoCompostoSettore.i+1,m:!1,l:!1,c:!1,
v:0,h:[]}};a.action=function(d){"U"==d&&(0!=a.compostoSettore.h.length?(c.saving=!0,e.post("php/compostiSettori.php?type=update",{id:a.compostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,array:a.compostoSettore.h,view:a.compostoSettore.v}).success(function(b){_.each(a.vm.compostiSettori,function(b,c){b.i==a.compostoSettore.i&&(b.c=a.compostoSettore.c,b.n=a.compostoSettore.n,b.m=a.compostoSettore.m,b.l=a.compostoSettore.l,b.w=a.compostoSettore.w,
b.h=a.compostoSettore.h,b.v=a.compostoSettore.v,a.compostoSettore=angular.copy(b))});c.saving=!1;a.errore.compostoSettore=!1;a.vm.saveCompostoSettoreData()}).error(function(a,c){console.log(c)})):a.errore.compostoSettore=!0);"C"==d&&(0!=a.compostoSettore.h.length?(c.saving=!0,e.post("php/compostiSettori.php?type=new",{id:a.vm.nuovoCompostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,view:a.compostoSettore.v,array:a.compostoSettore.h}).success(function(b){a.vm.copiedCompostoSettore=
{i:a.vm.nuovoCompostoSettore.i,c:a.compostoSettore.c,n:a.compostoSettore.n,m:a.compostoSettore.m,l:a.compostoSettore.l,w:a.compostoSettore.w,v:a.compostoSettore.v,h:a.compostoSettore.h};a.vm.compostiSettori.push(a.vm.copiedCompostoSettore);a.vm.nuovoCompostoSettore={i:a.vm.nuovoCompostoSettore.i+1};a.vm.saveCompostoSettoreData();c.saving=!1;a.errore.compostoSettore=!1}).error(function(a,c){console.log(c)})):a.errore.compostoSettore=!0);"D"==d&&(c.saving=!0,e.post("php/compostiSettori.php?type=delete",
{id:a.compostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,view:a.compostoSettore.v,array:a.compostoSettore.h}).success(function(b){-1!=a.compostoSettore.c?(a.vm.compostiSettori=_.filter(a.vm.compostiSettori,function(b){return b.i!=a.compostoSettore.i}),a.vm.saveCompostoSettoreData()):a.saveDataDB();a.newItem()}).error(function(a,c){console.log(c)}))}}}});
