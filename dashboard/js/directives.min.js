var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,g){a instanceof String&&(a=String(a));for(var c=a.length,d=0;d<c;d++){var f=a[d];if(b.call(g,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,g){a!=Array.prototype&&a!=Object.prototype&&(a[b]=g.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,g,c){if(b){g=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in g||(g[d]={});g=g[d]}a=a[a.length-1];c=g[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,g){return $jscomp.findInternal(this,a,g).v}},"es6","es3");angular.module("mpuDashboard").directive("fileRead",fileRead);function fileRead(){return{scope:{fileRead:"="},link:function(a,b){b.bind("change",function(b){var c=new FileReader;c.onload=function(b){a.$apply(function(){a.fileRead=b.target.result})};c.readAsDataURL(b.target.files[0])})}}}angular.module("mpuDashboard").directive("categorie",categorie);
categorie.$inject=["$rootScope"];
function categorie(a){return{restrict:"E",templateUrl:"template/categorie.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.buildBody=function(){return{nome:b.entity.nome,pos:b.entity.posizione,show:b.entity.show,image:b.entity.immagine,text:b.entity.descrizione}};b.updateCheck=function(){return!b.entity.nome||!b.entity.immagine||!b.entity.descrizione||!b.entity.posizione};b.actions=new a.Actions(b,"categorie");b.actions.reset=function(){b.actions.reset=function(){b.actions.cleanInputFile();
b.entity={show:1,immagine:!1}}}}}}angular.module("mpuDashboard").directive("settori",settori);settori.$inject=["$rootScope"];
function settori(a){return{restrict:"E",templateUrl:"template/settori.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.buildBody=function(){return{nome:b.entity.nome,cat:b.entity.categoria,pos:b.entity.posizione,show:b.entity.show,home:b.entity.homepage,image:b.entity.immagine,text:b.entity.descrizione}};b.updateCheck=function(){return!b.entity.nome||!b.entity.immagine||!b.entity.descrizione||!b.entity.categoria||!b.entity.posizione};b.actions=new a.Actions(b,
"settori");b.actions.reset=function(){b.actions.cleanInputFile();b.entity={show:1,homepage:0,categoria:!1,immagine:!1}}}}}angular.module("mpuDashboard").directive("marchi",marchi);marchi.$inject=["$rootScope"];
function marchi(a){return{restrict:"E",templateUrl:"template/marchi.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.buildBody=function(){var a=_.filter(b.entity.categorie,function(a){return a.checked});return{nome:b.entity.nome,show:b.entity.show,cat_array:_.pluck(a,"id"),disc:b.entity.sconto,list:b.entity.listino}};b.updateCheck=function(){return!b.entity.nome||0===b.entity.categorie.length};b.actions=new a.Actions(b,"marchi");b.actions.reset=function(){b.entity=
{show:1,categorie:a.settings.generateObject("categorie","cat"),listino:0,sconto:0}}}}}angular.module("mpuDashboard").directive("tabelleProdotti",tabelleProdotti);tabelleProdotti.$inject=["$rootScope"];
function tabelleProdotti(a){return{restrict:"E",templateUrl:"template/tabelle_prodotti.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.buildBody=function(){return{nome:b.entity.nome,pos:b.entity.posizione,mark:b.entity.marchio}};b.updateCheck=function(){return!b.entity.nome||!b.entity.marchio||!b.entity.posizione};b.actions=new a.Actions(b,"tabelle_prodotti");b.actions.reset=function(){b.entity={posizione:0,marchio:!1}}}}}
angular.module("mpuDashboard").directive("finiture",finiture);finiture.$inject=["$rootScope"];
function finiture(a){return{restrict:"E",templateUrl:"template/finiture.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.buildBody=function(){return{nome:b.entity.nome,cod:b.entity.codice,mark:b.entity.marchio,show:b.entity.show,type:b.entity.tipo,image:b.entity.immagine}};b.updateCheck=function(){return!b.entity.nome||!b.entity.marchio||!b.entity.codice||!b.entity.immagine};b.actions=new a.Actions(b,"finiture");b.actions.reset=function(){b.actions.cleanInputFile();
b.entity={show:1,tipo:0,marchio:!1,immagine:!1}}}}}angular.module("mpuDashboard").directive("linee",linee);linee.$inject=["$rootScope"];
function linee(a){return{restrict:"E",templateUrl:"template/linee.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.checked=!1;b.buildBody=function(){var a=[];0<b.entity.abbinamenti.length&&_.each(b.entity.abbinamenti,function(b){b.categoria&&b.settore&&b.linea&&a.push(JSON.parse(angular.toJson(b)))});return{nome:b.entity.nome,mark:b.entity.marchio,cat:b.entity.categoria,show:b.entity.show,vtr:b.entity.vetrina,time:b.entity.consegna,war:b.entity.garanzia,disc:b.entity.sconto,
pos:b.entity.posizione,link:a,ctl:b.entity.catalogo,spc:b.entity.specifiche}};b.updateCheck=function(){return!b.entity.nome||!b.entity.marchio||!b.entity.categoria||!b.entity.posizione};b.actions=new a.Actions(b,"linee");b.actions.abbinamenti={add:function(a){a.push({categoria:!1,settore:!1,linea:!1})},reset:function(a){a.length=0},remove:function(a,b){a.splice(b,1)}};b.actions.checkItem=function(a,c,d){_.find(c,function(b){var e=b.line_nome===a.nome&&b.line_mark_id===a.marchio;return a.id?e&&b.line_id!==
a.id:e})?b.actions.checked():b.actions[d]()};b.actions.reset=function(){b.actions.cleanInputFile();b.entity={show:1,vetrina:0,posizione:0,consegna:25,garanzia:2,sconto:0,marchio:!1,categoria:!1,catalogo:"",specifiche:"",abbinamenti:[]}}}}}angular.module("mpuDashboard").directive("settoriLinee",settoriLinee);settoriLinee.$inject=["$rootScope"];
function settoriLinee(a){return{restrict:"E",templateUrl:"template/settori_linee.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.checked=!1;b.buildBody=function(){return{mark:b.entity.marchio,line:b.entity.linea,set:b.entity.settore,show:b.entity.show,price:b.entity.prezzo,image:b.entity.immagine}};b.updateCheck=function(){return!b.entity.marchio||!b.entity.linea||!b.entity.settore||!b.entity.immagine};b.actions=new a.Actions(b,"settori_linee");b.actions.checkItem=
function(a,c,d){_.find(c,function(b){var e=b.stln_set_id===a.settore&&b.stln_mark_id===a.marchio&&b.stln_line_id===a.linea;return a.id?e&&b.stln_id!==a.id:e})?b.actions.checked():b.actions[d]()};b.actions.reset=function(){b.actions.cleanInputFile();b.entity={show:1,prezzo:3,marchio:!1,linea:!1,settore:!1,immagine:!1}}}}}angular.module("mpuDashboard").directive("tabelleFiniture",tabelleFiniture);tabelleFiniture.$inject=["$rootScope"];
function tabelleFiniture(a){return{restrict:"E",templateUrl:"template/tabelle_finiture.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.checked=!1;b.buildBody=function(){return{nome:b.entity.nome,line:b.entity.linea,mark:b.entity.marchio}};b.updateCheck=function(){return!b.entity.nome||!b.entity.marchio||!b.entity.linea};b.actions=new a.Actions(b,"tabelle_finiture");b.actions.checkItem=function(a,c,d){_.find(c,function(b){var e=b.tab_nome===a.nome&&b.tab_mark_id===
a.marchio&&b.tab_line_id===a.linea;return a.id?e&&b.tab_id!==a.id:e})?b.actions.checked():b.actions[d]()};b.actions.reset=function(){b.entity={linea:!1,marchio:!1}}}}}angular.module("mpuDashboard").directive("abbinamenti",abbinamenti);abbinamenti.$inject=["$rootScope"];
function abbinamenti(a){return{restrict:"E",templateUrl:"template/abbinamenti.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.checked=!1;b.buildBody=function(){return{cod:b.entity.codice,mark:b.entity.marchio,line:b.entity.linea,tab:b.entity.tabella,abb_array:b.entity.abbinamenti}};var g=function(){return _.filter(b.entity.abbinamenti,function(a){return!a.i||!a.n}).length};b.updateCheck=function(){return!b.entity.codice||!b.entity.marchio||!b.entity.linea||
!b.entity.tabella||0===b.entity.abbinamenti.length||0<g()};b.actions=new a.Actions(b,"abbinamenti");b.actions.abbinamenti={add:function(a){a.push({i:!1,n:""})},remove:function(a,b){a.splice(b,1)}};b.actions.checkItem=function(a,d,f){_.find(d,function(b){var e=b.abb_cod===a.codice&&b.abb_mark_id===a.marchio&&b.abb_line_id===a.linea&&b.abb_tab===a.tabella;return a.id?e&&b.abb_id!==a.id:e})?b.actions.checked():b.actions[f]()};b.actions.reset=function(){b.actions.cleanInputFile();b.entity={marchio:!1,
linea:!1,tabella:!1,abbinamenti:[{i:!1,n:""}]}}}}}angular.module("mpuDashboard").directive("prodotti",prodotti);prodotti.$inject=["$rootScope"];
function prodotti(a){return{restrict:"E",templateUrl:"template/prodotti.html",scope:{entity:"="},link:function(b){b.entity=angular.copy(b.entity);b.confirm=!1;b.checked=!1;b.buildBody=function(){return{cod:b.entity.codice,title:b.entity.titolo,dim:b.entity.dimensioni,note:b.entity.note,tbpr:b.entity.tabella,mark:b.entity.marchio,line:b.entity.linea,prices:b.entity.prezzi,pos:b.entity.posizione,lnfn:b.entity.finitura_linea,abb:b.entity.finitura_unica,fin:b.entity.finitura_tipo,show:b.entity.show,image:b.entity.immagine}};
var g=function(){return _.filter(b.entity.prezzi,function(a){return!a.z||!a.a}).length};b.updateCheck=function(){return!b.entity.codice||!b.entity.titolo||!b.entity.tabella||!b.entity.marchio||!b.entity.linea||!b.entity.immagine||0<g()};b.actions=new a.Actions(b,"prodotti");b.actions.prezzi={add:function(a){a.push({z:0,a:!1})},remove:function(a,b){a.splice(b,1)}};b.actions.checkItem=function(a,d,f){_.find(d,function(b){var e=b.prd_cod===a.codice&&b.prd_mark_id===a.marchio&&b.prd_line_id===a.linea;
return a.id?e&&b.prd_id!==a.id:e})?b.actions.checked():b.actions[f]()};b.actions.reset=function(){b.actions.cleanInputFile();b.entity={posizione:0,prezzi:[{z:0,a:!1}],marchio:!1,linea:!1,finitura_linea:!1,tabella:!1,finitura_tipo:0,finitura_unica:0,immagine:!1}}}}}
angular.module("mpuDashboard").directive("prodottiSettori",function(){return{restrict:"E",templateUrl:"template/prodottiSettori.html",scope:{prodottoSettoreOriginal:"=",vm:"="},controller:function(a,b,g,c,d){a.$watch("prodottoSettoreOriginal",function(b){a.prodottoSettore=angular.copy(b.prodottoSettore)});a.saveDataDB=function(){c.saving=!0;b.post("php/prodottiSettori.php?type=db").success(function(){c.saving=!1;d.prodottiSettori().then(function(b){a.vm.prodottiSettori=b})}).error(function(a,b){console.log(b)})};
a.errore={prodottoSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("prodottoSettore",function(b){a.prodottiAvailable=[{c:" Tutti",i:-1},{c:a.prodottoSettore.n,i:a.prodottoSettore.c}];b=_.where(a.vm.prodotti,{l:b.l});_.each(b,function(b){_.find(a.vm.prodottiSettori,function(a){return a.c===b.i})||a.prodottiAvailable.push(b)})});a.$watch("prodottoSettore.w",function(b){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:b});_.each(a.settoriAvailable,
function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.$watch("prodottoSettore.c",function(b){if(b&&-1!=b){var e=_.find(a.vm.prodotti,function(a){return a.i==b});a.prodottoSettore.n=e.c}});a.selectedCat=function(b){return-1!=a.prodottoSettore.h.indexOf(b)};a.toggleSet=function(b){-1==a.prodottoSettore.h.indexOf(b)?a.prodottoSettore.h.push(parseInt(b)):a.prodottoSettore.h.splice(a.prodottoSettore.h.indexOf(b),1)};a.updateCheck=function(){return-1==a.prodottoSettore.c};a.enableUpdate=!1;a.$watchCollection("prodottoSettore.h",
function(b){a.prodottoSettore.i==a.prodottoSettoreOriginal.prodottoSettore.i&&b!=a.prodottoSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1===a.prodottoSettore.c||a.prodottoSettore.c===a.prodottoSettoreOriginal.prodottoSettore.c};a.newProdottoSettore=function(){c.saving=!1;a.errore.prodottoSettore=!1;a.prodottoSettoreOriginal.selected=!1;a.vm.nuovoProdottoSettore={i:a.vm.nuovoProdottoSettore.i+1,m:!1,l:!1,c:!1,h:[]}};a.action=function(f){"U"==f&&(0!=a.prodottoSettore.h.length?
(c.saving=!0,b.post("php/prodottiSettori.php?type=update",{id:a.prodottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){_.each(a.vm.prodottiSettori,function(b,e){b.i==a.prodottoSettore.i&&(b.c=a.prodottoSettore.c,b.n=a.prodottoSettore.n,b.m=a.prodottoSettore.m,b.l=a.prodottoSettore.l,b.w=a.prodottoSettore.w,b.h=a.prodottoSettore.h,a.prodottoSettore=angular.copy(b))});c.saving=!1;a.errore.prodottoSettore=
!1;a.vm.saveProdottoSettoreData()}).error(function(a,b){console.log(b)})):a.errore.prodottoSettore=!0);"C"==f&&(0!=a.prodottoSettore.h.length?(c.saving=!0,b.post("php/prodottiSettori.php?type=new",{id:a.vm.nuovoProdottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){a.vm.copiedProdottoSettore={i:a.vm.nuovoProdottoSettore.i,c:a.prodottoSettore.c,n:a.prodottoSettore.n,m:a.prodottoSettore.m,l:a.prodottoSettore.l,
w:a.prodottoSettore.w,h:a.prodottoSettore.h};a.vm.prodottiSettori.push(a.vm.copiedProdottoSettore);a.vm.nuovoProdottoSettore={i:a.vm.nuovoProdottoSettore.i+1};a.vm.saveProdottoSettoreData();c.saving=!1;a.errore.prodottoSettore=!1}).error(function(a,b){console.log(b)})):a.errore.prodottoSettore=!0);"D"==f&&(c.saving=!0,b.post("php/prodottiSettori.php?type=delete",{id:a.prodottoSettore.i,cod:a.prodottoSettore.c,mark:a.prodottoSettore.m,line:a.prodottoSettore.l,nwln:a.prodottoSettore.w,array:a.prodottoSettore.h}).success(function(b){-1!=
a.prodottoSettore.c?(a.vm.prodottiSettori=_.filter(a.vm.prodottiSettori,function(b){return b.i!=a.prodottoSettore.i}),a.vm.saveProdottoSettoreData()):a.saveDataDB();a.newProdottoSettore()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("vetrine",function(){return{restrict:"E",templateUrl:"template/vetrine.html",scope:{vetrinaOriginal:"=",vm:"="},controller:function(a,b,g,c){function d(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function f(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={vetrina:!1};a.generateSettoriInLinea=function(b){if(b){var e=[],f=_.find(a.vm.linee,function(a){return a.i===b}).q;_.each(f,function(b){var f=
_.find(a.vm.settori,function(a){return a.i===b}).n;e.push({i:b,n:f})});return e}};a.selectedCat=function(b){console.log(a.vetrina);return-1!=a.vetrina.s.indexOf(b)};a.toggleSet=function(b){-1==a.vetrina.s.indexOf(b)?a.vetrina.s.push(parseInt(b)):a.vetrina.s.splice(a.vetrina.s.indexOf(b),1)};a.$watch("vetrinaOriginal",function(b){a.vetrina=angular.copy(b.vetrina);b=d(a.vetrina.m);var e=f(a.vetrina.l);b=b.replace(/ /g,"_");e=e.replace(/ /g,"_");a.vetrina.r="../dashboard/archivio_dati/"+b+"/"+e+"/Vetrina/"+
(e+"_"+a.vetrina.c+".jpg")});a.settoriInLinea=!1;a.$watch("vetrina.l",function(b){a.settoriInLinea=a.generateSettoriInLinea(b)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.vetrina.c||!a.vetrina.n||!a.vetrina.m||!a.vetrina.l||!a.vetrina.r||!a.vetrina.s||isNaN(a.vetrina.y)};a.deleteCheck=function(){return a.vetrina.c!==a.vetrinaOriginal.vetrina.c||a.vetrina.m!==a.vetrinaOriginal.vetrina.m||a.vetrina.l!==a.vetrinaOriginal.vetrina.l};
a.copyCheck=function(){return!a.vetrina.c||!a.vetrina.m||!a.vetrina.l||a.vetrina.c===a.vetrinaOriginal.vetrina.c&&a.vetrina.l===a.vetrinaOriginal.vetrina.l};a.newVetrina=function(){c.saving=!1;a.errore.vetrina=!1;a.vetrinaOriginal.selected=!1;a.vm.nuovaVetrina={i:a.vm.nuovaVetrina.i+1,m:!1,l:!1,s:!1,y:1,v:1}};a.action=function(e){if("U"==e){var f=a.vetrina.c!=a.vetrinaOriginal.vetrina.c||a.vetrina.l!=a.vetrinaOriginal.vetrina.l?_.findWhere(a.vm.vetrine,{c:a.vetrina.c,l:a.vetrina.l}):!1;f?a.errore.vetrina=
!0:(c.saving=!0,b.post("php/vetrine.php?type=update",{id:a.vetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r,sourceCod:a.vetrinaOriginal.vetrina.c,sourceMark:a.vetrinaOriginal.vetrina.m,sourceLine:a.vetrinaOriginal.vetrina.l}).success(function(b){a.errore.vetrina=!1;a.vm.saveVetrinaData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.vetrine,function(b){b.i==a.vetrina.i&&(b.m=
a.vetrina.m,b.l=a.vetrina.l,b.c=a.vetrina.c,b.n=a.vetrina.n,b.s=a.vetrina.s,b.v=a.vetrina.v,b.y=a.vetrina.y,b.o=a.vetrina.o,b.r=a.vetrina.r,a.vetrina=angular.copy(b))});c.saving=!1;a.errore.vetrina=!1}).error(function(a,b){console.log(b)}))}"C"==e&&(_.findWhere(a.vm.vetrine,{c:a.vetrina.c,m:a.vetrina.m,l:a.vetrina.l})?a.errore.vetrina=!0:(c.saving=!0,b.post("php/vetrine.php?type=new",{id:a.vm.nuovaVetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,
note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r,sourceCod:a.vetrinaOriginal.vetrina.c,sourceMark:a.vetrinaOriginal.vetrina.m,sourceLine:a.vetrinaOriginal.vetrina.l}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedVetrina={i:a.vm.nuovoProdotto.i,m:a.vetrina.m,l:a.vetrina.l,c:a.vetrina.c,n:a.vetrina.n,s:a.vetrina.s,v:a.vetrina.v,y:a.vetrina.y,o:a.vetrina.o};a.vm.vetrine.push(a.vm.copiedVetrina);a.vm.nuovaVetrina={i:a.vm.nuovaVetrina.i+1};a.vm.saveVetrinaData();c.saving=
!1;a.errore.vetrina=!1}).error(function(a,b){console.log(b)})));"D"==e&&(c.saving=!0,b.post("php/vetrine.php?type=delete",{id:a.vetrina.i,mark:a.vetrina.m,line:a.vetrina.l,cod:a.vetrina.c,title:a.vetrina.n,show:a.vetrina.v,pos:a.vetrina.y,note:a.vetrina.o,settore:a.vetrina.s,image:a.vetrina.r}).success(function(b){a.vm.vetrine=_.filter(a.vm.vetrine,function(b){return b.i!=a.vetrina.i});a.vm.saveVetrinaData();a.newVetrina()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("vetrineProdotti",function(){return{restrict:"E",templateUrl:"template/vetrineProdotti.html",scope:{vetrinaProdottoOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("vetrinaProdottoOriginal",function(b){a.vetrinaProdotto=angular.copy(b.vetrinaProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("vetrinaProdotto.p",function(b,f){b!=f&&a.vetrinaProdottoOriginal.i==a.vetrinaProdotto&&(a.vetrinaProdotto.u=
!1);if(b){b=_.findWhere(a.vm.prodotti,{i:b});b=_.pluck(b.z,"a");a.tabsAvailable=[];for(f=0;f<b.length;f++){var e=_.findWhere(a.vm.finitureTabelle,{i:b[f]});a.tabsAvailable.push({i:b[f],n:e.n})}return a.tabsAvailable}});a.$watch("vetrinaProdotto.u",function(b,f){b!=f&&a.vetrinaProdottoOriginal.i==a.vetrinaProdotto&&(a.vetrinaProdotto.f=!1);if(b)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:b}),a.finsAvailable});a.newVetrinaProdotto=function(){c.saving=!1;a.vetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i+
1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.vetrinaProdotto.c||!a.vetrinaProdotto.p||!a.vetrinaProdotto.l||!a.vetrinaProdotto.j||!a.vetrinaProdotto.u||!a.vetrinaProdotto.f||isNaN(a.vetrinaProdotto.y)||isNaN(a.vetrinaProdotto.q)};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/vetrineProdotti.php?type=update",{id:a.vetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,
cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(b){a.vm.saveVetrineProdottiData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.vetrineProdotti,function(b){b.i==a.vetrinaProdotto.i&&(b.c=a.vetrinaProdotto.c,b.p=a.vetrinaProdotto.p,b.l=a.vetrinaProdotto.l,b.j=a.vetrinaProdotto.j,b.m=a.vetrinaProdotto.m,b.k=a.vetrinaProdotto.k,b.f=a.vetrinaProdotto.f,b.u=a.vetrinaProdotto.u,b.y=a.vetrinaProdotto.y,
b.q=a.vetrinaProdotto.q,a.vetrinaProdotto=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==d&&(c.saving=!0,b.post("php/vetrineProdotti.php?type=new",{id:a.vm.nuovoVetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(b){console.log("Risposta dalla pagina PHP",
b);a.vm.copiedVetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i,c:a.vetrinaProdotto.c,p:a.vetrinaProdotto.p,l:a.vetrinaProdotto.l,j:a.vetrinaProdotto.j,m:a.vetrinaProdotto.m,k:a.vetrinaProdotto.k,f:a.vetrinaProdotto.f,u:a.vetrinaProdotto.u,y:a.vetrinaProdotto.y,q:a.vetrinaProdotto.q};a.vm.vetrineProdotti.push(a.vm.copiedVetrinaProdotto);a.vm.nuovoVetrinaProdotto={i:a.vm.nuovoVetrinaProdotto.i+1};a.vm.saveVetrineProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/vetrineProdotti.php?type=delete",
{id:a.vetrinaProdotto.i,comp:a.vetrinaProdotto.c,prd:a.vetrinaProdotto.p,pline:a.vetrinaProdotto.l,cline:a.vetrinaProdotto.j,pmark:a.vetrinaProdotto.m,cmark:a.vetrinaProdotto.k,fin:a.vetrinaProdotto.f,tab:a.vetrinaProdotto.u,pos:a.vetrinaProdotto.y,qnt:a.vetrinaProdotto.q}).success(function(b){a.vm.vetrineProdotti=_.filter(a.vm.vetrineProdotti,function(b){return b.i!=a.vetrinaProdotto.i});a.vm.saveVetrineProdottiData();a.newVetrinaProdotto()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("nazioni",function(){return{restrict:"E",templateUrl:"template/nazioni.html",scope:{cat:"=",vm:"="},controller:function(a,b,g,c){a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.cat.n||!a.cat.x};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/nazioni.php?type=update",{id:a.cat.i,nome:a.cat.n,show:a.cat.v,prx:a.cat.x}).success(function(b){a.vm.saveNazioniData();c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/nazioni.php?type=delete",{id:a.cat.i,nome:a.cat.n,show:a.cat.v,prx:a.cat.x}).success(function(b){a.vm.nazioni=_.filter(a.vm.nazioni,function(b){return b.i!=a.cat.i});a.vm.saveNazioniData();c.saving=!1}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("regioni",function(){return{restrict:"E",templateUrl:"template/regioni.html",scope:{regioneOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("regioneOriginal",function(b){a.regione=angular.copy(b.regione)});a.errore={regione:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.regione.n||!a.regione.z};a.newItem=function(){a.regioneOriginal.selected=!1;a.errore.regione=!1;c.saving=
!1;a.vm.nuovaRegione={i:a.vm.nuovaRegione.i+1,z:!1}};a.action=function(d){"U"==d&&(_.findWhere(a.vm.regioni,{n:a.regione.n,z:a.regione.z})?a.errore.regione=!0:(c.saving=!0,b.post("php/regioni.php?type=update",{id:a.regione.i,nome:a.regione.n,nazione:a.regione.z}).success(function(b){a.vm.saveRegioniData();_.each(a.vm.regioni,function(b){b.i==a.regione.i&&(b.n=a.regione.n,b.z=a.regione.z,a.regione=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)})));"D"==d&&(c.saving=!0,b.post("php/regioni.php?type=delete",
{id:a.regione.i,nome:a.regione.n,nazioni:a.regione.z}).success(function(b){a.vm.regioni=_.filter(a.vm.regioni,function(b){return b.i!=a.regione.i});a.vm.saveRegioniData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("province",function(){return{restrict:"E",templateUrl:"template/province.html",scope:{provinciaOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("provinciaOriginal",function(b){a.provincia=angular.copy(b.provincia)});a.errore={provincia:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.copyCheck=function(){return!a.provincia.n||!a.provincia.c||!a.provincia.r||!a.provincia.z||a.provincia.n===a.provinciaOriginal.provincia.n};
a.newItem=function(){c.saving=!1;a.provinciaOriginal.selected=!1;a.errore.provincia=!1;a.vm.nuovaProvincia={i:a.vm.nuovaProvincia.i+1,z:!1,r:!1,b:0,l:0,t:0,j:1,m:0,k:1}};a.action=function(d){"U"==d&&(a.provincia.n&&a.provincia.z?(c.saving=!0,b.post("php/province.php?type=update",{id:a.provincia.i,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,limite:a.provincia.l,
minimo:a.provincia.b}).success(function(b){a.vm.saveProvinceData();_.each(a.vm.province,function(b){b.i==a.provincia.i&&(b.n=a.provincia.n,b.c=a.provincia.c,b.z=a.provincia.z,b.r=a.provincia.r,b.t=a.provincia.t,b.j=a.provincia.j,b.m=a.provincia.m,b.k=a.provincia.k,b.l=a.provincia.l,b.b=a.provincia.b,a.provincia=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)})):a.errore.provincia=!0);"C"==d&&(_.findWhere(a.vm.province,{n:a.provincia.n,c:a.provincia.c,z:a.provincia.z,r:a.provincia.r})?
a.errore.provincia=!0:(c.saving=!0,b.post("php/province.php?type=new",{id:a.vm.nuovaProvincia.i+1,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,limite:a.provincia.l,minimo:a.provincia.b}).success(function(b){a.vm.copiedProvincia={i:a.vm.nuovaProvincia.i,n:a.provincia.n,c:a.provincia.c,z:a.provincia.z,r:a.provincia.r,t:a.provincia.t,j:a.provincia.j,m:a.provincia.m,
k:a.provincia.k,l:a.provincia.l,b:a.provincia.b};a.vm.province.push(a.vm.copiedProvincia);a.vm.nuovaProvincia={i:a.vm.nuovaProvincia.i+1};a.vm.saveProvinceData();c.saving=!1;a.errore.provincia=!1}).error(function(a,b){console.log(b)})));"D"==d&&(c.saving=!0,b.post("php/province.php?type=delete",{id:a.provincia.i,nome:a.provincia.n,sigla:a.provincia.c,nazione:a.provincia.z,regione:a.provincia.r,trasporto:a.provincia.t,trasporto_type:a.provincia.j,montaggio:a.provincia.m,montaggio_type:a.provincia.k,
limite:a.provincia.l,minimo:a.provincia.b}).success(function(b){a.vm.province=_.filter(a.vm.province,function(b){return b.i!=a.provincia.i});a.vm.saveProvinceData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("convenzioni",function(){return{restrict:"E",templateUrl:"template/convenzioni.html",scope:{cat:"=",vm:"="},controller:function(a,b,g,c){a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.cat.n};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/convenzioni.php?type=update",{id:a.cat.i,nome:a.cat.n,email:a.cat.e}).success(function(b){a.vm.saveConvenzioniData();c.saving=!1}).error(function(a,
b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/convenzioni.php?type=delete",{id:a.cat.i,nome:a.cat.n,email:a.cat.e}).success(function(b){a.vm.convenzioni=_.filter(a.vm.convenzioni,function(b){return b.i!=a.cat.i});a.vm.saveConvenzioniData();c.saving=!1}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("agenti",function(){return{restrict:"E",templateUrl:"template/agenti.html",scope:{agenteOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("agenteOriginal",function(b){a.agente=angular.copy(b.agente)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.agente.n||!a.agente.e||!a.agente.p||!a.agente.r||!a.agente.t};a.newItem=function(){c.saving=!1;a.agenteOriginal.selected=!1;a.vm.nuovoAgente=
{i:a.vm.nuovoAgente.i+1,r:!1}};a.convert=function(b,f,e){var c=[],d="";if("object"===typeof b){for(var k=0;k<b.length;k++)_.each(a.vm[f],function(a){a.i==b[k]&&c.push(a[e])});return c}_.each(a.vm[f],function(a){a.i==b&&(d=a[e])});return d};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/agenti.php?type=update",{id:a.agente.i,nome:a.agente.n,email:a.agente.e,password:a.agente.p,tel:a.agente.t,riv:a.agente.r}).success(function(b){a.vm.saveAgentiData();_.each(a.vm.agenti,function(b){b.i==a.agente.i&&
(b.n=a.agente.n,b.e=a.agente.e,b.p=a.agente.p,b.t=a.agente.t,b.r=a.agente.r,a.agente=angular.copy(b))});console.log("Risposta dalla pagina PHP",b);c.saving=!1}).error(function(a,b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/agenti.php?type=delete",{id:a.agente.i,nome:a.agente.n,email:a.agente.e,password:a.agente.p,tel:a.agente.t,riv:a.agente.r}).success(function(b){a.vm.agenti=_.filter(a.vm.agenti,function(b){return b.i!=a.agente.i});a.vm.saveAgentiData();a.newItem();c.saving=!1}).error(function(a,
b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("rivenditori",function(){return{restrict:"E",templateUrl:"template/rivenditori.html",scope:{rivenditoreOriginal:"=",vm:"="},controller:function(a,b,g,c){a.errore={rivenditore:!1};a.convert=function(b,e,c){var f=[],d="";if("object"===typeof b){for(var h=0;h<b.length;h++)_.each(a.vm[e],function(a){a.i==b[h]&&f.push(a[c])});return f}_.each(a.vm[e],function(a){a.i==b&&(d=a[c])});return d};a.$watch("rivenditoreOriginal",function(b){a.rivenditore=angular.copy(b.rivenditore);
a.rivenditore.g="../dashboard/archivio_dati/Rivenditori/"+(a.rivenditore.i+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return(!a.rivenditore.z||!a.rivenditore.r||!a.rivenditore.p)&&!a.rivenditore.v||!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||!a.rivenditore.h&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||!a.rivenditore.g};a.copyCheck=function(){return a.rivenditore.v?!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||
!a.rivenditore.t&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||a.rivenditore.n===a.rivenditoreOriginal.rivenditore.n:!a.rivenditore.z||!a.rivenditore.r||!a.rivenditore.p||!a.rivenditore.n||!a.rivenditore.x||!a.rivenditore.s||!a.rivenditore.t&&!a.rivenditore.c||!a.rivenditore.e||!a.rivenditore.w||a.rivenditore.p===a.rivenditoreOriginal.rivenditore.p};a.openMarchi=function(){a.vm.mv=!a.vm.mv};var d=function(){a.vm.mv=!1;a.vm.nuovoRivenditore.y=angular.copy(a.vm.marchi);_.each(a.vm.nuovoRivenditore.y,
function(a){a.s=0;delete a.n;delete a.b;delete a.g});return a.vm.nuovoRivenditore.y};d();a.newItem=function(){c.saving=!1;a.errore.rivenditore=!1;a.rivenditoreOriginal.selected=!1;a.vm.nuovoRivenditore={i:a.vm.nuovoRivenditore.i+1,z:!1,r:!1,p:!1,b:0,l:0,t:0,j:1,m:0,k:1,v:!1,c:"",h:"",f:"",a:""};d()};a.action=function(f){if("U"==f){var e=a.rivenditore.p&&a.rivenditore.p!=a.rivenditoreOriginal.rivenditore.p?_.findWhere(a.vm.rivenditori,{p:a.rivenditore.p}):!1;e?a.errore.rivenditore=!0:(c.saving=!0,
b.post("php/rivenditori.php?type=update",{id:a.rivenditore.i,nome:a.rivenditore.n,naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.x,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,
coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g}).success(function(b){a.errore.rivenditore=!1;a.vm.saveRivenditoreData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.rivenditori,function(b){b.i==a.rivenditore.i&&(b.n=a.rivenditore.n,b.z=a.rivenditore.z,b.r=a.rivenditore.r,b.p=a.rivenditore.p,b.v=a.rivenditore.v,b.r=a.rivenditore.r,b.s=a.rivenditore.s,b.h=a.rivenditore.h,b.f=a.rivenditore.f,b.c=a.rivenditore.c,b.q=a.rivenditore.q,b.e=a.rivenditore.e,b.w=a.rivenditore.w,
b.l=a.rivenditore.l,b.b=a.rivenditore.b,b.t=a.rivenditore.t,b.j=a.rivenditore.j,b.m=a.rivenditore.m,b.k=a.rivenditore.k,b.y=a.rivenditore.y,b.o=a.rivenditore.o,b.a=a.rivenditore.a,b.g=a.rivenditore.g,a.rivenditore=angular.copy(b))});c.saving=!1;a.errore.rivenditore=!1}).error(function(a,b){console.log(b)}))}"C"==f&&(e=a.rivenditore.p?_.findWhere(a.vm.rivenditori,{p:a.rivenditore.p}):void 0,e?a.errore.rivenditore=!0:(c.saving=!0,b.post("php/rivenditori.php?type=new",{id:a.vm.nuovoRivenditore.i+1,nome:a.rivenditore.n,
naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.x,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g,sourceID:a.rivenditoreOriginal.rivenditore.i}).success(function(b){a.vm.copiedRivenditore=
{i:a.vm.nuovoRivenditore.i+1,n:a.rivenditore.n,z:a.rivenditore.z,r:a.rivenditore.r,p:a.rivenditore.p,v:a.rivenditore.v,x:a.rivenditore.x,s:a.rivenditore.s,h:a.rivenditore.h,f:a.rivenditore.f,c:a.rivenditore.c,q:a.rivenditore.q,e:a.rivenditore.e,w:a.rivenditore.w,l:a.rivenditore.l,b:a.rivenditore.b,t:a.rivenditore.t,j:a.rivenditore.j,m:a.rivenditore.m,k:a.rivenditore.k,y:a.rivenditore.y,o:a.rivenditore.o,a:a.rivenditore.a};a.vm.rivenditori.push(a.vm.copiedRivenditore);a.vm.nuovoRivenditore={i:a.vm.nuovoRivenditore.i+
1};a.vm.saveRivenditoreData();c.saving=!1;a.errore.rivenditore=!1}).error(function(a,b){console.log(b)})));"D"==f&&(c.saving=!0,b.post("php/rivenditori.php?type=delete",{id:a.rivenditore.i,nome:a.rivenditore.n,naz:a.rivenditore.z,reg:a.rivenditore.r,prov:a.rivenditore.p,conv:a.rivenditore.v,rif:a.rivenditore.r,sede:a.rivenditore.s,tel:a.rivenditore.h,fax:a.rivenditore.f,cell:a.rivenditore.c,web:a.rivenditore.q,email:a.rivenditore.e,psw:a.rivenditore.w,limite:a.rivenditore.l,minimo:a.rivenditore.b,
trasporto:a.rivenditore.t,trasporto_type:a.rivenditore.j,montaggio:a.rivenditore.m,montaggio_type:a.rivenditore.k,mark:a.rivenditore.y,coords:a.rivenditore.o,notes:a.rivenditore.a,image:a.rivenditore.g}).success(function(b){a.vm.rivenditori=_.filter(a.vm.rivenditori,function(b){return b.i!=a.rivenditore.i});a.vm.saveRivenditoreData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioni",function(){return{restrict:"E",templateUrl:"template/esposizioni.html",scope:{esposizioneOriginal:"=",vm:"="},controller:function(a,b,g,c){function d(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function f(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={esposizione:!1};a.$watch("esposizioneOriginal",function(b){a.esposizione=angular.copy(b.esposizione);b=d(a.esposizione.m);
var e=f(a.esposizione.l);b=b.replace(/ /g,"_");e=e.replace(/ /g,"_");var c=a.esposizione.f.replace(/ /g,"_");a.esposizione.r="../dashboard/archivio_dati/"+b+"/"+e+"/Render/"+(e+"_"+a.esposizione.c+"_"+c+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.esposizione.c||!a.esposizione.f||!a.esposizione.m||!a.esposizione.l||!a.esposizione.t||!a.esposizione.r||isNaN(a.esposizione.y)};a.deleteCheck=function(){return a.esposizione.c!==
a.esposizioneOriginal.esposizione.c||a.esposizione.m!==a.esposizioneOriginal.esposizione.m||a.esposizione.l!==a.esposizioneOriginal.esposizione.l||a.esposizione.f!==a.esposizioneOriginal.esposizione.f};a.copyCheck=function(){return!a.esposizione.c||!a.esposizione.m||!a.esposizione.l||!a.esposizione.f||a.esposizione.c===a.esposizioneOriginal.esposizione.c&&a.esposizione.l===a.esposizioneOriginal.esposizione.l&&a.esposizione.f===a.esposizioneOriginal.esposizione.f};a.newItem=function(){c.saving=!1;
a.errore.esposizione=!1;a.esposizioneOriginal.selected=!1;a.vm.nuovoComposto={i:a.vm.nuovaEsposizione.i+1,m:!1,l:!1,t:!1,y:1}};a.action=function(e){if("U"==e){var f=a.esposizione.c!=a.esposizioneOriginal.esposizione.c||a.esposizione.l!=a.esposizioneOriginal.esposizione.l||a.esposizione.f!=a.esposizioneOriginal.esposizione.f?_.findWhere(a.vm.esposizioni,{c:a.esposizione.c,l:a.esposizione.l,f:a.esposizione.f}):!1;f?a.errore.esposizione=!0:(c.saving=!0,b.post("php/esposizioni.php?type=update",{id:a.esposizione.i,
mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r,sourceCod:a.esposizioneOriginal.esposizione.c,sourceMark:a.esposizioneOriginal.esposizione.m,sourceLine:a.esposizioneOriginal.esposizione.l,sourceFin:a.esposizioneOriginal.esposizione.f}).success(function(b){a.errore.esposizione=!1;a.vm.saveEsposizioneData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.esposizioni,
function(b){b.i==a.esposizione.i&&(b.m=a.esposizione.m,b.l=a.esposizione.l,b.t=a.esposizione.t,b.c=a.esposizione.c,b.f=a.esposizione.f,b.d=a.esposizione.d,b.y=a.esposizione.y,b.n=a.esposizione.n,b.r=a.esposizione.r,a.esposizione=angular.copy(b))});c.saving=!1;a.errore.esposizione=!1}).error(function(a,b){console.log(b)}))}"C"==e&&(_.findWhere(a.vm.esposizioni,{c:a.esposizione.c,m:a.esposizione.m,l:a.esposizione.l,f:a.esposizione.f})?a.errore.esposizione=!0:(c.saving=!0,b.post("php/esposizioni.php?type=new",
{id:a.vm.nuovaEsposizione.i,mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r,sourceCod:a.esposizioneOriginal.esposizione.c,sourceMark:a.esposizioneOriginal.esposizione.m,sourceLine:a.esposizioneOriginal.esposizione.l,sourceFin:a.esposizioneOriginal.esposizione.f}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedEsposizione={i:a.vm.nuovaEsposizione.i,
m:a.esposizione.m,l:a.esposizione.l,t:a.esposizione.t,c:a.esposizione.c,f:a.esposizione.f,d:a.esposizione.d,y:a.esposizione.y,n:a.esposizione.n};a.vm.esposizioni.push(a.vm.copiedEsposizione);a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1};a.vm.saveEsposizioneData();c.saving=!1;a.errore.esposizione=!1}).error(function(a,b){console.log(b)})));"D"==e&&(c.saving=!0,b.post("php/esposizioni.php?type=delete",{id:a.esposizione.i,mark:a.esposizione.m,line:a.esposizione.l,tbpr:a.esposizione.t,cod:a.esposizione.c,
fin:a.esposizione.f,dim:a.esposizione.d,pos:a.esposizione.y,nome:a.esposizione.n,image:a.esposizione.r}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.esposizioni=_.filter(a.vm.esposizioni,function(b){return b.i!=a.esposizione.i});a.vm.saveEsposizioneData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("composti",function(){return{restrict:"E",templateUrl:"template/composti.html",scope:{compostoOriginal:"=",vm:"="},controller:function(a,b,g,c){function d(b){_.each(a.vm.marchi,function(a){a.i==b&&(markByName=a.n)});return markByName}function f(b){_.each(a.vm.linee,function(a){a.i==b&&(lineByName=a.n)});return lineByName}a.errore={composto:!1};a.$watch("compostoOriginal",function(b){a.composto=angular.copy(b.composto);b=d(a.composto.m);var c=f(a.composto.l);
b=b.replace(/ /g,"_");c=c.replace(/ /g,"_");var e=a.composto.f.replace(/ /g,"_");a.composto.r="../dashboard/archivio_dati/"+b+"/"+c+"/Render/"+(c+"_"+a.composto.c+"C_"+e+".jpg")});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.updateCheck=function(){return!a.composto.c||!a.composto.f||!a.composto.m||!a.composto.l||!a.composto.n||!a.composto.r||isNaN(a.composto.y)};a.deleteCheck=function(){return a.composto.c!==a.compostoOriginal.composto.c||a.composto.m!==a.compostoOriginal.composto.m||
a.composto.l!==a.compostoOriginal.composto.l||a.composto.f!==a.compostoOriginal.composto.f};a.copyCheck=function(){return!a.composto.c||!a.composto.m||!a.composto.l||!a.composto.f||a.composto.c===a.compostoOriginal.composto.c&&a.composto.l===a.compostoOriginal.composto.l&&a.composto.f===a.compostoOriginal.composto.f};a.newItem=function(){c.saving=!1;a.errore.composto=!1;a.compostoOriginal.selected=!1;a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1,m:!1,l:!1,y:1}};a.action=function(e){if("U"==e){var f=
a.composto.c!=a.compostoOriginal.composto.c||a.composto.l!=a.compostoOriginal.composto.l||a.composto.f!=a.compostoOriginal.composto.f?_.findWhere(a.vm.composti,{c:a.composto.c,l:a.composto.l,f:a.composto.f}):!1;f?a.errore.composto=!0:(c.saving=!0,b.post("php/composti.php?type=update",{id:a.composto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,image:a.composto.r,sourceCod:a.compostoOriginal.composto.c,sourceMark:a.compostoOriginal.composto.m,
sourceLine:a.compostoOriginal.composto.l,sourceFin:a.compostoOriginal.composto.f}).success(function(b){a.errore.composto=!1;a.vm.saveCompostoData();console.log("Risposta dalla pagina PHP",b);_.each(a.vm.composti,function(b){b.i==a.composto.i&&(b.m=a.composto.m,b.l=a.composto.l,b.c=a.composto.c,b.f=a.composto.f,b.y=a.composto.y,b.n=a.composto.n,b.r=a.composto.r,a.composto=angular.copy(b))});c.saving=!1;a.errore.composto=!1}).error(function(a,b){console.log(b)}))}"C"==e&&(_.findWhere(a.vm.composti,
{c:a.composto.c,m:a.composto.m,l:a.composto.l,f:a.composto.f})?a.errore.composto=!0:(c.saving=!0,b.post("php/composti.php?type=new",{id:a.vm.nuovoComposto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,image:a.composto.r,sourceCod:a.compostoOriginal.composto.c,sourceMark:a.compostoOriginal.composto.m,sourceLine:a.compostoOriginal.composto.l,sourceFin:a.compostoOriginal.composto.f}).success(function(b){console.log("Risposta dalla pagina PHP",
b);a.vm.copiedComposto={i:a.vm.nuovoComposto.i,m:a.composto.m,l:a.composto.l,c:a.composto.c,f:a.composto.f,y:a.composto.y,n:a.composto.n};a.vm.composti.push(a.vm.copiedComposto);a.vm.nuovoComposto={i:a.vm.nuovoComposto.i+1};a.vm.saveCompostoData();c.saving=!1;a.errore.composto=!1}).error(function(a,b){console.log(b)})));"D"==e&&(c.saving=!0,b.post("php/composti.php?type=delete",{id:a.composto.i,mark:a.composto.m,line:a.composto.l,cod:a.composto.c,fin:a.composto.f,pos:a.composto.y,nome:a.composto.n,
image:a.composto.r}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.composti=_.filter(a.vm.composti,function(b){return b.i!=a.composto.i});a.vm.saveCompostoData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioniProdotti",function(){return{restrict:"E",templateUrl:"template/esposizioniProdotti.html",scope:{esposizioneProdottoOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("esposizioneProdottoOriginal",function(b){a.esposizioneProdotto=angular.copy(b.esposizioneProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("esposizioneProdotto.p",function(b,c){b!=c&&a.esposizioneProdottoOriginal.i==a.esposizioneProdotto&&
(a.esposizioneProdotto.u=!1);if(b){b=_.findWhere(a.vm.prodotti,{i:b});b=_.pluck(b.z,"a");a.tabsAvailable=[];for(c=0;c<b.length;c++){var e=_.findWhere(a.vm.finitureTabelle,{i:b[c]});a.tabsAvailable.push({i:b[c],n:e.n})}return a.tabsAvailable}});a.$watch("esposizioneProdotto.u",function(b,c){b!=c&&a.esposizioneProdottoOriginal.i==a.esposizioneProdotto&&(a.esposizioneProdotto.f=!1);if(b)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:b}),a.finsAvailable});a.newItem=function(){c.saving=!1;a.esposizioneProdotto=
{i:a.vm.nuovoEsposizioneProdotto.i+1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.esposizioneProdotto.c||!a.esposizioneProdotto.p||!a.esposizioneProdotto.l||!a.esposizioneProdotto.j||!a.esposizioneProdotto.u||!a.esposizioneProdotto.f||isNaN(a.esposizioneProdotto.y)||isNaN(a.esposizioneProdotto.q)};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/esposizioniProdotti.php?type=update",{id:a.esposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,
pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,fin:a.esposizioneProdotto.f,tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(b){a.vm.saveEsposizioniProdottiData();_.each(a.vm.esposizioniProdotti,function(b){b.i==a.esposizioneProdotto.i&&(b.c=a.esposizioneProdotto.c,b.p=a.esposizioneProdotto.p,b.l=a.esposizioneProdotto.l,b.j=a.esposizioneProdotto.j,b.m=a.esposizioneProdotto.m,
b.k=a.esposizioneProdotto.k,b.f=a.esposizioneProdotto.f,b.u=a.esposizioneProdotto.u,b.y=a.esposizioneProdotto.y,b.q=a.esposizioneProdotto.q,a.esposizioneProdotto=angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==d&&(c.saving=!0,b.post("php/esposizioniProdotti.php?type=new",{id:a.vm.nuovoEsposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,
fin:a.esposizioneProdotto.f,tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedEsposizioneProdotto={i:a.vm.nuovoEsposizioneProdotto.i,c:a.esposizioneProdotto.c,p:a.esposizioneProdotto.p,l:a.esposizioneProdotto.l,j:a.esposizioneProdotto.j,m:a.esposizioneProdotto.m,k:a.esposizioneProdotto.k,f:a.esposizioneProdotto.f,u:a.esposizioneProdotto.u,y:a.esposizioneProdotto.y,q:a.esposizioneProdotto.q};
a.vm.esposizioniProdotti.push(a.vm.copiedEsposizioneProdotto);a.vm.nuovoEsposizioneProdotto={i:a.vm.nuovoEsposizioneProdotto.i+1};a.vm.saveEsposizioniProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/esposizioniProdotti.php?type=delete",{id:a.esposizioneProdotto.i,comp:a.esposizioneProdotto.c,prd:a.esposizioneProdotto.p,pline:a.esposizioneProdotto.l,cline:a.esposizioneProdotto.j,pmark:a.esposizioneProdotto.m,cmark:a.esposizioneProdotto.k,fin:a.esposizioneProdotto.f,
tab:a.esposizioneProdotto.u,pos:a.esposizioneProdotto.y,qnt:a.esposizioneProdotto.q}).success(function(b){a.vm.esposizioniProdotti=_.filter(a.vm.esposizioniProdotti,function(b){return b.i!=a.esposizioneProdotto.i});a.vm.saveEsposizioniProdottiData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("compostiProdotti",function(){return{restrict:"E",templateUrl:"template/compostiProdotti.html",scope:{compostoProdottoOriginal:"=",vm:"="},controller:function(a,b,g,c){a.$watch("compostoProdottoOriginal",function(b){a.compostoProdotto=angular.copy(b.compostoProdotto)});a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.$watch("compostoProdotto.p",function(b,c){b!=c&&a.compostoProdottoOriginal.i==a.compostoProdotto&&(a.compostoProdotto.u=
!1);if(b){b=_.findWhere(a.vm.prodotti,{i:b});b=_.pluck(b.z,"a");a.tabsAvailable=[];for(c=0;c<b.length;c++){var e=_.findWhere(a.vm.finitureTabelle,{i:b[c]});a.tabsAvailable.push({i:b[c],n:e.n})}return a.tabsAvailable}});a.$watch("compostoProdotto.u",function(b,c){b!=c&&a.compostoProdottoOriginal.i==a.compostoProdotto&&(a.compostoProdotto.f=!1);if(b)return a.finsAvailable=_.where(a.vm.abbinamenti,{u:b}),a.finsAvailable});a.newItem=function(){c.saving=!1;a.compostoProdotto={i:a.vm.nuovoCompostoProdotto.i+
1,c:!1,p:!1,m:!1,k:!1,l:!1,j:!1,u:!1,f:!1,y:1,q:1}};a.updateCheck=function(){return!a.compostoProdotto.c||!a.compostoProdotto.p||!a.compostoProdotto.l||!a.compostoProdotto.j||!a.compostoProdotto.u||!a.compostoProdotto.f||isNaN(a.compostoProdotto.y)||isNaN(a.compostoProdotto.q)};a.action=function(d){"U"==d&&(c.saving=!0,b.post("php/compostiProdotti.php?type=update",{id:a.compostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,
cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(b){a.vm.saveCompostoProdottiData();_.each(a.vm.compostiProdotti,function(b){b.i==a.compostoProdotto.i&&(b.c=a.compostoProdotto.c,b.p=a.compostoProdotto.p,b.l=a.compostoProdotto.l,b.j=a.compostoProdotto.j,b.m=a.compostoProdotto.m,b.k=a.compostoProdotto.k,b.f=a.compostoProdotto.f,b.u=a.compostoProdotto.u,b.y=a.compostoProdotto.y,b.q=a.compostoProdotto.q,a.compostoProdotto=
angular.copy(b))});c.saving=!1}).error(function(a,b){console.log(b)}));"C"==d&&(c.saving=!0,b.post("php/compostiProdotti.php?type=new",{id:a.vm.nuovoCompostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(b){console.log("Risposta dalla pagina PHP",b);a.vm.copiedCompostoProdotto=
{i:a.vm.nuovoCompostoProdotto.i,c:a.compostoProdotto.c,p:a.compostoProdotto.p,l:a.compostoProdotto.l,j:a.compostoProdotto.j,m:a.compostoProdotto.m,k:a.compostoProdotto.k,f:a.compostoProdotto.f,u:a.compostoProdotto.u,y:a.compostoProdotto.y,q:a.compostoProdotto.q};a.vm.compostiProdotti.push(a.vm.copiedCompostoProdotto);a.vm.nuovoCompostoProdotto={i:a.vm.nuovoCompostoProdotto.i+1};a.vm.saveCompostoProdottiData();c.saving=!1}).error(function(a,b){console.log(b)}));"D"==d&&(c.saving=!0,b.post("php/compostiProdotti.php?type=delete",
{id:a.compostoProdotto.i,comp:a.compostoProdotto.c,prd:a.compostoProdotto.p,pline:a.compostoProdotto.l,cline:a.compostoProdotto.j,pmark:a.compostoProdotto.m,cmark:a.compostoProdotto.k,fin:a.compostoProdotto.f,tab:a.compostoProdotto.u,pos:a.compostoProdotto.y,qnt:a.compostoProdotto.q}).success(function(b){a.vm.compostiProdotti=_.filter(a.vm.compostiProdotti,function(b){return b.i!=a.compostoProdotto.i});a.vm.saveCompostoProdottiData();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("esposizioniSettori",function(){return{restrict:"E",templateUrl:"template/esposizioniSettori.html",scope:{esposizioneSettoreOriginal:"=",vm:"="},controller:function(a,b,g,c,d){a.$watch("esposizioneSettoreOriginal",function(b){a.esposizioneSettore=angular.copy(b.esposizioneSettore)});a.saveDataDB=function(){c.saving=!0;b.post("php/esposizioniSettori.php?type=db").success(function(){c.saving=!1;d.esposizioniSettori().then(function(b){a.vm.esposizioniSettori=
b})}).error(function(a,b){console.log(b)})};a.errore={esposizioneSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.convert=function(b,c,d){var e="";_.each(a.vm[c],function(a){a.i==b&&(e=a[d])});return e};a.$watch("esposizioneSettore",function(b){a.esposizioniAvailable=[{c:" Tutti",i:-1},{c:a.convert(a.esposizioneSettore.c,"esposizioni","c")+"_"+a.convert(a.esposizioneSettore.c,"esposizioni","f"),i:a.esposizioneSettore.c}];var c=_.where(a.vm.esposizioni,
{l:a.esposizioneSettore.l});_.each(c,function(c){_.find(a.vm.esposizioniSettori,function(a){return a.c===c.i&&b.l===c.l})||a.esposizioniAvailable.push(c)})});a.$watch("esposizioneSettore.w",function(b){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:b});_.each(a.settoriAvailable,function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.selectedCat=function(b){return-1!=a.esposizioneSettore.h.indexOf(b)};a.toggleSet=function(b){-1==a.esposizioneSettore.h.indexOf(b)?a.esposizioneSettore.h.push(parseInt(b)):
a.esposizioneSettore.h.splice(a.esposizioneSettore.h.indexOf(b),1)};a.updateCheck=function(){return-1==a.esposizioneSettore.c};a.enableUpdate=!1;a.$watchCollection("esposizioneSettore.h",function(b){a.esposizioneSettore.i==a.esposizioneSettoreOriginal.esposizioneSettore.i&&b!=a.esposizioneSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1==a.esposizioneSettore.c||a.esposizioneSettore.c===a.esposizioneSettoreOriginal.esposizioneSettore.c};a.newItem=function(){c.saving=!1;a.errore.esposizioneSettore=
!1;a.esposizioneSettoreOriginal.selected=!1;a.vm.nuovoEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i+1,m:!1,l:!1,c:!1,v:0,h:[]}};a.action=function(f){"U"==f&&(0!=a.esposizioneSettore.h.length?(c.saving=!0,b.post("php/esposizioniSettori.php?type=update",{id:a.esposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,array:a.esposizioneSettore.h,view:a.esposizioneSettore.v}).success(function(b){_.each(a.vm.esposizioniSettori,
function(b,c){b.i==a.esposizioneSettore.i&&(b.c=a.esposizioneSettore.c,b.n=a.esposizioneSettore.n,b.m=a.esposizioneSettore.m,b.l=a.esposizioneSettore.l,b.w=a.esposizioneSettore.w,b.h=a.esposizioneSettore.h,b.v=a.esposizioneSettore.v,a.esposizioneSettore=angular.copy(b))});c.saving=!1;a.errore.esposizioneSettore=!1;a.vm.saveEsposizioneSettoreData()}).error(function(a,b){console.log(b)})):a.errore.esposizioneSettore=!0);"C"==f&&(0!=a.esposizioneSettore.h.length?(c.saving=!0,b.post("php/esposizioniSettori.php?type=new",
{id:a.vm.nuovoEsposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,view:a.esposizioneSettore.v,array:a.esposizioneSettore.h}).success(function(b){a.vm.copiedEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i,c:a.esposizioneSettore.c,n:a.esposizioneSettore.n,m:a.esposizioneSettore.m,l:a.esposizioneSettore.l,w:a.esposizioneSettore.w,v:a.esposizioneSettore.v,h:a.esposizioneSettore.h};a.vm.esposizioniSettori.push(a.vm.copiedEsposizioneSettore);
a.vm.nuovoEsposizioneSettore={i:a.vm.nuovoEsposizioneSettore.i+1};a.vm.saveEsposizioneSettoreData();c.saving=!1;a.errore.esposizioneSettore=!1}).error(function(a,b){console.log(b)})):a.errore.esposizioneSettore=!0);"D"==f&&(c.saving=!0,b.post("php/esposizioniSettori.php?type=delete",{id:a.esposizioneSettore.i,cod:a.esposizioneSettore.c,mark:a.esposizioneSettore.m,line:a.esposizioneSettore.l,nwln:a.esposizioneSettore.w,view:a.esposizioneSettore.v,array:a.esposizioneSettore.h}).success(function(b){-1!=
a.esposizioneSettore.c?(a.vm.esposizioniSettori=_.filter(a.vm.esposizioniSettori,function(b){return b.i!=a.esposizioneSettore.i}),a.vm.saveEsposizioneSettoreData()):a.saveDataDB();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
angular.module("mpuDashboard").directive("compostiSettori",function(){return{restrict:"E",templateUrl:"template/compostiSettori.html",scope:{compostoSettoreOriginal:"=",vm:"="},controller:function(a,b,g,c,d){a.$watch("compostoSettoreOriginal",function(b){a.compostoSettore=angular.copy(b.compostoSettore)});a.saveDataDB=function(){c.saving=!0;b.post("php/compostiSettori.php?type=db").success(function(){c.saving=!1;d.compostiSettori().then(function(b){a.vm.compostiSettori=b})}).error(function(a,b){console.log(b)})};
a.errore={compostoSettore:!1};a.confirm=!1;a.askConfirm=function(){a.confirm=!0;g(function(){a.confirm=!1},4E3)};a.convert=function(b,c,d){var e="";_.each(a.vm[c],function(a){a.i==b&&(e=a[d])});return e};a.$watch("compostoSettore",function(b){a.compostiAvailable=[{c:" Tutti",i:-1},{c:a.convert(a.compostoSettore.c,"composti","c")+"_"+a.convert(a.compostoSettore.c,"composti","f"),i:a.compostoSettore.c}];var c=_.where(a.vm.composti,{l:a.compostoSettore.l});_.each(c,function(c){_.find(a.vm.compostiSettori,
function(a){return a.c===c.i&&b.l===c.l})||a.compostiAvailable.push(c)})});a.$watch("compostoSettore.w",function(b){a.settoriAvailable=_.where(a.vm.lineeSettori,{l:b});_.each(a.settoriAvailable,function(b){b.n=_.findWhere(a.vm.settori,{i:b.h}).n})});a.selectedCat=function(b){return-1!=a.compostoSettore.h.indexOf(b)};a.toggleSet=function(b){-1==a.compostoSettore.h.indexOf(b)?a.compostoSettore.h.push(parseInt(b)):a.compostoSettore.h.splice(a.compostoSettore.h.indexOf(b),1)};a.updateCheck=function(){return-1==
a.compostoSettore.c};a.enableUpdate=!1;a.$watchCollection("compostoSettore.h",function(b){a.compostoSettore.i==a.compostoSettoreOriginal.compostoSettore.i&&b!=a.compostoSettoreOriginal.h&&(a.enableUpdate=!0)});a.copyCheck=function(){return-1==a.compostoSettore.c||a.compostoSettore.c===a.compostoSettoreOriginal.compostoSettore.c};a.newItem=function(){c.saving=!1;a.errore.compostoSettore=!1;a.compostoSettoreOriginal.selected=!1;a.vm.nuovoCompostoSettore={i:a.vm.nuovoCompostoSettore.i+1,m:!1,l:!1,c:!1,
v:0,h:[]}};a.action=function(d){"U"==d&&(0!=a.compostoSettore.h.length?(c.saving=!0,b.post("php/compostiSettori.php?type=update",{id:a.compostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,array:a.compostoSettore.h,view:a.compostoSettore.v}).success(function(b){_.each(a.vm.compostiSettori,function(b,c){b.i==a.compostoSettore.i&&(b.c=a.compostoSettore.c,b.n=a.compostoSettore.n,b.m=a.compostoSettore.m,b.l=a.compostoSettore.l,b.w=a.compostoSettore.w,
b.h=a.compostoSettore.h,b.v=a.compostoSettore.v,a.compostoSettore=angular.copy(b))});c.saving=!1;a.errore.compostoSettore=!1;a.vm.saveCompostoSettoreData()}).error(function(a,b){console.log(b)})):a.errore.compostoSettore=!0);"C"==d&&(0!=a.compostoSettore.h.length?(c.saving=!0,b.post("php/compostiSettori.php?type=new",{id:a.vm.nuovoCompostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,view:a.compostoSettore.v,array:a.compostoSettore.h}).success(function(b){a.vm.copiedCompostoSettore=
{i:a.vm.nuovoCompostoSettore.i,c:a.compostoSettore.c,n:a.compostoSettore.n,m:a.compostoSettore.m,l:a.compostoSettore.l,w:a.compostoSettore.w,v:a.compostoSettore.v,h:a.compostoSettore.h};a.vm.compostiSettori.push(a.vm.copiedCompostoSettore);a.vm.nuovoCompostoSettore={i:a.vm.nuovoCompostoSettore.i+1};a.vm.saveCompostoSettoreData();c.saving=!1;a.errore.compostoSettore=!1}).error(function(a,b){console.log(b)})):a.errore.compostoSettore=!0);"D"==d&&(c.saving=!0,b.post("php/compostiSettori.php?type=delete",
{id:a.compostoSettore.i,cod:a.compostoSettore.c,mark:a.compostoSettore.m,line:a.compostoSettore.l,nwln:a.compostoSettore.w,view:a.compostoSettore.v,array:a.compostoSettore.h}).success(function(b){-1!=a.compostoSettore.c?(a.vm.compostiSettori=_.filter(a.vm.compostiSettori,function(b){return b.i!=a.compostoSettore.i}),a.vm.saveCompostoSettoreData()):a.saveDataDB();a.newItem()}).error(function(a,b){console.log(b)}))}}}});
