angular.module("mpuDashboard").controller("mainCtrl",["$scope","$rootScope","$location","_","$cookies","dataSvc","$timeout","dashboardPages",function(c,b,h,e,d,a,f,g){c.vm={currentPage:1,itemsPerPage:10,maxSize:10,dummy:{image:false},categorie:false,marchi:false,nuovaCategoria:{v:1,r:false},nuovoSettore:{v:1,g:false,r:false,o:0},nuovoMarchio:{v:1,g:[],b:0,s:0},nuovaTbpr:{y:1,m:false},nuovaFinitura:{v:1,p:0,m:false,r:false},nuovaLinea:{a:[false],q:[],v:1,z:2,b:0,y:100,c:0,s:0,e:25,w:2,g:false,r:false,k:false,j:false},nuovaFinituraTabella:{m:false,l:false},nuovoAbbinamento:{m:false,l:false,u:false,f:[{i:false,n:""}]},nuovoProdotto:{m:false,l:false,t:false,a:"",y:1,f:0,z:[{z:"",a:""}]},nuovaLineaSettore:{v:1,p:0,z:1,q:[],m:false,r:false},nuovoProdottoSettore:{m:false,l:false,c:false,h:[]},nuovaVetrina:{m:false,l:false,v:1,y:1},nuovoVetrinaProdotto:{c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1},nuovaEsposizione:{m:false,l:false,t:false,y:1},nuovoEsposizioneProdotto:{c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1},nuovoEsposizioneSettore:{m:false,l:false,c:false,v:0,h:[]},nuovoComposto:{m:false,l:false,y:1},nuovoCompostoProdotto:{c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1},nuovoCompostoSettore:{m:false,l:false,c:false,v:0,h:[]},nuovaNazione:{v:1},nuovaRegione:{z:false},nuovaProvincia:{z:false,r:false,b:0,l:0,t:0,j:1,m:0,k:1},nuovaConvenzione:{},nuovoAgente:{r:false},nuovoRivenditore:{z:false,r:false,p:false,b:0,l:0,t:0,j:1,m:0,k:1,v:false,c:"",h:"",f:"",a:""}};c.vm.ftscroller={scrollbars:true,scrollingX:false,snap:true,momentum:true,hScrollbar:false,updateOnWindowResize:true,updateOnChanges:true};c.filtro={show:"",categoria:{i:false},settore:"",marchio:{i:false,n:""},tbpr:{i:false,n:""},finitura:{i:false,n:"",c:""},linea:{i:false,n:""},newLinea:{i:false,n:""},finituraTabella:{i:false,n:""},abbinamento:{i:false,c:""},lineaSettore:{i:false,n:"",c:""},prodotto:{c:""},prodottoSettore:{n:""},vetrina:{c:""},vetrinaProdotto:{c:"",p:""},esposizione:{c:""},esposizioneProdotto:{e:"",p:""},esposizioneSettore:{c:""},composto:{c:""},compostoProdotto:{c:"",p:""},compostoSettore:{c:""},nazione:{i:""},regione:{n:"",i:""},provincia:{n:""},convenzione:{n:""},rivenditore:{n:""},agente:{r:""}};c.$watch("filtro.marchio.i",function(){c.filtro.linea.n="";c.filtro.linea.i=false});c.errore={marchio:false,tbpr:false,finitura:false,linea:false,finituraTabella:false,abbinamento:false,lineaSettore:false,prodotto:false,prodottoSettore:false,vetrina:false,vetrinaProdotto:false,esposizione:false,esposizioneProdotto:false,composto:false,compostoProdotto:false,regione:false,provincia:false,rivenditore:false,agente:false};b.saving=false;b.changing=false;c.vm.changeLink=function(i){h.path(i.link);c.vm.currentPage=1;c.vm.itemsPerPage=10;c.filtro.show=""};c.$on("$locationChangeSuccess",function(){var i=h.path();switch(true){case i=="/categorie":c.vm.currentLink="categorie";break;case i=="/settori":c.vm.currentLink="settori";break;case i==="/marchi"||i==="/marchiTabelle":c.vm.currentLink="gestione marchi";c.vm.currentSubLink=i.slice(1);break;case i=="/finiture"||i=="/finitureTabelle"||i=="/abbinamenti":c.vm.currentLink="gestione finiture";c.vm.currentSubLink=i.slice(1);break;case i=="/linee"||i=="/lineeSettori":c.vm.currentLink="gestione linee";c.vm.currentSubLink=i.slice(1);break;case i=="/prodotti"||i=="/prodottiSettori":c.vm.currentLink="gestione prodotti";c.vm.currentSubLink=i.slice(1);break;case i=="/esposizioni"||i=="/esposizioniProdotti"||i=="/esposizioniSettori":c.vm.currentLink="gestione esposizioni";c.vm.currentSubLink=i.slice(1);break;case i=="/composti"||i=="/compostiProdotti"||i=="/compostiSettori":c.vm.currentLink="gestione composizioni";c.vm.currentSubLink=i.slice(1);break;case i=="/vetrine"||i=="/vetrineProdotti":c.vm.currentLink="gestione vetrine";c.vm.currentSubLink=i.slice(1);break;case i=="/nazioni"||i=="/regioni"||i=="/province":c.vm.currentLink="mappa";c.vm.currentSubLink=i.slice(1);break;case i=="/rivenditori"||i=="/agenti"||i=="/convenzioni":c.vm.currentLink="distribuzione";c.vm.currentSubLink=i.slice(1);break;default:c.vm.currentLink="home"}});a.categorie().then(function(i){c.vm.categorie=i.data;c.vm.catPerFilter=angular.copy(c.vm.categorie);c.vm.catPerFilter.unshift({i:false,n:" Tutte le categorie"});c.vm.nuovaCategoria.i=e.max(c.vm.categorie,function(j){return j.i}).i+1});a.settori().then(function(i){c.vm.settori=i.data;c.vm.nuovoSettore.i=e.max(c.vm.settori,function(j){return j.i}).i+1});a.marchi().then(function(i){c.vm.marchi=i.data;c.vm.markPerFilter=angular.copy(c.vm.marchi);c.vm.markPerFilter.unshift({i:false,n:" Tutti i marchi"});c.vm.nuovoMarchio.i=e.max(c.vm.marchi,function(j){return j.i}).i+1});a.tbpr().then(function(i){c.vm.tbpr=i.data;c.vm.nuovaTbpr.i=e.max(c.vm.tbpr,function(j){return j.i}).i+1});a.finitureTabelle().then(function(i){c.vm.finitureTabelle=i.data;c.vm.nuovaFinituraTabella.i=e.max(c.vm.finitureTabelle,function(j){return j.i}).i+1});a.finiture().then(function(i){c.vm.finiture=i.data;c.vm.nuovaFinitura.i=e.max(c.vm.finiture,function(j){return j.i}).i+1});a.abbinamenti().then(function(i){c.vm.abbinamenti=i.data;c.vm.nuovoAbbinamento.i=e.max(c.vm.abbinamenti,function(j){return j.i}).i+1});a.prodotti().then(function(i){c.vm.prodotti=i.data;c.vm.nuovoProdotto.i=e.max(c.vm.prodotti,function(j){return j.i}).i+1});a.lineeSettori().then(function(i){c.vm.lineeSettori=i.data;c.vm.nuovaLineaSettore.i=e.max(c.vm.lineeSettori,function(j){return j.i}).i+1});a.prodottiSettori().then(function(i){c.vm.prodottiSettori=i.data;c.vm.nuovoProdottoSettore.i=e.max(c.vm.prodottiSettori,function(j){return j.i}).i+1});a.linee().then(function(i){c.vm.linee=i.data;c.vm.nuovaLinea.i=e.max(c.vm.linee,function(j){return j.i}).i+1});a.vetrine().then(function(i){c.vm.vetrine=i.data;c.vm.nuovaVetrina.i=e.max(c.vm.vetrine,function(j){return j.i}).i+1});a.vetrineProdotti().then(function(i){c.vm.vetrineProdotti=i.data;c.vm.nuovoVetrinaProdotto.i=e.max(c.vm.vetrineProdotti,function(j){return j.i}).i+1});a.esposizioni().then(function(i){c.vm.esposizioni=i.data;c.vm.nuovaEsposizione.i=e.max(c.vm.esposizioni,function(j){return j.i}).i+1});a.esposizioniProdotti().then(function(i){c.vm.esposizioniProdotti=i.data;c.vm.nuovoEsposizioneProdotto.i=e.max(c.vm.esposizioniProdotti,function(j){return j.i}).i+1});a.esposizioniSettori().then(function(i){c.vm.esposizioniSettori=i.data;c.vm.nuovoEsposizioneSettore.i=e.max(c.vm.esposizioniSettori,function(j){return j.i}).i+1});a.composti().then(function(i){c.vm.composti=i.data;c.vm.nuovoComposto.i=e.max(c.vm.composti,function(j){return j.i}).i+1});a.compostiProdotti().then(function(i){c.vm.compostiProdotti=i.data;c.vm.nuovoCompostoProdotto.i=e.max(c.vm.compostiProdotti,function(j){return j.i}).i+1});a.compostiSettori().then(function(i){c.vm.compostiSettori=i.data;c.vm.nuovoCompostoSettore.i=e.max(c.vm.compostiSettori,function(j){return j.i}).i+1});a.nazioni().then(function(i){c.vm.nazioni=i.data;if(c.vm.nazioni.length==0){c.vm.nuovaNazione.i=1}else{c.vm.nuovaNazione.i=e.max(c.vm.nazioni,function(j){return j.i}).i+1}});a.regioni().then(function(i){c.vm.regioni=i.data;if(c.vm.regioni.length==0){c.vm.nuovaRegione.i=1}else{c.vm.nuovaRegione.i=e.max(c.vm.regioni,function(j){return j.i}).i+1}});a.province().then(function(i){c.vm.province=i.data;if(c.vm.province.length==0){c.vm.nuovaProvincia.i=1}else{c.vm.nuovaProvincia.i=e.max(c.vm.province,function(j){return j.i}).i+1}});a.convenzioni().then(function(i){c.vm.convenzioni=i.data;if(c.vm.convenzioni.length==0){c.vm.nuovaConvenzione.i=1}else{c.vm.nuovaConvenzione.i=e.max(c.vm.convenzioni,function(j){return j.i}).i+1}});a.agenti().then(function(i){c.vm.agenti=(i.data)?i.data:[];if(c.vm.agenti.length==0){c.vm.nuovoAgente.i=1}else{c.vm.nuovoAgente.i=e.max(c.vm.agenti,function(j){return j.i}).i+1}});a.rivenditori().then(function(i){c.vm.rivenditori=i.data;c.vm.nuovoRivenditore.i=e.max(c.vm.rivenditori,function(j){return j.i}).i+1});c.sorting=function(i){if(c.vm.sorting==i){c.vm.sorting="-"+i}else{c.vm.sorting=i}};c.convert=function(j,n,m){var o=[];var l="";if(typeof j==="object"){for(var k=0;k<j.length;k++){e.each(c.vm[n],function(i){if(i.i==j[k]){o.push(i[m])}})}return o}else{e.each(c.vm[n],function(i){if(i.i==j){l=i[m]}});return l}};Number.prototype.formatMoney=function(r,p,m){var q=this,r=isNaN(r=Math.abs(r))?2:r,p=p==undefined?".":p,m=m==undefined?",":m,o=q<0?"-":"",l=parseInt(q=Math.abs(+q||0).toFixed(r))+"",k=(k=l.length)>3?k%3:0;return o+(k?l.substr(0,k)+m:"")+l.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+m)+(r?p+Math.abs(q-l).toFixed(r).slice(2):"")};c.convertPrice=function(i){return(i).formatMoney(2,",",".")};c.convertFinType=function(i){return(i==0)?"Finitura":"Rivestimento"};c.convertPriceType=function(i){switch(i){case 1:return"Best price";break;case 2:return"Economico";break;case 3:return"Design";break;case 4:return"Alto design";break;case 5:return"Luxury";break}};c.vm.links=g}]);angular.module("mpuDashboard").controller("categorieCtrl",["$scope","$rootScope","_","dataSvc","$http",function(c,b,d,a,e){c.selectItem=function(f){c.categorie={};c.categorie.selected=true;c.categorie.categoria=f};c.vm.saveCategorieData=function(){b.saving=true;e.post("php/categorie.php?type=save",c.vm.categorie).success(function(){b.saving=false}).error(function(g,f){console.log(f)})};c.saveDataDB=function(){b.saving=true;e.post("php/categorie.php?type=db",c.vm.categorie).success(function(){b.saving=false;a.categorie().then(function(f){c.vm.categorie=f.data})}).error(function(g,f){console.log(f)})};c.updateCheck=function(){return(!c.vm.nuovaCategoria.n||!c.vm.nuovaCategoria.r||!c.vm.nuovaCategoria.x||isNaN(c.vm.nuovaCategoria.y))};c.action=function(f){if(f=="N"){b.saving=true;e.post("php/categorie.php?type=new",{id:c.vm.nuovaCategoria.i,nome:c.vm.nuovaCategoria.n,pos:c.vm.nuovaCategoria.y,show:c.vm.nuovaCategoria.v,image:c.vm.nuovaCategoria.r,text:c.vm.nuovaCategoria.x}).success(function(g){c.vm.categorie.push(c.vm.nuovaCategoria);c.vm.nuovaCategoria={v:1,r:false,i:c.vm.nuovaCategoria.i+1};c.vm.saveCategorieData();b.saving=false}).error(function(h,g){console.log(g)})}}}]);angular.module("mpuDashboard").controller("settoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(c,b,d,a,h,e){c.settori={selected:false};c.selectSettore=function(i){c.settori={};c.settori.selected=true;c.settori.settore=i};c.vm.saveSettoriData=function(){b.saving=true;h.post("php/settori.php?type=save",c.vm.settori).success(function(){b.saving=false}).error(function(j,i){console.log(i)})};c.saveDataDB=function(){b.saving=true;h.post("php/settori.php?type=db").success(function(){b.saving=false;a.settori().then(function(i){c.vm.settori=i.data})}).error(function(j,i){console.log(i)})};var g="",f;c.$watch("input",function(i){if(f){e.cancel(f)}g=i;f=e(function(){c.filtro.settore=g},250)});c.eraseInput=function(i){if(i.keyCode==27){c.input=""}};c.updateCheck=function(){return(!c.vm.nuovoSettore.n||isNaN(c.vm.nuovoSettore.y)||!c.vm.nuovoSettore.g||!c.vm.nuovoSettore.r||!c.vm.nuovoSettore.x)};c.action=function(i){if(i=="N"){b.saving=true;h.post("php/settori.php?type=new",{id:c.vm.nuovoSettore.i,nome:c.vm.nuovoSettore.n,pos:c.vm.nuovoSettore.y,show:c.vm.nuovoSettore.v,cat:c.vm.nuovoSettore.g,image:c.vm.nuovoSettore.r,text:c.vm.nuovoSettore.x,home:c.vm.nuovoSettore.o}).success(function(j){delete c.vm.nuovoSettore.r;c.vm.settori.push(c.vm.nuovoSettore);c.vm.nuovoSettore={v:1,i:c.vm.nuovoSettore.i+1,g:false,r:false,o:0};c.vm.saveSettoriData();b.saving=false}).error(function(k,j){console.log(j)})}}}]);angular.module("mpuDashboard").controller("marchiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.marchi={selected:false};i.vm.sorting="n";i.selectMarchio=function(j){i.marchi={};i.marchi.selected=true;i.marchi.marchio=j};i.vm.saveMarchiData=function(){g.saving=true;f.post("php/marchi.php?type=save",i.vm.marchi).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/marchi.php?type=db",i.vm.marchi).success(function(){g.saving=false;c.marchi().then(function(j){i.vm.marchi=j.data})}).error(function(k,j){console.log(j)})};var d="",b;i.$watch("input",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.marchi=d},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.toggleSet=function(j){if(i.vm.nuovoMarchio.g.indexOf(j)==-1){i.vm.nuovoMarchio.g.push(parseInt(j))}else{i.vm.nuovoMarchio.g.splice(i.vm.nuovoMarchio.g.indexOf(j),1)}};i.checkList=function(j){return(i.vm.nuovoMarchio.g.indexOf(j)!=-1)};i.updateCheck=function(){return(!i.vm.nuovoMarchio.n||i.vm.nuovoMarchio.g.length==0||isNaN(i.vm.nuovoMarchio.b)||isNaN(i.vm.nuovoMarchio.s))};var e=function(){return h.findWhere(i.vm.marchi,{n:i.vm.nuovoMarchio.n})};i.newMarchio=function(){g.saving=false;i.marchi.selected=false;i.vm.nuovoMarchio={v:1,i:i.vm.nuovoMarchio.i+1,g:[],b:0,s:0};i.errore.marchio=false};i.action=function(k){if(k=="N"){if(!e()){g.saving=true;var l=document.getElementsByClassName("categorieCheck");for(var j=0;l[j];++j){if(l[j].checked){l[j].checked=false}}f.post("php/marchi.php?type=new",{id:i.vm.nuovoMarchio.i,nome:i.vm.nuovoMarchio.n,show:i.vm.nuovoMarchio.v,list:i.vm.nuovoMarchio.b,disc:i.vm.nuovoMarchio.s,cat_array:i.vm.nuovoMarchio.g}).success(function(m){i.vm.marchi.push(i.vm.nuovoMarchio);i.newMarchio();i.vm.saveMarchiData()}).error(function(n,m){console.log(m)})}else{i.errore.marchio=true}}}}]);angular.module("mpuDashboard").controller("marchiTabelleCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.tbpr={selected:false};i.vm.sorting=["m","y"];i.selectTbpr=function(j){i.tbpr={};i.tbpr.selected=true;i.tbpr.tbpr=j};i.vm.saveTbprData=function(){g.saving=true;f.post("php/marchiTabelle.php?type=save",i.vm.tbpr).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/marchiTabelle.php?type=db").success(function(){g.saving=false;c.tbpr().then(function(j){i.vm.tbpr=j.data})}).error(function(k,j){console.log(j)})};var d="",b;i.$watch("input",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.tbpr.n=d},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.updateCheck=function(){return(!i.vm.nuovaTbpr.n||isNaN(i.vm.nuovaTbpr.y)||!i.vm.nuovaTbpr.m)};i.newTbpr=function(){g.saving=false;i.errore.tbpr=false;i.vm.nuovaTbpr={i:i.vm.nuovaTbpr.i+1,m:false,y:1}};var e=function(){return h.findWhere(i.vm.tbpr,{n:i.vm.nuovaTbpr.n,m:i.vm.nuovaTbpr.m})};i.action=function(j){if(j=="N"){if(!e()){g.saving=true;f.post("php/marchiTabelle.php?type=new",{id:i.vm.nuovaTbpr.i,nome:i.vm.nuovaTbpr.n,pos:i.vm.nuovaTbpr.y,mark:i.vm.nuovaTbpr.m}).success(function(k){console.log("Risposta dalla pagina PHP",k);i.vm.tbpr.push(i.vm.nuovaTbpr);i.vm.nuovaTbpr={i:i.vm.nuovaTbpr.i+1,m:false};i.vm.saveTbprData();i.newTbpr()}).error(function(l,k){console.log(k)})}else{i.errore.tbpr=true}}}}]);angular.module("mpuDashboard").controller("finitureCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.finitura={selected:false};i.vm.sorting=["m","n"];i.switchType=function(){return(i.vm.nuovaFinitura.p==0)?"finitura":"rivestimento"};i.selectFinitura=function(j){i.finitura={};i.finitura.selected=true;i.finitura.finitura=j};i.vm.saveFinituraData=function(){g.saving=true;f.post("php/finiture.php?type=save",i.vm.finiture).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/finiture.php?type=db").success(function(){g.saving=false;c.finiture().then(function(j){i.vm.finiture=j.data})}).error(function(k,j){console.log(j)})};var d="",b;i.$watch("input",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.finitura.n=d},250)});i.$watch("inputCod",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.finitura.c=d},250)});i.eraseInput=function(k,j){if(k.keyCode==27){(!j)?i.input="":i.inputCod=""}};i.updateCheck=function(){return(!i.vm.nuovaFinitura.n||!i.vm.nuovaFinitura.c||!i.vm.nuovaFinitura.m||!i.vm.nuovaFinitura.r)};var e=function(){return h.findWhere(i.vm.finiture,{n:i.vm.nuovaFinitura.n,c:i.vm.nuovaFinitura.c,m:i.vm.nuovaFinitura.m})};i.newFinitura=function(){g.saving=false;i.errore.finitura=false;i.vm.nuovaFinitura={i:i.vm.nuovaFinitura.i+1,v:1,p:0,m:false,r:false}};i.action=function(j){if(j=="N"){if(!e()){g.saving=true;f.post("php/finiture.php?type=new",{id:i.vm.nuovaFinitura.i,nome:i.vm.nuovaFinitura.n,cod:i.vm.nuovaFinitura.c,show:i.vm.nuovaFinitura.v,mark:i.vm.nuovaFinitura.m,image:i.vm.nuovaFinitura.r,type:i.vm.nuovaFinitura.p}).success(function(k){console.log("Risposta dalla pagina PHP",k);delete i.vm.nuovaFinitura.r;i.vm.finiture.push(i.vm.nuovaFinitura);i.vm.saveFinituraData();i.newFinitura()}).error(function(l,k){console.log(k)})}else{i.errore.finitura=true}}}}]);angular.module("mpuDashboard").controller("lineeCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout","lineeManager",function(j,h,i,c,f,a,g){j.linea={selected:false};j.priceName=[{n:"economico",i:2},{n:"design",i:3},{n:"top class",i:4}];j.vm.sorting=["m","n","y"];j.vm.lineeManager=g;j.selectLinea=function(k){j.linea={};j.linea.selected=true;j.linea.linea=k};j.vm.saveLineaData=function(){h.saving=true;f.post("php/linee.php?type=save",j.vm.linee).success(function(){h.saving=false}).error(function(l,k){console.log(k)})};j.saveDataDB=function(){h.saving=true;f.post("php/linee.php?type=db").success(function(){h.saving=false;c.linee().then(function(k){j.vm.linee=k.data})}).error(function(l,k){console.log(k)})};j.saveDataDB();var d="",b;j.$watch("input",function(k){if(b){a.cancel(b)}d=k;b=a(function(){j.filtro.linea.n=d},250)});j.eraseInput=function(k){if(k.keyCode==27){j.input=""}};j.addLink=function(){j.vm.nuovaLinea.a.push(false)};j.removeLink=function(k){if(j.vm.nuovaLinea.a.length==1){j.vm.nuovaLinea.a=[false]}else{j.vm.nuovaLinea.splice(k,1)}};j.toggleSet=function(k){if(j.vm.nuovaLinea.q.indexOf(k)==-1){j.vm.nuovaLinea.q.push(parseInt(k))}else{j.vm.nuovaLinea.q.splice(j.vm.nuovaLinea.q.indexOf(k),1)}};j.updateCheck=function(){return(!j.vm.nuovaLinea.n||isNaN(j.vm.nuovaLinea.e)||isNaN(j.vm.nuovaLinea.w)||isNaN(j.vm.nuovaLinea.s)||!j.vm.nuovaLinea.m)};var e=function(){return i.findWhere(j.vm.linee,{nome:j.vm.nuovaLinea.n,mark:j.vm.nuovaLinea.m})};j.newLinea=function(){h.saving=false;j.errore.linea=false;j.vm.nuovaLinea={i:j.vm.nuovaLinea.i+1,q:[],a:[false],v:1,z:2,b:0,y:100,c:0,s:0,e:25,w:2,g:false,r:false,k:false,j:false}};j.action=function(k){if(k=="N"){if(!e()){h.saving=true;f.post("php/linee.php?type=new",{id:j.vm.nuovaLinea.i,nome:j.vm.nuovaLinea.n,mark:j.vm.nuovaLinea.m,disc:j.vm.nuovaLinea.s,time:j.vm.nuovaLinea.e,war:j.vm.nuovaLinea.w,ctl:j.vm.nuovaLinea.k,spc:j.vm.nuovaLinea.j,image:j.vm.nuovaLinea.r,show:j.vm.nuovaLinea.v,price:j.vm.nuovaLinea.z,cat:j.vm.nuovaLinea.g,set:j.vm.nuovaLinea.q,link:j.vm.nuovaLinea.a,vtr:j.vm.nuovaLinea.c,pos:j.vm.nuovaLinea.y}).success(function(l){console.log("Risposta dalla pagina PHP",l);j.vm.nuovaLinea.k=(j.vm.nuovaLinea.k)?1:false;j.vm.nuovaLinea.j=(j.vm.nuovaLinea.j)?1:false;j.vm.linee.push(j.vm.nuovaLinea);j.vm.saveLineaData();j.newLinea()}).error(function(m,l){console.log(l)})}else{j.errore.linea=true}}}}]);angular.module("mpuDashboard").controller("finitureTabelleCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.finituraTabella={selected:false};i.vm.sorting=["m","l","n"];i.selectFinituraTabella=function(j){i.finituraTabella={};i.finituraTabella.selected=true;i.finituraTabella.finituraTabella=j};i.vm.saveFinitureTabelleData=function(){g.saving=true;f.post("php/finitureTabelle.php?type=save",i.vm.finitureTabelle).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/finitureTabelle.php?type=db").success(function(j){g.saving=false;c.finitureTabelle().then(function(k){i.vm.finitureTabelle=k.data})}).error(function(k,j){console.log(j)})};var e="",b;i.$watch("input",function(j){if(b){a.cancel(b)}e=j;b=a(function(){i.filtro.finituraTabella.n=e},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.newFinituraTabella=function(){g.saving=false;i.errore.finituraTabella=false;i.vm.nuovaFinituraTabella={i:i.vm.nuovaFinituraTabella.i+1,m:false,l:false}};i.updateCheck=function(){return(!i.vm.nuovaFinituraTabella.n||!i.vm.nuovaFinituraTabella.m||!i.vm.nuovaFinituraTabella.l)};var d=function(){return h.findWhere(i.vm.finitureTabelle,{n:i.vm.nuovaFinituraTabella.n,m:i.vm.nuovaFinituraTabella.m,l:i.vm.nuovaFinituraTabella.l})};i.action=function(j){if(j=="N"){if(!d()){g.saving=true;f.post("php/finitureTabelle.php?type=new",{id:i.vm.nuovaFinituraTabella.i,nome:i.vm.nuovaFinituraTabella.n,line:i.vm.nuovaFinituraTabella.l,mark:i.vm.nuovaFinituraTabella.m}).success(function(k){i.vm.finitureTabelle.push(i.vm.nuovaFinituraTabella);i.vm.saveFinitureTabelleData();i.newFinituraTabella()}).error(function(l,k){console.log(k)})}else{i.errore.finituraTabella=true}}}}]);angular.module("mpuDashboard").controller("abbinamentiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(j,g,i,c,f,a){j.abbinamento={selected:false};j.vm.sorting=["m","l","c"];j.$watch("vm.nuovoAbbinamento.m",function(){j.vm.nuovoAbbinamento.l=false;j.vm.nuovoAbbinamento.u=false;j.vm.nuovoAbbinamento.f=[{i:false,n:""}]});j.$watch("vm.nuovoAbbinamento.l",function(){j.vm.nuovoAbbinamento.u=false;j.vm.nuovoAbbinamento.f=[{i:false,n:""}]});j.$watch("filtro.marchio.i",function(){j.filtro.linea.i=false;j.filtro.finituraTabella.i=false});j.$watch("filtro.linea.i",function(){j.filtro.finituraTabella.i=false});j.addAbbinamento=function(){j.vm.nuovoAbbinamento.f.push({i:false,n:""})};j.removeAbbinamento=function(k){j.vm.nuovoAbbinamento.f.splice(k,1)};j.selectAbbinamento=function(k){j.abbinamento={};j.abbinamento.selected=true;j.abbinamento.abbinamento=k};j.vm.saveAbbinamentiData=function(){g.saving=true;f.post("php/abbinamenti.php?type=save",j.vm.abbinamenti).success(function(){g.saving=false}).error(function(l,k){console.log(k)})};j.saveDataDB=function(){g.saving=true;f.post("php/abbinamenti.php?type=db").success(function(k){console.log(k);g.saving=false;c.abbinamenti().then(function(l){j.vm.abbinamenti=l.data})}).error(function(l,k){console.log(k)})};var e="",b;j.$watch("input",function(k){if(b){a.cancel(b)}e=k;b=a(function(){j.filtro.abbinamento.c=e},250)});j.eraseInput=function(k){if(k.keyCode==27){j.input=""}};j.newAbbinamento=function(){g.saving=false;j.errore.abbinamento=false;j.vm.nuovoAbbinamento={i:j.vm.nuovoAbbinamento.i+1,m:false,l:false,u:false,f:[{i:false,n:""}]}};j.updateCheck=function(){return(!j.vm.nuovoAbbinamento.c||!j.vm.nuovoAbbinamento.u)};function d(){return i.findWhere(j.vm.abbinamenti,{c:j.vm.nuovoAbbinamento.c,l:j.vm.nuovoAbbinamento.l,u:j.vm.nuovoAbbinamento.u})}function h(){var k=i.filter(j.vm.nuovoAbbinamento.f,function(l){return !l.i||!l.n});return k.length}j.action=function(k){if(k=="N"){if(!d()&&h()===0){g.saving=true;f.post("php/abbinamenti.php?type=new",{id:j.vm.nuovoAbbinamento.i,cod:j.vm.nuovoAbbinamento.c,line:j.vm.nuovoAbbinamento.l,mark:j.vm.nuovoAbbinamento.m,abb_array:j.vm.nuovoAbbinamento.f,tab:j.vm.nuovoAbbinamento.u}).success(function(l){j.vm.abbinamenti.push(j.vm.nuovoAbbinamento);j.vm.saveAbbinamentiData();j.newAbbinamento()}).error(function(m,l){console.log(l)})}else{j.errore.abbinamento=true}}}}]);angular.module("mpuDashboard").controller("lineeSettoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout","lineeManager",function(k,i,j,d,g,b,h){k.lineaSettore={selected:false};k.vm.lineeManager=h;k.vm.sorting=["m"];k.selectLineaSettore=function(l){k.lineaSettore={};k.lineaSettore.selected=true;k.lineaSettore.lineaSettore=l};k.vm.saveLineaSettoreData=function(){i.saving=true;g.post("php/lineeSettori.php?type=save",k.vm.lineeSettori).success(function(){i.saving=false}).error(function(m,l){console.log(l)})};k.saveDataDB=function(){i.saving=true;g.post("php/lineeSettori.php?type=db").success(function(){i.saving=false;d.lineeSettori().then(function(l){k.vm.lineeSettori=l.data})}).error(function(m,l){console.log(l)})};k.saveDataDB();var e="",c;k.$watch("input",function(l){if(c){b.cancel(c)}e=l;c=b(function(){k.filtro.lineaSettore.n=e},250)});k.$watch("inputCod",function(l){if(c){b.cancel(c)}e=l;c=b(function(){k.filtro.lineaSettore.c=e},250)});k.toggleSet=function(l){if(k.vm.nuovaLineaSettore.q.indexOf(l)==-1){k.vm.nuovaLineaSettore.q.push(parseInt(l))}else{k.vm.nuovaLineaSettore.q.splice(k.vm.nuovaLineaSettore.q.indexOf(l),1)}};k.checkList=function(l){return(k.vm.nuovaLineaSettore.q.indexOf(l)!=-1)};var a=function(l){return(k.vm.nuovaLineaSettore.length)};k.eraseInput=function(m,l){if(m.keyCode==27){(!l)?k.input="":k.inputCod=""}};k.updateCheck=function(){return(!k.vm.nuovaLineaSettore.h||!k.vm.nuovaLineaSettore.l||!k.vm.nuovaLineaSettore.r)};var f=function(){return j.findWhere(k.vm.lineeSettori,{m:k.vm.nuovaLineaSettore.m,l:k.vm.nuovaLineaSettore.l,h:k.vm.nuovaLineaSettore.h})};k.newItem=function(){i.saving=false;k.errore.lineaSettore=false;k.vm.nuovaLineaSettore={i:k.vm.nuovaLineaSettore.i+1,v:1,p:0,z:1,q:[],m:false,r:false};k.errore.lineaSettore=false};k.action=function(l){if(l=="N"){if(!f()&&a()!=0){i.saving=true;g.post("php/lineeSettori.php?type=new",{id:k.vm.nuovaLineaSettore.i,line:k.vm.nuovaLineaSettore.l,price:k.vm.nuovaLineaSettore.z,show:k.vm.nuovaLineaSettore.v,mark:k.vm.nuovaLineaSettore.m,man:k.vm.nuovaLineaSettore.q,image:k.vm.nuovaLineaSettore.r,set:k.vm.nuovaLineaSettore.h}).success(function(m){console.log("Risposta dalla pagina PHP",m);delete k.vm.nuovaLineaSettore.r;k.vm.lineeSettori.push(k.vm.nuovaLineaSettore);k.vm.saveLineaSettoreData();k.newItem()}).error(function(n,m){console.log(m)})}else{k.errore.lineaSettore=true}}}}]);angular.module("mpuDashboard").controller("prodottiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(j,h,i,c,g,a){j.prodotto={selected:false};j.vm.sorting="c";j.$watch("vm.nuovoProdotto.m",function(){j.vm.nuovoProdotto.l=false;j.vm.nuovoProdotto.u=false;j.vm.nuovoProdotto.t=false;j.vm.nuovoProdotto.x=false;j.vm.nuovoProdotto.z=[{z:"",a:""}]});j.$watch("vm.nuovoProdotto.l",function(){j.vm.nuovoProdotto.u=false;j.vm.nuovoProdotto.t=false;j.vm.nuovoProdotto.x=false;j.vm.nuovoProdotto.z=[{z:"",a:""}]});j.$watch("filtro.marchio.i",function(){j.filtro.linea.i=false});j.addProdotto=function(){j.vm.nuovoProdotto.z.push({z:"",a:""})};j.removeProdotto=function(k){j.vm.nuovoProdotto.z.splice(k,1)};j.selectProdotto=function(k){j.prodotto={};j.prodotto.selected=true;j.prodotto.prodotto=k};j.vm.saveProdottoData=function(){h.saving=true;g.post("php/prodotti.php?type=save",j.vm.prodotti).success(function(){h.saving=false}).error(function(l,k){console.log(k)})};j.saveDataDB=function(){h.saving=true;g.post("php/prodotti.php?type=db").success(function(){h.saving=false;c.prodotti().then(function(k){j.vm.prodotti=k.data})}).error(function(l,k){console.log(k)})};var f="",b;j.$watch("input",function(k){if(b){a.cancel(b)}f=k;b=a(function(){j.filtro.prodotto.c=f},250)});j.eraseInput=function(k){if(k.keyCode==27){j.input=""}};j.updateCheck=function(){return(!j.vm.nuovoProdotto.c||!j.vm.nuovoProdotto.n||!j.vm.nuovoProdotto.m||!j.vm.nuovoProdotto.l||!j.vm.nuovoProdotto.x||!j.vm.nuovoProdotto.t||!j.vm.nuovoProdotto.r)};var e=function(){return i.findWhere(j.vm.prodotti,{c:j.vm.nuovoProdotto.c,l:j.vm.nuovoProdotto.l})};var d=function(){var k=i.filter(j.vm.nuovoProdotto.z,function(l){return isNaN(l.z)||!l.z||!l.a});return k.length};j.newProdotto=function(){h.saving=false;j.errore.prodotto=false;j.vm.nuovoProdotto={i:j.vm.nuovoProdotto.i+1,m:false,l:false,t:false,a:"",y:1,f:0,z:[{z:"",a:""}]}};j.action=function(k){if(k=="N"){if(!e()&&d()===0){h.saving=true;g.post("php/prodotti.php?type=new",{id:j.vm.nuovoProdotto.i,mark:j.vm.nuovoProdotto.m,line:j.vm.nuovoProdotto.l,cod:j.vm.nuovoProdotto.c,title:j.vm.nuovoProdotto.n,tbpr:j.vm.nuovoProdotto.t,dim:j.vm.nuovoProdotto.d,pos:j.vm.nuovoProdotto.y,lnfn:j.vm.nuovoProdotto.x,note:j.vm.nuovoProdotto.o,abb:j.vm.nuovoProdotto.a,fin:j.vm.nuovoProdotto.f,prices:j.vm.nuovoProdotto.z,image:j.vm.nuovoProdotto.r}).success(function(l){console.log("Risposta dalla pagina PHP",l);delete j.vm.nuovoProdotto.r;j.vm.prodotti.push(j.vm.nuovoProdotto);j.vm.saveProdottoData();j.newProdotto()}).error(function(m,l){console.log(l)})}else{j.errore.prodotto=true}}}}]);angular.module("mpuDashboard").controller("prodottiSettoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,d,f,b){i.prodottoSettore={selected:false};i.vm.sorting="n";i.$watch("vm.nuovoProdottoSettore.m",function(){i.vm.nuovoProdottoSettore.l=false;i.vm.nuovoProdottoSettore.w=false;i.vm.nuovoProdottoSettore.c=false});i.$watch("vm.nuovoProdottoSettore.l",function(j){i.vm.nuovoProdottoSettore.c=false});i.$watch("vm.nuovoProdottoSettore.w",function(k){i.settoriAvailable=h.where(i.vm.lineeSettori,{l:k});h.each(i.settoriAvailable,function(l){l.n=h.findWhere(i.vm.settori,{i:l.h}).n});i.prodottiAvailable=[{c:" Tutti",i:-1}];var j=h.where(i.vm.prodotti,{l:i.vm.nuovoProdottoSettore.l});h.each(j,function(l){if(!h.find(i.vm.prodottiSettori,function(m){return(m.c===l.i&&k===l.l)})){i.prodottiAvailable.push(l)}})});i.$watch("vm.nuovoProdottoSettore.c",function(j){if(j&&j!=-1){var k=h.find(i.vm.prodotti,function(l){return l.i==j});i.vm.nuovoProdottoSettore.n=k.c}});i.toggleSet=function(j){if(i.vm.nuovoProdottoSettore.h.indexOf(j)==-1){i.vm.nuovoProdottoSettore.h.push(parseInt(j))}else{i.vm.nuovoProdottoSettore.h.splice(i.vm.nuovoProdottoSettore.h.indexOf(j),1)}};i.selectProdottoSettore=function(j){i.prodottoSettore={};i.prodottoSettore.selected=true;i.prodottoSettore.prodottoSettore=j};i.vm.saveProdottoSettoreData=function(){g.saving=true;f.post("php/prodottiSettori.php?type=save",i.vm.prodottiSettori).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/prodottiSettori.php?type=db").success(function(){g.saving=false;d.prodottiSettori().then(function(j){i.vm.prodottiSettori=j.data})}).error(function(k,j){console.log(j)})};var e="",c;i.$watch("input",function(j){if(c){b.cancel(c)}e=j;c=b(function(){i.filtro.prodottoSettore.n=e},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.newProdottoSettore=function(j){g.saving=false;i.errore.prodottoSettore=false;i.vm.nuovoProdottoSettore={m:false,l:false,c:false,h:[]};i.vm.nuovoProdottoSettore.i=(!j)?i.vm.nuovoProdottoSettore.i+1:parseInt(j)+1;console.log(i.vm.nuovoProdottoSettore.i)};i.updateCheck=function(){return(!i.vm.nuovoProdottoSettore.m||!i.vm.nuovoProdottoSettore.l||!i.vm.nuovoProdottoSettore.w||!i.vm.nuovoProdottoSettore.c)};function a(){return i.vm.nuovoProdottoSettore.h.length}i.action=function(j){if(j=="N"){if(a()!=0){g.saving=true;f.post("php/prodottiSettori.php?type=new",{id:i.vm.nuovoProdottoSettore.i,mark:i.vm.nuovoProdottoSettore.m,line:i.vm.nuovoProdottoSettore.l,nwln:i.vm.nuovoProdottoSettore.w,array:i.vm.nuovoProdottoSettore.h,cod:i.vm.nuovoProdottoSettore.c}).success(function(k){console.log("Risposta dalla pagina PHP",k);if(i.vm.nuovoProdottoSettore.c!=-1){i.vm.prodottiSettori.push(i.vm.nuovoProdottoSettore);i.vm.saveProdottoSettoreData()}else{i.saveDataDB()}i.newProdottoSettore(k)}).error(function(l,k){console.log(k)})}else{i.errore.prodottoSettore=true}}}}]);angular.module("mpuDashboard").controller("vetrineCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,e,a){i.vetrina={selected:false};i.selectVetrina=function(j){i.vetrina={};i.vetrina.selected=true;i.vetrina.vetrina=j};i.vm.sorting="c";i.toggleSet=function(j){if(i.vm.nuovaVetrina.h.indexOf(j)==-1){i.vm.nuovaVetrina.h.push(parseInt(j))}else{i.vm.nuovaVetrina.h.splice(i.vm.nuovaVetrina.h.indexOf(j),1)}};i.$watch("vm.nuovaVetrina.m",function(){i.vm.nuovaVetrina.l=false;i.vm.nuovaVetrina.h=[]});i.$watch("vm.nuovaVetrina.l",function(){i.vm.nuovaVetrina.h=[]});i.vm.saveVetrinaData=function(){g.saving=true;e.post("php/vetrine.php?type=save",i.vm.vetrine).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;e.post("php/vetrine.php?type=db").success(function(){g.saving=false;c.vetrine().then(function(j){i.vm.vetrine=j.data})}).error(function(k,j){console.log(j)})};var d="",b;i.$watch("input",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.vetrina.c=d},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.updateCheck=function(){return(!i.vm.nuovaVetrina.c||!i.vm.nuovaVetrina.n||!i.vm.nuovaVetrina.m||!i.vm.nuovaVetrina.l||!i.vm.nuovaVetrina.r||isNaN(i.vm.nuovaVetrina.y))};var f=function(){return h.findWhere(i.vm.vetrine,{c:i.vm.nuovaVetrina.c,l:i.vm.nuovaVetrina.l})};i.newVetrina=function(){g.saving=false;i.errore.vetrina=false;i.vm.nuovaVetrina={i:i.vm.nuovaVetrina.i+1,m:false,l:false,y:1,v:1}};i.action=function(j){if(j=="N"){if(!f()){g.saving=true;e.post("php/vetrine.php?type=new",{id:i.vm.nuovaVetrina.i,mark:i.vm.nuovaVetrina.m,line:i.vm.nuovaVetrina.l,cod:i.vm.nuovaVetrina.c,title:i.vm.nuovaVetrina.n,pos:i.vm.nuovaVetrina.y,show:i.vm.nuovaVetrina.v,note:i.vm.nuovaVetrina.o,image:i.vm.nuovaVetrina.r}).success(function(k){console.log("Risposta dalla pagina PHP",k);delete i.vm.nuovaVetrina.r;i.vm.vetrine.push(i.vm.nuovaVetrina);i.vm.saveVetrinaData();i.newVetrina()}).error(function(l,k){console.log(k)})}else{i.errore.vetrina=true}}}}]);angular.module("mpuDashboard").controller("vetrineProdottiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(c,b,d,a,h,e){c.vetrinaProdotto={selected:false};c.vm.sorting=["y","j","c"];c.$watch("vm.nuovoVetrinaProdotto.k",function(i){c.vm.nuovoVetrinaProdotto.m=i;c.vm.nuovoVetrinaProdotto.j=false});c.$watch("vm.nuovoVetrinaProdotto.j",function(i){c.vm.nuovoVetrinaProdotto.l=i;c.vm.nuovoVetrinaProdotto.c=false});c.$watch("vm.nuovoVetrinaProdotto.m",function(){c.vm.nuovoVetrinaProdotto.l=false});c.$watch("vm.nuovoVetrinaProdotto.l",function(){c.vm.nuovoVetrinaProdotto.p=false});c.$watch("vm.nuovoVetrinaProdotto.p",function(k){if(k){var n=d.findWhere(c.vm.prodotti,{i:k});var j=d.pluck(n.z,"a");c.tabsAvailable=[];for(var l=0;l<j.length;l++){var m=d.findWhere(c.vm.finitureTabelle,{i:j[l]});c.tabsAvailable.push({i:j[l],n:m.n})}return c.tabsAvailable}else{c.vm.nuovoVetrinaProdotto.u=false}});c.$watch("vm.nuovoVetrinaProdotto.u",function(i){if(i){c.finsAvailable=d.where(c.vm.abbinamenti,{u:i});return c.finsAvailable}else{c.vm.nuovoVetrinaProdotto.f=false}});c.selectVetrinaProdotto=function(i){c.vetrinaProdotto={};c.vetrinaProdotto.selected=true;c.vetrinaProdotto.vetrinaProdotto=i};c.vm.saveVetrineProdottiData=function(){b.saving=true;h.post("php/vetrineProdotti.php?type=save",c.vm.vetrineProdotti).success(function(){b.saving=false}).error(function(j,i){console.log(i)})};c.saveDataDB=function(){b.saving=true;h.post("php/vetrineProdotti.php?type=db").success(function(){b.saving=false;a.vetrineProdotti().then(function(i){c.vm.vetrineProdotti=i.data})}).error(function(j,i){console.log(i)})};var g="",f;c.$watch("input",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g||g!=""){var j=[];d.each(c.vm.vetrine,function(k){if(k.c==g){j.push(k.i)}});c.filtro.vetrinaProdotto.c=j}else{c.filtro.vetrinaProdotto.c=false}},250)});c.$watch("inputCod",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g){g=g.toUpperCase()}if(g!=""){var j=d.findWhere(c.vm.prodotti,{c:g});if(j){c.filtro.vetrinaProdotto.p=j.i}}else{c.filtro.vetrinaProdotto.p=false}},250)});c.eraseInput=function(j,i){if(j.keyCode==27){(!i)?c.input="":c.inputCod=""}};c.newVetrinaProdotto=function(){b.saving=false;c.errore.vetrinaProdotto=false;c.vm.nuovoVetrinaProdotto={i:c.vm.nuovoVetrinaProdotto.i+1,c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1}};c.updateCheck=function(){return(!c.vm.nuovoVetrinaProdotto.c||!c.vm.nuovoVetrinaProdotto.p||!c.vm.nuovoVetrinaProdotto.l||!c.vm.nuovoVetrinaProdotto.j||!c.vm.nuovoVetrinaProdotto.u||!c.vm.nuovoVetrinaProdotto.f||isNaN(c.vm.nuovoVetrinaProdotto.y)||isNaN(c.vm.nuovoVetrinaProdotto.q))};c.action=function(i){if(i=="N"){b.saving=true;h.post("php/vetrineProdotti.php?type=new",{id:c.vm.nuovoVetrinaProdotto.i,comp:c.vm.nuovoVetrinaProdotto.c,prd:c.vm.nuovoVetrinaProdotto.p,pline:c.vm.nuovoVetrinaProdotto.l,cline:c.vm.nuovoVetrinaProdotto.j,pmark:c.vm.nuovoVetrinaProdotto.m,cmark:c.vm.nuovoVetrinaProdotto.k,fin:c.vm.nuovoVetrinaProdotto.f,tab:c.vm.nuovoVetrinaProdotto.u,pos:c.vm.nuovoVetrinaProdotto.y,qnt:c.vm.nuovoVetrinaProdotto.q}).success(function(j){c.vm.vetrineProdotti.push(c.vm.nuovoVetrinaProdotto);c.vm.saveVetrineProdottiData();c.newVetrinaProdotto()}).error(function(k,j){console.log(j)})}}}]);angular.module("mpuDashboard").controller("nazioniCtrl",["$scope","$rootScope","_","dataSvc","$http",function(c,b,d,a,e){c.vm.saveNazioniData=function(){b.saving=true;e.post("php/nazioni.php?type=save",c.vm.nazioni).success(function(){b.saving=false}).error(function(g,f){console.log(f)})};c.saveDataDB=function(){b.saving=true;e.post("php/nazioni.php?type=db",c.vm.nazioni).success(function(){b.saving=false;a.nazioni().then(function(f){c.vm.nazioni=f.data})}).error(function(g,f){console.log(f)})};c.updateCheck=function(){return(!c.vm.nuovaNazione.n||!c.vm.nuovaNazione.x)};c.action=function(f){if(f=="N"){b.saving=true;e.post("php/nazioni.php?type=new",{id:c.vm.nuovaNazione.i,nome:c.vm.nuovaNazione.n,show:c.vm.nuovaNazione.v,prx:c.vm.nuovaNazione.x}).success(function(g){c.vm.nazioni.push(c.vm.nuovaNazione);c.vm.nuovaNazione={v:1,i:c.vm.nuovaNazione.i+1};c.vm.saveNazioniData();b.saving=false}).error(function(h,g){console.log(g)})}}}]);angular.module("mpuDashboard").controller("regioniCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.vm.sorting="n";i.regione={selected:false};i.selectRegione=function(j){i.regione={};i.regione.selected=true;i.regione.regione=j};i.vm.saveRegioniData=function(){g.saving=true;f.post("php/regioni.php?type=save",i.vm.regioni).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/regioni.php?type=db",i.vm.regioni).success(function(){g.saving=false;c.regioni().then(function(j){i.vm.regioni=j.data})}).error(function(k,j){console.log(j)})};i.updateCheck=function(){return(!i.vm.nuovaRegione.n||!i.vm.nuovaRegione.z)};var e=function(){return h.findWhere(i.vm.regioni,{n:i.vm.nuovaRegione.n,z:i.vm.nuovaRegione.z})};i.newItem=function(){g.saving=false;i.regione.selected=false;i.errore.regione=false;i.vm.nuovaRegione={i:i.vm.nuovaRegione.i+1,z:false}};var d="",b;i.$watch("input",function(j){if(b){a.cancel(b)}d=j;b=a(function(){i.filtro.regione.n=d},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.action=function(j){if(j=="N"){if(!e()){g.saving=true;f.post("php/regioni.php?type=new",{id:i.vm.nuovaRegione.i,nome:i.vm.nuovaRegione.n,nazione:i.vm.nuovaRegione.z}).success(function(k){i.vm.regioni.push(i.vm.nuovaRegione);i.newItem();i.vm.saveRegioniData()}).error(function(l,k){console.log(k)})}else{i.errore.regione=true}}}}]);angular.module("mpuDashboard").controller("provinceCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout","priceManager",function(j,h,i,d,g,b,a){j.vm.sorting=["z","r","n"];j.provincia={selected:false};j.vm.priceManager=a;j.$watch("filtro.nazione.i",function(k){j.filtro.regione.i=false});j.selectItem=function(k){j.provincia={};j.provincia.selected=true;j.provincia.provincia=k};j.vm.saveProvinceData=function(){h.saving=true;g.post("php/province.php?type=save",j.vm.province).success(function(){h.saving=false}).error(function(l,k){console.log(k)})};j.saveDataDB=function(){h.saving=true;g.post("php/province.php?type=db",j.vm.province).success(function(){h.saving=false;d.province().then(function(k){j.vm.province=k.data})}).error(function(l,k){console.log(k)})};j.updateCheck=function(){return(!j.vm.nuovaProvincia.n||!j.vm.nuovaProvincia.z)};var f=function(){return i.findWhere(j.vm.province,{n:j.vm.nuovaProvincia.n,c:j.vm.nuovaProvincia.c,z:j.vm.nuovaProvincia.z,r:j.vm.nuovaProvincia.r})};j.newItem=function(){h.saving=false;j.provincia.selected=false;j.errore.provincia=false;j.vm.nuovaProvincia={i:j.vm.nuovaProvincia.i+1,z:false,r:false,b:0,l:0,t:0,j:1,m:0,k:1}};var e="",c;j.$watch("input",function(k){if(c){b.cancel(c)}e=k;c=b(function(){j.filtro.provincia.n=e},250)});j.eraseInput=function(k){if(k.keyCode==27){j.input=""}};j.action=function(k){if(k=="N"){if(!f()){h.saving=true;g.post("php/province.php?type=new",{id:j.vm.nuovaProvincia.i,nome:j.vm.nuovaProvincia.n,sigla:j.vm.nuovaProvincia.c,nazione:j.vm.nuovaProvincia.z,regione:j.vm.nuovaProvincia.r,trasporto:j.vm.nuovaProvincia.t,trasporto_type:j.vm.nuovaProvincia.j,montaggio:j.vm.nuovaProvincia.m,montaggio_type:j.vm.nuovaProvincia.k,limite:j.vm.nuovaProvincia.l,minimo:j.vm.nuovaProvincia.b}).success(function(l){console.log("Risposta dalla pagina PHP",l);j.vm.province.push(j.vm.nuovaProvincia);j.newItem();j.vm.saveProvinceData()}).error(function(m,l){console.log(l)})}else{j.errore.provincia=true}}}}]);angular.module("mpuDashboard").controller("convenzioniCtrl",["$scope","$rootScope","_","dataSvc","$http",function(c,b,d,a,e){c.vm.saveConvenzioniData=function(){b.saving=true;e.post("php/convenzioni.php?type=save",c.vm.convenzioni).success(function(){b.saving=false}).error(function(g,f){console.log(f)})};c.saveDataDB=function(){b.saving=true;e.post("php/convenzioni.php?type=db",c.vm.convenzioni).success(function(){b.saving=false;a.convenzioni().then(function(f){c.vm.convenzioni=f.data})}).error(function(g,f){console.log(f)})};c.updateCheck=function(){return(!c.vm.nuovaConvenzione.n)};c.action=function(f){if(f=="N"){b.saving=true;e.post("php/convenzioni.php?type=new",{id:c.vm.nuovaConvenzione.i,nome:c.vm.nuovaConvenzione.n,email:c.vm.nuovaConvenzione.e}).success(function(g){c.vm.convenzioni.push(c.vm.nuovaConvenzione);c.vm.nuovaConvenzione={i:c.vm.nuovaConvenzione.i+1};c.vm.saveConvenzioniData();b.saving=false}).error(function(h,g){console.log(g)})}}}]);angular.module("mpuDashboard").controller("agentiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(c,b,d,a,h,e){c.vm.sorting="n";c.agente={selected:false};c.selectItem=function(i){c.agente={};c.agente.selected=true;c.agente.agente=i};c.vm.saveAgentiData=function(){b.saving=true;h.post("php/agenti.php?type=save",c.vm.agenti).success(function(){b.saving=false}).error(function(j,i){console.log(i)})};c.saveDataDB=function(){b.saving=true;h.post("php/agenti.php?type=db",c.vm.agenti).success(function(){b.saving=false;a.agenti().then(function(i){c.vm.agenti=i.data})}).error(function(j,i){console.log(i)})};var g="",f;c.$watch("input",function(i){if(f){e.cancel(f)}g=i;f=e(function(){c.filtro.agente.n=g},250)});c.eraseInput=function(i){if(i.keyCode==27){c.input=""}};c.updateCheck=function(){return(!c.vm.nuovoAgente.n||!c.vm.nuovoAgente.e||!c.vm.nuovoAgente.p||!c.vm.nuovoAgente.r||!c.vm.nuovoAgente.t)};c.newItem=function(){b.saving=false;c.vm.nuovoAgente={i:c.vm.nuovoAgente.i+1,r:false}};c.action=function(i){if(i=="N"){b.saving=true;h.post("php/agenti.php?type=new",{id:c.vm.nuovoAgente.i,nome:c.vm.nuovoAgente.n,email:c.vm.nuovoAgente.e,password:c.vm.nuovoAgente.p,tel:c.vm.nuovoAgente.t,riv:c.vm.nuovoAgente.r}).success(function(j){c.vm.agenti.push(c.vm.nuovoAgente);c.vm.saveAgentiData();c.newItem();b.saving=false}).error(function(k,j){console.log(j)})}}}]);angular.module("mpuDashboard").controller("rivenditoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout","priceManager",function(k,i,j,e,h,b,a){k.rivenditore={selected:false};k.vm.priceManager=a;k.vm.sorting=["n"];k.switchType=function(){return(k.vm.nuovoRivenditore.p==0)?"rivenditore":"rivestimento"};k.selectItem=function(m){k.rivenditore={};k.rivenditore.selected=true;k.rivenditore.rivenditore=m};k.vm.saveRivenditoreData=function(){i.saving=true;h.post("php/rivenditori.php?type=save",k.vm.rivenditori).success(function(){i.saving=false}).error(function(n,m){console.log(m)})};k.saveDataDB=function(){i.saving=true;h.post("php/rivenditori.php?type=db").success(function(){i.saving=false;e.rivenditori().then(function(m){k.vm.rivenditori=m.data})}).error(function(n,m){console.log(m)})};k.openMarchi=function(){k.vm.mv=!k.vm.mv};var d=function(){k.vm.mv=false;k.vm.nuovoRivenditore.y=angular.copy(k.vm.marchi);j.each(k.vm.nuovoRivenditore.y,function(m){m.s=0;m.d=0;delete m.n;delete m.b;delete m.g});return k.vm.nuovoRivenditore.y};d();var g="",c;k.$watch("input",function(m){if(c){b.cancel(c)}g=m;c=b(function(){k.filtro.rivenditore.n=g},250)});k.eraseInput=function(m){if(m.keyCode==27){k.input=""}};k.$watch("vm.nuovoRivenditore.v",function(m){if(m){k.vm.nuovoRivenditore.z=false;k.vm.nuovoRivenditore.r=false;k.vm.nuovoRivenditore.p=false}});k.updateCheck=function(){return(((!k.vm.nuovoRivenditore.z||!k.vm.nuovoRivenditore.r||!k.vm.nuovoRivenditore.p)&&!k.vm.nuovoRivenditore.v)||!k.vm.nuovoRivenditore.n||!k.vm.nuovoRivenditore.x||!k.vm.nuovoRivenditore.s||(!k.vm.nuovoRivenditore.h&&!k.vm.nuovoRivenditore.c)||!k.vm.nuovoRivenditore.e||!k.vm.nuovoRivenditore.w||!k.vm.nuovoRivenditore.g)};var f=function(){if(k.vm.nuovoRivenditore.p){return j.findWhere(k.vm.rivenditori,{p:k.vm.nuovoRivenditore.p})}else{return false}};k.newItem=function(){i.saving=false;k.errore.rivenditore=false;k.vm.nuovoRivenditore={i:k.vm.nuovoRivenditore.i+1,z:false,r:false,p:false,b:0,l:0,t:0,j:1,m:0,k:1,v:false,c:"",h:"",f:"",a:""};d()};var l=[];k.showInfoFnc=function(n,o){if(o=="add"){l.push(n)}else{var m=l.indexOf(n);l.splice(m,1)}};k.checkShowInfo=function(m){return l.indexOf(m)};k.action=function(m){if(m=="N"){if(!f()){i.saving=true;h.post("php/rivenditori.php?type=new",{id:k.vm.nuovoRivenditore.i,nome:k.vm.nuovoRivenditore.n,naz:k.vm.nuovoRivenditore.z,reg:k.vm.nuovoRivenditore.r,prov:k.vm.nuovoRivenditore.p,conv:k.vm.nuovoRivenditore.v,rif:k.vm.nuovoRivenditore.x,sede:k.vm.nuovoRivenditore.s,tel:k.vm.nuovoRivenditore.h,fax:k.vm.nuovoRivenditore.f,cell:k.vm.nuovoRivenditore.c,web:k.vm.nuovoRivenditore.q,email:k.vm.nuovoRivenditore.e,psw:k.vm.nuovoRivenditore.w,limite:k.vm.nuovoRivenditore.l,minimo:k.vm.nuovoRivenditore.b,trasporto:k.vm.nuovoRivenditore.t,trasporto_type:k.vm.nuovoRivenditore.j,montaggio:k.vm.nuovoRivenditore.m,montaggio_type:k.vm.nuovoRivenditore.k,mark:k.vm.nuovoRivenditore.y,notes:k.vm.nuovoRivenditore.a,image:k.vm.nuovoRivenditore.g}).success(function(n){console.log("Risposta dalla pagina PHP",n);delete k.vm.nuovoRivenditore.g;k.vm.rivenditori.push(k.vm.nuovoRivenditore);k.vm.saveRivenditoreData();k.newItem()}).error(function(o,n){console.log(n)})}else{k.errore.rivenditore=true}}}}]);angular.module("mpuDashboard").controller("esposizioniCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.esposizione={selected:false};i.selectItem=function(j){i.esposizione={};i.esposizione.selected=true;i.esposizione.esposizione=j};i.vm.sorting=["l","c","f"];i.$watch("vm.nuovaEsposizione.l",function(j){i.settoriAvailable=h.where(i.vm.lineeSettori,{l:j});h.each(i.settoriAvailable,function(k){k.n=h.findWhere(i.vm.settori,{i:k.h}).n})});i.$watch("vm.nuovaEsposizione.m",function(){i.vm.nuovaEsposizione.l=false;i.vm.nuovaEsposizione.t=false});i.$watch("vm.nuovaEsposizione.l",function(){i.vm.nuovaEsposizione.t=false});i.vm.saveEsposizioneData=function(){g.saving=true;f.post("php/esposizioni.php?type=save",i.vm.esposizioni).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/esposizioni.php?type=db").success(function(){g.saving=false;c.esposizioni().then(function(j){i.vm.esposizioni=j.data})}).error(function(k,j){console.log(j)})};i.saveDataDB();var e="",b;i.$watch("input",function(j){if(b){a.cancel(b)}e=j;b=a(function(){i.filtro.esposizione.c=e},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.updateCheck=function(){return(!i.vm.nuovaEsposizione.c||!i.vm.nuovaEsposizione.f||!i.vm.nuovaEsposizione.m||!i.vm.nuovaEsposizione.l||!i.vm.nuovaEsposizione.t||!i.vm.nuovaEsposizione.r||isNaN(i.vm.nuovaEsposizione.y))};var d=function(){return h.findWhere(i.vm.esposizioni,{c:i.vm.nuovaEsposizione.c,f:i.vm.nuovaEsposizione.f,l:i.vm.nuovaEsposizione.l})};i.newItem=function(){g.saving=false;i.errore.esposizione=false;i.vm.nuovaEsposizione={i:i.vm.nuovaEsposizione.i+1,m:false,l:false,t:false,y:1}};i.action=function(j){if(j=="N"){if(!d()){g.saving=true;f.post("php/esposizioni.php?type=new",{id:i.vm.nuovaEsposizione.i,mark:i.vm.nuovaEsposizione.m,line:i.vm.nuovaEsposizione.l,tbpr:i.vm.nuovaEsposizione.t,cod:i.vm.nuovaEsposizione.c,fin:i.vm.nuovaEsposizione.f,dim:i.vm.nuovaEsposizione.d,pos:i.vm.nuovaEsposizione.y,nome:i.vm.nuovaEsposizione.n,image:i.vm.nuovaEsposizione.r}).success(function(k){delete i.vm.nuovaEsposizione.r;i.vm.esposizioni.push(i.vm.nuovaEsposizione);i.vm.saveEsposizioneData();i.newItem()}).error(function(l,k){console.log(k)})}else{i.errore.esposizione=true}}}}]);angular.module("mpuDashboard").controller("compostiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,c,f,a){i.composto={selected:false};i.selectItem=function(j){i.composto={};i.composto.selected=true;i.composto.composto=j};i.vm.sorting=["l","c","f"];i.$watch("vm.nuovoComposto.m",function(){i.vm.nuovoComposto.l=false});i.vm.saveCompostoData=function(){g.saving=true;f.post("php/composti.php?type=save",i.vm.composti).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/composti.php?type=db").success(function(){g.saving=false;c.composti().then(function(j){i.vm.composti=j.data})}).error(function(k,j){console.log(j)})};i.saveDataDB();var e="",b;i.$watch("input",function(j){if(b){a.cancel(b)}e=j;b=a(function(){i.filtro.composto.c=e},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.updateCheck=function(){return(!i.vm.nuovoComposto.c||!i.vm.nuovoComposto.f||!i.vm.nuovoComposto.m||!i.vm.nuovoComposto.l||!i.vm.nuovoComposto.n||!i.vm.nuovoComposto.r||isNaN(i.vm.nuovoComposto.y))};var d=function(){return h.findWhere(i.vm.composti,{c:i.vm.nuovoComposto.c,f:i.vm.nuovoComposto.f,l:i.vm.nuovoComposto.l})};i.newItem=function(){g.saving=false;i.errore.composto=false;i.vm.nuovoComposto={i:i.vm.nuovoComposto.i+1,m:false,l:false,y:1}};i.action=function(j){if(j=="N"){if(!d()){g.saving=true;f.post("php/composti.php?type=new",{id:i.vm.nuovoComposto.i,mark:i.vm.nuovoComposto.m,line:i.vm.nuovoComposto.l,cod:i.vm.nuovoComposto.c,fin:i.vm.nuovoComposto.f,pos:i.vm.nuovoComposto.y,nome:i.vm.nuovoComposto.n,image:i.vm.nuovoComposto.r}).success(function(k){console.log("Risposta dalla pagina PHP",k);delete i.vm.nuovoComposto.r;i.vm.composti.push(i.vm.nuovoComposto);i.vm.saveCompostoData();i.newItem()}).error(function(l,k){console.log(k)})}else{i.errore.composto=true}}}}]);angular.module("mpuDashboard").controller("esposizioniProdottiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(c,b,d,a,h,e){c.esposizioneProdotto={selected:false};c.vm.sorting=["j","e","c"];c.$watch("vm.nuovoEsposizioneProdotto.k",function(i){c.vm.nuovoEsposizioneProdotto.m=i;c.vm.nuovoEsposizioneProdotto.j=false});c.$watch("vm.nuovoEsposizioneProdotto.j",function(i){c.vm.nuovoEsposizioneProdotto.l=i;c.vm.nuovoEsposizioneProdotto.c=false});c.$watch("vm.nuovoEsposizioneProdotto.m",function(){c.vm.nuovoEsposizioneProdotto.l=false});c.$watch("vm.nuovoEsposizioneProdotto.l",function(){c.vm.nuovoEsposizioneProdotto.p=false});c.$watch("vm.nuovoEsposizioneProdotto.p",function(k){if(k){var n=d.findWhere(c.vm.prodotti,{i:k});var j=d.pluck(n.z,"a");c.tabsAvailable=[];for(var l=0;l<j.length;l++){var m=d.findWhere(c.vm.finitureTabelle,{i:j[l]});c.tabsAvailable.push({i:j[l],n:m.n})}return c.tabsAvailable}else{c.vm.nuovoEsposizioneProdotto.u=false}});c.$watch("vm.nuovoEsposizioneProdotto.u",function(i){if(i){c.finsAvailable=d.where(c.vm.abbinamenti,{u:i});return c.finsAvailable}else{c.vm.nuovoEsposizioneProdotto.f=false}});c.selectItem=function(i){c.esposizioneProdotto={};c.esposizioneProdotto.selected=true;c.esposizioneProdotto.esposizioneProdotto=i};c.vm.saveEsposizioniProdottiData=function(){b.saving=true;h.post("php/esposizioniSettori.php?type=save",c.vm.esposizioniSettori).success(function(){b.saving=false}).error(function(j,i){console.log(i)})};c.saveDataDB=function(){b.saving=true;h.post("php/esposizioniSettori.php?type=db").success(function(){b.saving=false;a.esposizioniSettori().then(function(i){c.vm.esposizioniSettori=i.data})}).error(function(j,i){console.log(i)})};c.saveDataDB();var g="",f;c.$watch("input",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g||g!=""){var j=[];d.each(c.vm.esposizioni,function(k){if(k.c==g){j.push(k.i)}});c.filtro.esposizioneProdotto.c=j}else{c.filtro.esposizioneProdotto.c=false}},250)});c.$watch("inputCod",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g){g=g.toUpperCase()}if(g!=""){var j=d.findWhere(c.vm.prodotti,{c:g});if(j){c.filtro.esposizioneProdotto.p=j.i}}else{c.filtro.esposizioneProdotto.p=false}},250)});c.eraseInput=function(j,i){if(j.keyCode==27){(!i)?c.input="":c.inputCod=""}};c.newItem=function(){b.saving=false;c.errore.esposizioneProdotto=false;c.vm.nuovoEsposizioneProdotto={i:c.vm.nuovoEsposizioneProdotto.i+1,c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1}};c.updateCheck=function(){return(!c.vm.nuovoEsposizioneProdotto.c||!c.vm.nuovoEsposizioneProdotto.p||!c.vm.nuovoEsposizioneProdotto.l||!c.vm.nuovoEsposizioneProdotto.j||!c.vm.nuovoEsposizioneProdotto.u||!c.vm.nuovoEsposizioneProdotto.f||isNaN(c.vm.nuovoEsposizioneProdotto.y)||isNaN(c.vm.nuovoEsposizioneProdotto.q))};c.action=function(i){if(i=="N"){b.saving=true;h.post("php/esposizioniSettori.php?type=new",{id:c.vm.nuovoEsposizioneProdotto.i,comp:c.vm.nuovoEsposizioneProdotto.c,prd:c.vm.nuovoEsposizioneProdotto.p,pline:c.vm.nuovoEsposizioneProdotto.l,cline:c.vm.nuovoEsposizioneProdotto.j,pmark:c.vm.nuovoEsposizioneProdotto.m,cmark:c.vm.nuovoEsposizioneProdotto.k,fin:c.vm.nuovoEsposizioneProdotto.f,tab:c.vm.nuovoEsposizioneProdotto.u,pos:c.vm.nuovoEsposizioneProdotto.y,qnt:c.vm.nuovoEsposizioneProdotto.q}).success(function(j){console.log("Risposta dalla pagina PHP",j);c.vm.esposizioniSettori.push(c.vm.nuovoEsposizioneProdotto);c.vm.saveEsposizioniProdottiData();c.newItem()}).error(function(k,j){console.log(j)})}}}]);angular.module("mpuDashboard").controller("compostiProdottiCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(c,b,d,a,h,e){c.compostoProdotto={selected:false};c.vm.sorting=["j","e","c","y"];c.$watch("vm.nuovoCompostoProdotto.k",function(i){c.vm.nuovoCompostoProdotto.m=i;c.vm.nuovoCompostoProdotto.j=false});c.$watch("vm.nuovoCompostoProdotto.j",function(i){c.vm.nuovoCompostoProdotto.l=i;c.vm.nuovoCompostoProdotto.c=false});c.$watch("vm.nuovoCompostoProdotto.m",function(){c.vm.nuovoCompostoProdotto.l=false});c.$watch("vm.nuovoCompostoProdotto.l",function(){c.vm.nuovoCompostoProdotto.p=false});c.$watch("vm.nuovoCompostoProdotto.p",function(k){if(k){var n=d.findWhere(c.vm.prodotti,{i:k});var j=d.pluck(n.z,"a");c.tabsAvailable=[];for(var l=0;l<j.length;l++){var m=d.findWhere(c.vm.finitureTabelle,{i:j[l]});c.tabsAvailable.push({i:j[l],n:m.n})}return c.tabsAvailable}else{c.vm.nuovoCompostoProdotto.u=false}});c.$watch("vm.nuovoCompostoProdotto.u",function(i){if(i){c.finsAvailable=d.where(c.vm.abbinamenti,{u:i});return c.finsAvailable}else{c.vm.nuovoCompostoProdotto.f=false}});c.selectItem=function(i){c.compostoProdotto={};c.compostoProdotto.selected=true;c.compostoProdotto.compostoProdotto=i};c.vm.saveCompostoProdottiData=function(){b.saving=true;h.post("php/compostiProdotti.php?type=save",c.vm.compostiProdotti).success(function(){b.saving=false}).error(function(j,i){console.log(i)})};c.saveDataDB=function(){b.saving=true;h.post("php/compostiProdotti.php?type=db").success(function(){b.saving=false;a.compostiProdotti().then(function(i){c.vm.compostiProdotti=i.data})}).error(function(j,i){console.log(i)})};c.saveDataDB();var g="",f;c.$watch("input",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g||g!=""){var j=[];d.each(c.vm.composti,function(k){if(k.c==g){j.push(k.i)}});c.filtro.compostoProdotto.c=j}else{c.filtro.compostoProdotto.c=false}},250)});c.$watch("inputCod",function(i){if(f){e.cancel(f)}g=i;f=e(function(){if(g){g=g.toUpperCase()}if(g!=""){var j=d.findWhere(c.vm.prodotti,{c:g});if(j){c.filtro.compostoProdotto.p=j.i}}else{c.filtro.compostoProdotto.p=false}},250)});c.eraseInput=function(j,i){if(j.keyCode==27){(!i)?c.input="":c.inputCod=""}};c.newItem=function(){b.saving=false;c.errore.compostoProdotto=false;c.vm.nuovoCompostoProdotto={i:c.vm.nuovoCompostoProdotto.i+1,c:false,p:false,m:false,k:false,l:false,j:false,u:false,f:false,y:1,q:1}};c.updateCheck=function(){return(!c.vm.nuovoCompostoProdotto.c||!c.vm.nuovoCompostoProdotto.p||!c.vm.nuovoCompostoProdotto.l||!c.vm.nuovoCompostoProdotto.j||!c.vm.nuovoCompostoProdotto.u||!c.vm.nuovoCompostoProdotto.f||isNaN(c.vm.nuovoCompostoProdotto.y)||isNaN(c.vm.nuovoCompostoProdotto.q))};c.action=function(i){if(i=="N"){b.saving=true;h.post("php/compostiProdotti.php?type=new",{id:c.vm.nuovoCompostoProdotto.i,comp:c.vm.nuovoCompostoProdotto.c,prd:c.vm.nuovoCompostoProdotto.p,pline:c.vm.nuovoCompostoProdotto.l,cline:c.vm.nuovoCompostoProdotto.j,pmark:c.vm.nuovoCompostoProdotto.m,cmark:c.vm.nuovoCompostoProdotto.k,fin:c.vm.nuovoCompostoProdotto.f,tab:c.vm.nuovoCompostoProdotto.u,pos:c.vm.nuovoCompostoProdotto.y,qnt:c.vm.nuovoCompostoProdotto.q}).success(function(j){console.log("Risposta dalla pagina PHP",j);c.vm.compostiProdotti.push(c.vm.nuovoCompostoProdotto);c.vm.saveCompostoProdottiData();c.newItem()}).error(function(k,j){console.log(j)})}}}]);angular.module("mpuDashboard").controller("esposizioniSettoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,d,f,b){i.esposizioneSettore={selected:false};i.vm.sorting="-i";i.$watch("vm.nuovoEsposizioneSettore.m",function(){i.vm.nuovoEsposizioneSettore.l=false;i.vm.nuovoEsposizioneSettore.w=false;i.vm.nuovoEsposizioneSettore.c=false});i.$watch("vm.nuovoEsposizioneSettore.l",function(j){i.vm.nuovoEsposizioneSettore.c=false});i.$watch("vm.nuovoEsposizioneSettore.w",function(j){i.settoriAvailable=h.where(i.vm.lineeSettori,{l:j});h.each(i.settoriAvailable,function(l){l.n=h.findWhere(i.vm.settori,{i:l.h}).n});i.esposizioniAvailable=[{c:" Tutti",i:-1}];var k=h.where(i.vm.esposizioni,{l:i.vm.nuovoEsposizioneSettore.l});h.each(k,function(l){if(!h.find(i.vm.esposizioniSettori,function(m){return(m.c===l.i&&j===l.l)})){i.esposizioniAvailable.push(l)}})});i.$watch("vm.nuovoEsposizioneSettore.c",function(j){if(j&&j!=-1){var k=h.find(i.vm.prodotti,function(l){return l.i==j});i.vm.nuovoEsposizioneSettore.n=k.c}});i.toggleSet=function(j){if(i.vm.nuovoEsposizioneSettore.h.indexOf(j)==-1){i.vm.nuovoEsposizioneSettore.h.push(parseInt(j))}else{i.vm.nuovoEsposizioneSettore.h.splice(i.vm.nuovoEsposizioneSettore.h.indexOf(j),1)}};i.selectItem=function(j){i.esposizioneSettore={};i.esposizioneSettore.selected=true;i.esposizioneSettore.esposizioneSettore=j};i.vm.saveEsposizioneSettoreData=function(){g.saving=true;f.post("php/esposizioniSettori.php?type=save",i.vm.esposizioniSettori).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/esposizioniSettori.php?type=db").success(function(){g.saving=false;d.esposizioniSettori().then(function(j){i.vm.esposizioniSettori=j.data})}).error(function(k,j){console.log(j)})};i.saveDataDB();var e="",c;i.$watch("input",function(j){if(c){b.cancel(c)}e=j;c=b(function(){if(e||e!=""){var k=[];h.each(i.vm.esposizioni,function(l){if(l.c==e){k.push(l.i)}});i.filtro.esposizioneSettore.c=k}else{i.filtro.esposizioneSettore.c=false}},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.newItem=function(){g.saving=false;i.errore.esposizioneSettore=false;i.vm.nuovoEsposizioneSettore={i:i.vm.nuovoEsposizioneSettore.i+1,m:false,l:false,c:false,v:0,h:[]}};i.updateCheck=function(){return(!i.vm.nuovoEsposizioneSettore.m||!i.vm.nuovoEsposizioneSettore.l||!i.vm.nuovoEsposizioneSettore.w||!i.vm.nuovoEsposizioneSettore.c)};function a(){return i.vm.nuovoEsposizioneSettore.h.length}i.action=function(j){if(j=="N"){if(a()!=0){g.saving=true;f.post("php/esposizioniSettori.php?type=new",{id:i.vm.nuovoEsposizioneSettore.i,mark:i.vm.nuovoEsposizioneSettore.m,line:i.vm.nuovoEsposizioneSettore.l,nwln:i.vm.nuovoEsposizioneSettore.w,array:i.vm.nuovoEsposizioneSettore.h,cod:i.vm.nuovoEsposizioneSettore.c,view:i.vm.nuovoEsposizioneSettore.v}).success(function(k){console.log("Risposta dalla pagina PHP",k);if(i.vm.nuovoEsposizioneSettore.c!=-1){i.vm.esposizioniSettori.push(i.vm.nuovoEsposizioneSettore);i.vm.saveEsposizioneSettoreData()}else{i.saveDataDB()}i.newItem()}).error(function(l,k){console.log(k)})}else{i.errore.esposizioneSettore=true}}}}]);angular.module("mpuDashboard").controller("compostiSettoriCtrl",["$scope","$rootScope","_","dataSvc","$http","$timeout",function(i,g,h,d,f,b){i.compostoSettore={selected:false};i.vm.sorting="-i";i.$watch("vm.nuovoCompostoSettore.m",function(){i.vm.nuovoCompostoSettore.l=false;i.vm.nuovoCompostoSettore.w=false;i.vm.nuovoCompostoSettore.c=false});i.$watch("vm.nuovoCompostoSettore.l",function(j){i.vm.nuovoCompostoSettore.c=false});i.$watch("vm.nuovoCompostoSettore.w",function(j){i.settoriAvailable=h.where(i.vm.lineeSettori,{l:j});h.each(i.settoriAvailable,function(l){l.n=h.findWhere(i.vm.settori,{i:l.h}).n});i.compostoAvailable=[{c:" Tutti",i:-1}];var k=h.where(i.vm.composti,{l:i.vm.nuovoCompostoSettore.l});h.each(k,function(l){if(!h.find(i.vm.compostiSettori,function(m){return(m.c===l.i&&j===l.l)})){i.compostoAvailable.push(l)}})});i.$watch("vm.nuovoCompostoSettore.c",function(j){if(j&&j!=-1){var k=h.find(i.vm.prodotti,function(l){return l.i==j});i.vm.nuovoCompostoSettore.n=k.c}});i.toggleSet=function(j){if(i.vm.nuovoCompostoSettore.h.indexOf(j)==-1){i.vm.nuovoCompostoSettore.h.push(parseInt(j))}else{i.vm.nuovoCompostoSettore.h.splice(i.vm.nuovoCompostoSettore.h.indexOf(j),1)}};i.selectItem=function(j){i.compostoSettore={};i.compostoSettore.selected=true;i.compostoSettore.compostoSettore=j};i.vm.saveCompostoSettoreData=function(){g.saving=true;f.post("php/compostiSettori.php?type=save",i.vm.compostiSettori).success(function(){g.saving=false}).error(function(k,j){console.log(j)})};i.saveDataDB=function(){g.saving=true;f.post("php/compostiSettori.php?type=db").success(function(){g.saving=false;d.compostiSettori().then(function(j){i.vm.compostiSettori=j.data})}).error(function(k,j){console.log(j)})};i.saveDataDB();var e="",c;i.$watch("input",function(j){if(c){b.cancel(c)}e=j;c=b(function(){if(e||e!=""){var k=[];h.each(i.vm.composti,function(l){if(l.c==e){k.push(l.i)}});i.filtro.compostoSettore.c=k}else{i.filtro.compostoSettore.c=false}},250)});i.eraseInput=function(j){if(j.keyCode==27){i.input=""}};i.newItem=function(){g.saving=false;i.errore.compostoSettore=false;i.vm.nuovoCompostoSettore={i:i.vm.nuovoCompostoSettore.i+1,m:false,l:false,c:false,v:0,h:[]}};i.updateCheck=function(){return(!i.vm.nuovoCompostoSettore.m||!i.vm.nuovoCompostoSettore.l||!i.vm.nuovoCompostoSettore.w||!i.vm.nuovoCompostoSettore.c)};function a(){return i.vm.nuovoCompostoSettore.h.length}i.action=function(j){if(j=="N"){if(a()!=0){g.saving=true;f.post("php/compostiSettori.php?type=new",{id:i.vm.nuovoCompostoSettore.i,mark:i.vm.nuovoCompostoSettore.m,line:i.vm.nuovoCompostoSettore.l,nwln:i.vm.nuovoCompostoSettore.w,array:i.vm.nuovoCompostoSettore.h,cod:i.vm.nuovoCompostoSettore.c,view:i.vm.nuovoCompostoSettore.v}).success(function(k){console.log("Risposta dalla pagina PHP",k);if(i.vm.nuovoCompostoSettore.c!=-1){i.vm.compostiSettori.push(i.vm.nuovoCompostoSettore);i.vm.saveCompostoSettoreData()}else{i.saveDataDB()}i.newItem()}).error(function(l,k){console.log(k)})}else{i.errore.compostoSettore=true}}}}]);